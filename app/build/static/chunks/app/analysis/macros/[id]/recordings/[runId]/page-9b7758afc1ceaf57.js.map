{"version":3,"file":"static/chunks/app/analysis/macros/[id]/recordings/[runId]/page-9b7758afc1ceaf57.js","mappings":"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","sources":["webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.20.0_@tensorflow+tfjs-core@4.20.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|fs","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.20.0_@tensorflow+tfjs-core@4.20.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|os","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.20.0_@tensorflow+tfjs-core@4.20.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|path","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.20.0_@tensorflow+tfjs-core@4.20.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|perf_hooks","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.20.0_@tensorflow+tfjs-core@4.20.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|worker_threads","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-core@4.20.0_encoding@0.1.13/node_modules/@tensorflow/tfjs-core/dist/platforms|node-fetch","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-core@4.20.0_encoding@0.1.13/node_modules/@tensorflow/tfjs-core/dist/platforms|util","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/object-inspect@1.13.1/node_modules/object-inspect|./util.inspect","webpack://_N_E/./node_modules/.pnpm/lucide-react@0.363.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/chevron-left.js","webpack://_N_E/./node_modules/.pnpm/lucide-react@0.363.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/minus.js","webpack://_N_E/?d7b2","webpack://_N_E/./app/_helpers/logger.ts","webpack://_N_E/./app/_hooks/debounce.ts","webpack://_N_E/./app/analysis/_worker/input-shaper.ts","webpack://_N_E/./app/analysis/_worker/shapers.ts","webpack://_N_E/./app/analysis/macros/[id]/recordings/[runId]/setup.tsx","webpack://_N_E/./app/analysis/macros/hooks.tsx","webpack://_N_E/./app/analysis/macros/[id]/recordings/[runId]/macro-run-chart.tsx","webpack://_N_E/./node_modules/.pnpm/lucide-react@0.363.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/skip-back.js","webpack://_N_E/./node_modules/.pnpm/lucide-react@0.363.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/skip-forward.js","webpack://_N_E/./node_modules/.pnpm/react-hotkeys-hook@4.5.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/react-hotkeys-hook/dist/react-hotkeys-hook.esm.js","webpack://_N_E/./node_modules/.pnpm/@radix-ui+react-context@1.1.0_@types+react@18.2.21_react@18.2.0/node_modules/@radix-ui/react-context/dist/index.mjs","webpack://_N_E/./node_modules/.pnpm/@radix-ui+react-compose-refs@1.1.0_@types+react@18.2.21_react@18.2.0/node_modules/@radix-ui/react-compose-refs/dist/index.mjs","webpack://_N_E/./node_modules/.pnpm/@radix-ui+react-slot@1.1.0_@types+react@18.2.21_react@18.2.0/node_modules/@radix-ui/react-slot/dist/index.mjs","webpack://_N_E/./node_modules/.pnpm/@radix-ui+react-primitive@2.0.0_@types+react-dom@18.0.11_@types+react@18.2.21_react-dom@18.2._txzsqi2npw22gf6yz5ydiwgwwu/node_modules/@radix-ui/react-primitive/dist/index.mjs","webpack://_N_E/./node_modules/.pnpm/@radix-ui+react-progress@1.1.0_@types+react-dom@18.0.11_@types+react@18.2.21_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@radix-ui/react-progress/dist/index.mjs","webpack://_N_E/./components/ui/progress.tsx","webpack://_N_E/./app/analysis/macros/[id]/recordings/[runId]/input-shapers.tsx","webpack://_N_E/./app/analysis/_worker/graph-comparison.ts","webpack://_N_E/./app/analysis/macros/[id]/recordings/[runId]/belt-tension-comparison.tsx","webpack://_N_E/./app/analysis/macros/[id]/recordings/[runId]/macro-run.tsx","webpack://_N_E/./app/analysis/math.ts","webpack://_N_E/./components/common/animated-container.tsx","webpack://_N_E/./components/common/badge.tsx","webpack://_N_E/./components/common/banner.tsx","webpack://_N_E/./components/common/button.tsx","webpack://_N_E/./components/common/spinner.tsx","webpack://_N_E/./components/ui/card.tsx","webpack://_N_E/./components/ui/dialog.tsx","webpack://_N_E/./components/ui/table.tsx","webpack://_N_E/./helpers/logger.ts","webpack://_N_E/./helpers/trpc.ts","webpack://_N_E/./helpers/util.ts","webpack://_N_E/./moonraker/migrations.ts","webpack://_N_E/./moonraker/hooks.tsx","webpack://_N_E/./utils/trpc.ts","webpack://_N_E/./zods/util.tsx","webpack://_N_E/<anon>"],"sourcesContent":["/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/**\n * @license lucide-react v0.363.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronLeft = createLucideIcon(\"ChevronLeft\", [\n  [\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]\n]);\n\nexport { ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","/**\n * @license lucide-react v0.363.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Minus = createLucideIcon(\"Minus\", [[\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }]]);\n\nexport { Minus as default };\n//# sourceMappingURL=minus.js.map\n","import(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/app/analysis/macros/[id]/recordings/[runId]/macro-run.tsx\");\nimport(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/components/common/no-ssr.tsx\")","import pino from 'pino';\nimport { globalPinoOpts } from '@/helpers/logger';\nimport { trpcClient } from '@/helpers/trpc';\nimport { PinoLogEvent } from '@/zods/util';\nimport { prettyFactory, write } from 'pino-pretty-browser';\n\nconst send = async function (level: pino.Level, logEvent: pino.LogEvent) {\n\ttrpcClient.clientLog.mutate({ level, logEvent: PinoLogEvent.parse(logEvent) });\n};\n\nlet logger: pino.Logger | null = null;\nexport const getLogger = () => {\n\tif (logger != null) {\n\t\treturn logger;\n\t}\n\tlogger = pino({\n\t\t...globalPinoOpts,\n\t\tbrowser: {\n\t\t\ttransmit: {\n\t\t\t\tsend,\n\t\t\t},\n\t\t},\n\t});\n\treturn logger;\n};\n","import { useRef, useCallback, useEffect } from 'react';\n\nexport const useDebounce = <T extends Function>(fn: T, delay: number, refreshTimeout: boolean = false) => {\n\tconst timeoutRef = useRef<ReturnType<typeof setTimeout>>();\n\tconst argsRef = useRef<any[]>([]);\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (timeoutRef.current) {\n\t\t\t\tclearTimeout(timeoutRef.current);\n\t\t\t}\n\t\t};\n\t}, []);\n\treturn useCallback(\n\t\t(...args: any[]) => {\n\t\t\targsRef.current = args;\n\t\t\tif (timeoutRef.current) {\n\t\t\t\tif (refreshTimeout) {\n\t\t\t\t\tclearTimeout(timeoutRef.current);\n\t\t\t\t\ttimeoutRef.current = undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttimeoutRef.current = setTimeout(() => {\n\t\t\t\tfn(...argsRef.current);\n\t\t\t\ttimeoutRef.current = undefined;\n\t\t\t}, delay);\n\t\t},\n\t\t[delay, refreshTimeout, fn],\n\t) as unknown as T;\n};\n","'use client';\n/**\n * Adapted from Dmitry Butyugin <dmbutyugin@google.com> input shaper code in Klipper.\n * This file may be distributed under the terms of the GNU GPLv3 license.\n */\nimport {\n\tTensor1D,\n\tsum,\n\tmax,\n\tpow,\n\tdiv,\n\tsub,\n\tmul,\n\ttensor1d,\n\texp,\n\tsin,\n\tcos,\n\touterProduct,\n\tslice,\n\tzeros,\n\tstack,\n\tsqrt,\n\tslice1d,\n\ttidy,\n\tsetBackend,\n} from '@tensorflow/tfjs-core';\nimport { setWasmPaths } from '@tensorflow/tfjs-backend-wasm';\n\nimport type { TypedArrayPSD } from '@/app/analysis/periodogram';\nimport { INPUT_SHAPERS, InputShaperModel, Shaper, ShaperModels } from '@/app/analysis/_worker/shapers';\nimport { PSD } from '@/zods/analysis';\nimport { shadableTWColors } from '@/app/_helpers/colors';\nimport { sumArray } from '@/app/analysis/math';\n\nexport type InputShaperWorkerInput =\n\t| {\n\t\t\tid?: number;\n\t\t\ttype: 'findBestShaper';\n\t\t\tcalibrationData: TypedArrayPSD | PSD;\n\t\t\tscv: number;\n\t\t\tshaperFreqs?: [number | null, number | null, number | null];\n\t\t\tdampingRatio?: number;\n\t\t\tmaxSmoothing?: number;\n\t\t\ttestDampingRatios?: number[];\n\t\t\tmaxFreq?: number;\n\t  }\n\t| {\n\t\t\ttype: 'cancelJob';\n\t\t\tid: number;\n\t  };\n\nexport type InputShaperWorkerOutput =\n\t| {\n\t\t\ttype: 'findBestShaper';\n\t\t\tresult: ShaperCalibrationResult | null;\n\t\t\tjobId: number;\n\t\t\tshapers: (ShaperCalibrationResult | null)[];\n\t  }\n\t| {\n\t\t\ttype: 'fitShaper';\n\t\t\tjobId: number;\n\t\t\tresult: ShaperCalibrationResult | null;\n\t  }\n\t| {\n\t\t\ttype: 'jobCancelled';\n\t\t\tid: number;\n\t  }\n\t| {\n\t\t\ttype: 'fitShaperProgress';\n\t\t\tmodel: ShaperModels;\n\t\t\tjobId: number;\n\t\t\tprogress: number;\n\t  }\n\t| {\n\t\t\ttype: 'findBestShaperProgress';\n\t\t\tjobId: number;\n\t\t\tprogress: number;\n\t  };\ndeclare function postMessage(message: InputShaperWorkerOutput, targetOrigin: string, transfer?: Transferable[]): void;\ndeclare function postMessage(message: InputShaperWorkerOutput, options?: WindowPostMessageOptions): void;\n\nexport interface InputShaperWorker extends Worker {\n\tonmessage(this: Worker, ev: MessageEvent<InputShaperWorkerOutput>): any;\n\tpostMessage(message: InputShaperWorkerInput, transfer?: Transferable[]): void;\n\tpostMessage(message: InputShaperWorkerInput, options?: StructuredSerializeOptions): void;\n}\nclass JobCancelledError extends Error {\n\tconstructor() {\n\t\tsuper('Job cancelled');\n\t}\n}\n\nconst jobs = new Map<number, AbortController>();\nlet _id = 0;\n\nexport const shaperDefaults = {\n\tDEFAULT_DAMPING_RATIO: 0.1,\n\tSHAPER_VIBRATION_REDUCTION: 20,\n\tTEST_DAMPING_RATIOS: [0.075, 0.1, 0.15],\n\tMAX_SHAPER_FREQ: 150,\n\tWINDOW_T_SEC: 0.5,\n\tMIN_FREQ: 5,\n\tMAX_FREQ: 200,\n\t// Just some empirically chosen value which produces good projections\n\t// for max_accel without much smoothing\n\tTARGET_SMOOTHING: 0.12,\n};\n\nconst cancelJob = (id: number) => {\n\tconst controller = jobs.get(id);\n\tif (controller && controller.signal.aborted === false) {\n\t\tcontroller.abort();\n\t}\n\tjobs.delete(id);\n};\n\nconst throwIfCancelled = (signal: AbortSignal) => {\n\tif (signal.aborted) {\n\t\tthrow new JobCancelledError();\n\t}\n};\n\nasync function getShaperSmoothing(shaper: Shaper, accel: number = 5000, scv: number = 5): Promise<number> {\n\tconst halfAccel = accel * 0.5;\n\n\tconst [A, T] = shaper;\n\tconst invD = 1 / sumArray(A);\n\tconst n = T.length;\n\t// Calculate input shaper shift\n\tconst ts = sumArray(A.map((a, i) => a * T[i])) * invD;\n\n\t// Calculate offset for 90 and 180 degrees turn\n\tlet offset90 = 0;\n\tlet offset180 = 0;\n\tfor (let i = 0; i < n; i++) {\n\t\tif (T[i] >= ts) {\n\t\t\t// Calculate offset for one of the axes\n\t\t\toffset90 += A[i] * (scv + halfAccel * (T[i] - ts)) * (T[i] - ts);\n\t\t}\n\t\toffset180 += A[i] * halfAccel * (T[i] - ts) ** 2;\n\t}\n\toffset90 *= invD * Math.sqrt(2);\n\toffset180 *= invD;\n\treturn Math.max(offset90, offset180);\n}\n\nasync function bisect(fn: (x: number) => Promise<boolean>): Promise<number> {\n\tlet left = 1.0;\n\tlet right = 1.0;\n\tif (!(await fn(1e-9))) {\n\t\treturn 0.0;\n\t}\n\twhile (!(await fn(left))) {\n\t\tright = left;\n\t\tleft *= 0.5;\n\t}\n\tif (right === left) {\n\t\twhile (await fn(right)) {\n\t\t\tright *= 2.0;\n\t\t}\n\t}\n\twhile (right - left > 1e-8) {\n\t\tconst middle = (left + right) * 0.5;\n\t\tif (await fn(middle)) {\n\t\t\tleft = middle;\n\t\t} else {\n\t\t\tright = middle;\n\t\t}\n\t}\n\treturn left;\n}\n\nasync function findShaperMaxAccel(shaper: Shaper, scv: number): Promise<number> {\n\tconst maxAccel = await bisect(\n\t\tasync (testAccel: number) => (await getShaperSmoothing(shaper, testAccel, scv)) <= shaperDefaults.TARGET_SMOOTHING,\n\t);\n\treturn maxAccel;\n}\n\nfunction estimateShaper(shaper: Shaper, testDampingRatio: number, testFreqs: Tensor1D): Tensor1D {\n\treturn tidy(() => {\n\t\tconst A = tensor1d(shaper[0]);\n\t\tconst T = tensor1d(shaper[1]);\n\t\tconst invD = div(1, sum(A));\n\t\tconst omega = mul<Tensor1D>(mul<Tensor1D>(testFreqs, 2), Math.PI);\n\t\tconst damping = mul<Tensor1D>(omega, testDampingRatio);\n\t\tconst omegaD = mul<Tensor1D>(omega, Math.sqrt(1 - testDampingRatio ** 2));\n\t\tconst W = mul(A, exp(outerProduct(mul<Tensor1D>(damping, -1), sub<Tensor1D>(slice(T, T.size - 1, 1), T))));\n\t\tconst S = mul(W, sin(outerProduct(omegaD, T)));\n\t\tconst C = mul(W, cos(outerProduct(omegaD, T)));\n\t\treturn mul(sqrt(sum(stack([pow(sum(S, 1), 2), pow(sum(C, 1), 2)]), 0)), invD);\n\t});\n}\n\nasync function estimateRemainingVibrations(\n\tshaper: Shaper,\n\ttestDampingRatio: number,\n\tfreqBins: Tensor1D,\n\tpsd: Tensor1D,\n): Promise<[number, Tensor1D]> {\n\tconst vals = estimateShaper(shaper, testDampingRatio, freqBins);\n\tconst res = (await tidy(() => {\n\t\t// The input shaper can only reduce the amplitude of vibrations by\n\t\t// SHAPER_VIBRATION_REDUCTION times, so all vibrations below that\n\t\t// threshold can be ignored\n\t\tconst vibrThreshold = div(max(psd), shaperDefaults.SHAPER_VIBRATION_REDUCTION);\n\t\tconst remainingVibrations = sum(max(sub(mul(vals, psd), vibrThreshold), 0));\n\t\tconst allVibrations = sum(max(sub(psd, vibrThreshold), 0));\n\t\treturn div(remainingVibrations, allVibrations);\n\t}).array()) as number;\n\treturn [res, vals];\n}\n\nexport type ShaperCalibrationResult = {\n\tname: ShaperModels;\n\tcolor: keyof typeof shadableTWColors;\n\tfreq: number;\n\tvals: number[];\n\tpsd: number[];\n\tvibrs: number;\n\tsmoothing: number;\n\tscore: number;\n\tmaxAccel: number;\n};\n\nconst range = (start: number, stop: number, step: number) =>\n\tArray.from({ length: (stop - start) / step + 1 }, (value, index) => start + index * step);\n\nexport async function fitShaper(\n\tjobId: number,\n\tsignal: AbortSignal,\n\tshaperCfg: InputShaperModel,\n\tcalibrationData: TypedArrayPSD | PSD,\n\t/**\n\t * [start?, end?, step?]\n\t * @type {[number, number, number]}\n\t */\n\tscv: number,\n\tshaperFreqs: [number | null, number | null, number | null] = [null, null, null],\n\tdampingRatio?: number,\n\tmaxSmoothing?: number,\n\ttestDampingRatios?: number[],\n\tmaxFreq?: number,\n\tonProgress?: (model: ShaperModels, progress: number) => void,\n) {\n\tdampingRatio = dampingRatio || shaperDefaults.DEFAULT_DAMPING_RATIO;\n\ttestDampingRatios = testDampingRatios || shaperDefaults.TEST_DAMPING_RATIOS;\n\tconst freqEnd = shaperFreqs[1] ?? shaperDefaults.MAX_SHAPER_FREQ;\n\tconst freqStart = Math.min(shaperFreqs[0] ?? shaperCfg.minFreq, freqEnd - 1e-7);\n\tconst freqStep = shaperFreqs[2] ?? 0.2;\n\tthrowIfCancelled(signal);\n\n\tmaxFreq = Math.max(maxFreq || shaperDefaults.MAX_FREQ, freqEnd);\n\n\tconst freqBins = slice1d(calibrationData.frequencies, 0, calibrationData.frequencies.length);\n\tconst freqBinsFiltered = slice1d(\n\t\tfreqBins,\n\t\t0,\n\t\tcalibrationData.frequencies.findIndex((f) => f > maxFreq),\n\t);\n\tconst psd = slice1d(calibrationData.estimates, 0, freqBins.size);\n\tfreqBins.dispose();\n\tconst zeroArray = zeros([psd.size]);\n\t// Two pass approach, start in 10hz increments, then refine in `freqStep` increments\n\tconst freqsOfInterest = (\n\t\tawait Promise.all(\n\t\t\trange(freqStart, freqEnd, 10).map(async (f) => {\n\t\t\t\tif (shaperCfg.minFreq > f) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tconst shaper = shaperCfg.initFunc(f, dampingRatio);\n\t\t\t\tlet shaperVibrations = 0;\n\t\t\t\tlet shaperVals = zeroArray.clone();\n\t\t\t\tfor (const dr of testDampingRatios) {\n\t\t\t\t\tconst [vibrations, vals] = await estimateRemainingVibrations(shaper, dr, freqBinsFiltered, psd);\n\t\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\t\tconst oldShapervals = shaperVals;\n\t\t\t\t\tshaperVals = tidy(() => max<Tensor1D>(stack([oldShapervals, vals]), 0));\n\t\t\t\t\toldShapervals.dispose();\n\t\t\t\t\tif (vibrations > shaperVibrations) {\n\t\t\t\t\t\tshaperVibrations = vibrations;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (shaperVibrations < 0.15) {\n\t\t\t\t\treturn f;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}),\n\t\t)\n\t).filter(Boolean);\n\tthrowIfCancelled(signal);\n\tconst testFrequencies = range(Math.min(...freqsOfInterest), Math.max(...freqsOfInterest), freqStep);\n\tconst progressMap = new Map<number, number>();\n\tconst reportProgress = (index: number, progress: number) => {\n\t\tprogressMap.set(index, progress);\n\t\tconst totalProgress = sumArray(Array.from(progressMap.values())) / testFrequencies.length;\n\t\tpostMessage({ type: 'fitShaperProgress', model: shaperCfg.name, progress: totalProgress, jobId });\n\t\tonProgress?.(shaperCfg.name, totalProgress);\n\t};\n\tconst bestShaper: ShaperCalibrationResult | null = (\n\t\tawait Promise.all(\n\t\t\ttestFrequencies.reverse().map(async (testFreq, index) => {\n\t\t\t\treportProgress(testFreq, 0);\n\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\tlet shaperVibrations = 0;\n\t\t\t\tlet shaperVals = zeroArray.clone();\n\t\t\t\tconst shaper = shaperCfg.initFunc(testFreq, dampingRatio);\n\t\t\t\tconst shaperSmoothing = await getShaperSmoothing(shaper, undefined, scv);\n\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\tif (maxSmoothing && shaperSmoothing > maxSmoothing) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treportProgress(index, 1 / 3);\n\t\t\t\tfor (const dr of testDampingRatios) {\n\t\t\t\t\tconst [vibrations, vals] = await estimateRemainingVibrations(shaper, dr, freqBinsFiltered, psd);\n\t\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\t\tconst oldShapervals = shaperVals;\n\t\t\t\t\tshaperVals = tidy(() => max<Tensor1D>(stack([oldShapervals, vals]), 0));\n\t\t\t\t\toldShapervals.dispose();\n\t\t\t\t\tif (vibrations > shaperVibrations) {\n\t\t\t\t\t\tshaperVibrations = vibrations;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treportProgress(index, 2 / 3);\n\t\t\t\tconst maxAccel = await findShaperMaxAccel(shaper, scv);\n\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\tconst shaperScore = shaperSmoothing * (Math.pow(shaperVibrations, 1.5) + shaperVibrations * 0.2 + 0.01);\n\t\t\t\tconst shaperValsArray = (await shaperVals.array()) as number[];\n\t\t\t\tconst adaptedPsd = (await mul(psd, shaperVals).array()) as number[];\n\t\t\t\treportProgress(index, 3 / 3);\n\t\t\t\tconst result = {\n\t\t\t\t\tname: shaperCfg.name,\n\t\t\t\t\tfreq: testFreq,\n\t\t\t\t\tvals: shaperValsArray,\n\t\t\t\t\tpsd: adaptedPsd,\n\t\t\t\t\tvibrs: shaperVibrations,\n\t\t\t\t\tsmoothing: shaperSmoothing,\n\t\t\t\t\tscore: shaperScore,\n\t\t\t\t\tcolor: shaperCfg.color,\n\t\t\t\t\tmaxAccel: maxAccel,\n\t\t\t\t} satisfies ShaperCalibrationResult;\n\t\t\t\treturn result;\n\t\t\t}),\n\t\t)\n\t).reduce(\n\t\t(selected, res) => {\n\t\t\tif (res === null) {\n\t\t\t\treturn selected;\n\t\t\t}\n\t\t\tif (selected == null || (res.vibrs < selected.vibrs * 1.1 && res.score < selected.score)) {\n\t\t\t\tselected = res;\n\t\t\t}\n\t\t\treturn selected;\n\t\t},\n\t\tnull as ShaperCalibrationResult | null,\n\t);\n\tfreqBinsFiltered.dispose();\n\tpsd.dispose();\n\tzeroArray.dispose();\n\n\tthrowIfCancelled(signal);\n\tpostMessage({ type: 'fitShaper', result: bestShaper, jobId });\n\n\treturn bestShaper;\n}\n\nsetWasmPaths({\n\t'tfjs-backend-wasm.wasm': '/configure/tfjs-backend-wasm.wasm',\n\t'tfjs-backend-wasm-simd.wasm': '/configure/tfjs-backend-wasm-simd.wasm',\n\t'tfjs-backend-wasm-threaded-simd.wasm': '/configure/tfjs-backend-wasm-threaded-simd.wasm',\n});\nexport async function findBestShaper(\n\tjobId: number,\n\tsignal: AbortSignal,\n\tcalibrationData: TypedArrayPSD | PSD,\n\tscv: number,\n\tshapers: InputShaperModel[] = INPUT_SHAPERS,\n\tshaperFreqs?: [number | null, number | null, number | null],\n\tdampingRatio?: number,\n\tmaxSmoothing?: number,\n\ttestDampingRatios?: number[],\n\tmaxFreq?: number,\n) {\n\tawait setBackend('wasm');\n\tthrowIfCancelled(signal);\n\tconst fittedShapers: ShaperCalibrationResult[] = [];\n\tconst totalProgress = new Map<ShaperModels, number>();\n\tshapers.forEach((s) => totalProgress.set(s.name, 0));\n\tpostMessage({ type: 'findBestShaperProgress', progress: 0, jobId });\n\tconst reportProgress = (model: ShaperModels, progress: number) => {\n\t\ttotalProgress.set(model, progress);\n\t\tconst total = sumArray(Array.from(totalProgress.values())) / shapers.length;\n\t\tpostMessage({ type: 'findBestShaperProgress', progress: total, jobId });\n\t};\n\tfor (const shaper of shapers) {\n\t\tconst fittedShaper = await fitShaper(\n\t\t\tjobId,\n\t\t\tsignal,\n\t\t\tshaper,\n\t\t\tcalibrationData,\n\t\t\tscv,\n\t\t\tshaperFreqs,\n\t\t\tdampingRatio,\n\t\t\tmaxSmoothing,\n\t\t\ttestDampingRatios,\n\t\t\tmaxFreq,\n\t\t\treportProgress,\n\t\t);\n\t\tif (fittedShaper) {\n\t\t\tfittedShapers.push(fittedShaper);\n\t\t}\n\t}\n\tthrowIfCancelled(signal);\n\tconst best = fittedShapers.reduce((best, shaper) => {\n\t\t// Either the shaper significantly improves the score (by 20%),\n\t\t// or it improves the score and smoothing (by 5% and 10% resp.)\n\t\tif (\n\t\t\t!best ||\n\t\t\t(shaper && shaper.score * 1.2 < best.score) ||\n\t\t\t(shaper.score * 1.05 < best.score && shaper.smoothing * 1.1 < best.smoothing)\n\t\t) {\n\t\t\tbest = shaper;\n\t\t}\n\t\treturn best;\n\t});\n\treturn {\n\t\tresult: best,\n\t\tshapers: fittedShapers,\n\t};\n}\n\nonmessage = async (e: MessageEvent<InputShaperWorkerInput>) => {\n\tconst command = e.data.type;\n\tswitch (command) {\n\t\tcase 'findBestShaper':\n\t\t\tconst { calibrationData, scv, shaperFreqs, dampingRatio, maxSmoothing, testDampingRatios, maxFreq, id } = e.data;\n\t\t\tconst jobId = id ?? _id++;\n\t\t\tconst abortController = new AbortController();\n\t\t\ttry {\n\t\t\t\tjobs.set(jobId, abortController);\n\t\t\t\tconst result = await findBestShaper(\n\t\t\t\t\tjobId,\n\t\t\t\t\tabortController.signal,\n\t\t\t\t\tcalibrationData,\n\t\t\t\t\tscv,\n\t\t\t\t\tINPUT_SHAPERS,\n\t\t\t\t\tshaperFreqs,\n\t\t\t\t\tdampingRatio,\n\t\t\t\t\tmaxSmoothing,\n\t\t\t\t\ttestDampingRatios,\n\t\t\t\t\tmaxFreq,\n\t\t\t\t);\n\t\t\t\tpostMessage({ type: 'findBestShaper', jobId, ...result } satisfies InputShaperWorkerOutput);\n\t\t\t} catch (e) {\n\t\t\t\tif (e instanceof JobCancelledError) {\n\t\t\t\t\tcancelJob(jobId);\n\t\t\t\t\tpostMessage({ type: 'jobCancelled', id: jobId } satisfies InputShaperWorkerOutput);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'cancelJob':\n\t\t\tcancelJob(e.data.id);\n\t\t\tbreak;\n\t}\n};\n","'use client';\n/**\n * Adapted from Dmitry Butyugin <dmbutyugin@google.com> input shaper code in Klipper.\n * This file may be distributed under the terms of the GNU GPLv3 license.\n */\nimport { shaperDefaults } from '@/app/analysis/_worker/input-shaper';\nimport { shadableTWColors } from '@/app/_helpers/colors';\n\nexport type Shaper = [number[], number[]];\n\nexport type ShaperModels = 'zv' | 'mzv' | 'zvd' | 'ei' | '2hump_ei' | '3hump_ei';\n\nexport type InputShaperModel = {\n\tminFreq: number;\n\tinitFunc: (shaperFrequency: number, dampingRatio: number) => Shaper;\n\tname: ShaperModels;\n\tcolor: keyof typeof shadableTWColors;\n};\n\nexport function inputShaperCfg(\n\tname: ShaperModels,\n\tinitFunc: (shaperFrequency: number, dampingRatio: number) => Shaper,\n\tminFreq: number,\n\tcolor: keyof typeof shadableTWColors,\n): InputShaperModel {\n\treturn { name, initFunc, minFreq, color };\n}\n\nexport function getNoneShaper(): Shaper {\n\treturn [[], []];\n}\n\nexport function getZvShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\tconst A = [1, K];\n\tconst T = [0, 0.5 * tD];\n\treturn [A, T];\n}\n\nexport function getZvdShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\tconst A = [1, 2 * K, K ** 2];\n\tconst T = [0, 0.5 * tD, tD];\n\treturn [A, T];\n}\n\nexport function getMzvShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-0.75 * dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst a1 = 1 - 1 / Math.sqrt(2);\n\tconst a2 = (Math.sqrt(2) - 1) * K;\n\tconst a3 = a1 * K * K;\n\n\tconst A = [a1, a2, a3];\n\tconst T = [0, 0.375 * tD, 0.75 * tD];\n\treturn [A, T];\n}\n\nexport function getEiShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst vTol = 1 / shaperDefaults.SHAPER_VIBRATION_REDUCTION; // vibration tolerance\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst a1 = 0.25 * (1 + vTol);\n\tconst a2 = 0.5 * (1 - vTol) * K;\n\tconst a3 = a1 * K * K;\n\n\tconst A = [a1, a2, a3];\n\tconst T = [0, 0.5 * tD, tD];\n\treturn [A, T];\n}\n\nexport function get2HumpEiShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst vTol = 1 / shaperDefaults.SHAPER_VIBRATION_REDUCTION; // vibration tolerance\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst V2 = vTol ** 2;\n\tconst X = Math.pow(V2 * (Math.sqrt(1 - V2) + 1), 1 / 3);\n\tconst a1 = (3 * X * X + 2 * X + 3 * V2) / (16 * X);\n\tconst a2 = (0.5 - a1) * K;\n\tconst a3 = a2 * K;\n\tconst a4 = a1 * K * K * K;\n\n\tconst A = [a1, a2, a3, a4];\n\tconst T = [0, 0.5 * tD, tD, 1.5 * tD];\n\treturn [A, T];\n}\n\nexport function get3HumpEiShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst vTol = 1 / shaperDefaults.SHAPER_VIBRATION_REDUCTION; // vibration tolerance\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst K2 = K * K;\n\tconst a1 = 0.0625 * (1 + 3 * vTol + 2 * Math.sqrt(2 * (vTol + 1) * vTol));\n\tconst a2 = 0.25 * (1 - vTol) * K;\n\tconst a3 = (0.5 * (1 + vTol) - 2 * a1) * K2;\n\tconst a4 = a2 * K2;\n\tconst a5 = a1 * K2 * K2;\n\n\tconst A = [a1, a2, a3, a4, a5];\n\tconst T = [0, 0.5 * tD, tD, 1.5 * tD, 2 * tD];\n\treturn [A, T];\n}\n\nexport const INPUT_SHAPERS = [\n\tinputShaperCfg('zv', getZvShaper, 21, 'blue'),\n\tinputShaperCfg('mzv', getMzvShaper, 23, 'rose'),\n\tinputShaperCfg('zvd', getZvdShaper, 29, 'lime'),\n\tinputShaperCfg('ei', getEiShaper, 29, 'amber'),\n\tinputShaperCfg('2hump_ei', get2HumpEiShaper, 39, 'pink'),\n\tinputShaperCfg('3hump_ei', get3HumpEiShaper, 48, 'violet'),\n];\n","import { shadableTWColors, TWShadeableColorName } from '@/app/_helpers/colors';\nimport { PSD_CHART_AXIS_AMPLITUDE_ID, getPSDTooltipLegendTemplate } from '@/app/analysis/charts';\nimport { PSD } from '@/zods/analysis';\nimport {\n\tSciChartSurface,\n\tFastBandRenderableSeries,\n\tXyyDataSeries,\n\tWaveAnimation,\n\tFastLineRenderableSeries,\n\tFastMountainRenderableSeries,\n\tXyDataSeries,\n\tNumberRange,\n\tEAutoRange,\n\teasing,\n\tRolloverModifier,\n\tCursorModifier,\n} from 'scichart';\n\nexport enum SequenceDataChartType {\n\tLine = 'line',\n\tMountain = 'mountain',\n}\n\nexport type SequenceData = {\n\tsequenceId: string;\n\tcolor: TWShadeableColorName;\n\tname: string;\n\tpsd: {\n\t\ttotal: PSD;\n\t\tx: PSD;\n\t\ty: PSD;\n\t\tz: PSD;\n\t};\n\ttype: 'line' | 'mountain';\n};\n\nexport const animateYAxis = (surface: SciChartSurface, sequenceData: SequenceData[]) => {\n\tconst yAxis = surface.yAxes.getById(PSD_CHART_AXIS_AMPLITUDE_ID);\n\tif (yAxis) {\n\t\tyAxis.autoRange = EAutoRange.Never;\n\t\tconst newMax = Math.max(...sequenceData.map((seq) => Math.max(...seq.psd.total.estimates)));\n\t\tif (yAxis.visibleRange.max < newMax || yAxis.visibleRange.max > newMax * 5) {\n\t\t\tyAxis.animateVisibleRange(\n\t\t\t\tnew NumberRange(Math.min(...sequenceData.map((seq) => seq.psd.total.powerRange.min)), newMax).growBy(\n\t\t\t\t\tnew NumberRange(0.0, 0.2),\n\t\t\t\t),\n\t\t\t\t500,\n\t\t\t\teasing.inOutCirc,\n\t\t\t);\n\t\t}\n\t}\n};\n\nexport const setupChart = (surface: SciChartSurface, sequenceData: SequenceData[]) => {\n\tlet bandSeries = false;\n\tif (sequenceData.length === 2) {\n\t\tbandSeries = true;\n\t\tfor (let i = 0; i < sequenceData[0].psd.total.frequencies.length; i++) {\n\t\t\tif (Math.abs(sequenceData[0].psd.total.frequencies[i] - sequenceData[1].psd.total.frequencies[i]) > 1) {\n\t\t\t\tbandSeries = false;\n\t\t\t}\n\t\t}\n\t}\n\tif (bandSeries) {\n\t\tconst rs = new FastBandRenderableSeries(surface.webAssemblyContext2D, {\n\t\t\tdataSeries: new XyyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t\tcontainsNaN: false,\n\t\t\t\tisSorted: true,\n\t\t\t\txValues: sequenceData[0].psd.total.frequencies,\n\t\t\t\tyValues: sequenceData[0].psd.total.estimates,\n\t\t\t\ty1Values: sequenceData[1].psd.total.estimates,\n\t\t\t}),\n\t\t\tfill: shadableTWColors[(sequenceData[1].color ?? 'sky') as keyof typeof shadableTWColors][600] + 22,\n\t\t\tfillY1: shadableTWColors[(sequenceData[0].color ?? 'rose') as keyof typeof shadableTWColors][600] + 22,\n\t\t\tstroke: shadableTWColors[(sequenceData[0].color ?? 'rose') as keyof typeof shadableTWColors][400],\n\t\t\tstrokeY1: shadableTWColors[(sequenceData[1].color ?? 'sky') as keyof typeof shadableTWColors][400],\n\t\t\tstrokeThickness: 4,\n\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t});\n\t\trs.rolloverModifierProps.tooltipColor = sequenceData[0].color ?? 'zinc';\n\t\trs.rolloverModifierProps.tooltipTitle = sequenceData[0].name + ' Power';\n\t\trs.rolloverModifierProps1.tooltipColor = sequenceData[1].color ?? 'zinc';\n\t\trs.rolloverModifierProps1.tooltipTitle = sequenceData[1].name + ' Power';\n\t\trs.animation = new WaveAnimation({\n\t\t\tduration: 500,\n\t\t\tdelay: 200,\n\t\t\tease: easing.inOutQuad,\n\t\t});\n\t\tsurface.renderableSeries.add(rs);\n\t} else {\n\t\tsequenceData.forEach((seq) => {\n\t\t\tconst Series = seq.type === SequenceDataChartType.Line ? FastLineRenderableSeries : FastMountainRenderableSeries;\n\t\t\tconst rs = new Series(surface.webAssemblyContext2D, {\n\t\t\t\tid: seq.sequenceId,\n\t\t\t\tdataSeries: new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\tisSorted: true,\n\t\t\t\t\txValues: seq.psd.total.frequencies,\n\t\t\t\t\tyValues: seq.psd.total.estimates,\n\t\t\t\t}),\n\t\t\t\tstroke: shadableTWColors[(seq.color ?? 'brand') as keyof typeof shadableTWColors][400],\n\t\t\t\tfill: shadableTWColors[(seq.color ?? 'brand') as keyof typeof shadableTWColors][600] + 11,\n\t\t\t\tstrokeThickness: 4,\n\t\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t});\n\t\t\trs.rolloverModifierProps.tooltipColor = seq.color ?? 'zinc';\n\t\t\trs.rolloverModifierProps.tooltipTitle = seq.name + ' Power';\n\t\t\trs.animation = new WaveAnimation({\n\t\t\t\tduration: 500,\n\t\t\t\tdelay: 200,\n\t\t\t\tease: easing.inOutQuad,\n\t\t\t});\n\t\t\tsurface.renderableSeries.add(rs);\n\t\t});\n\t}\n\n\tsurface.chartModifiers.add(\n\t\tnew RolloverModifier({\n\t\t\t// Defines if rollover vertical line is shown\n\t\t\tshowRolloverLine: true,\n\t\t\t// Shows the default tooltip\n\t\t\tshowTooltip: false,\n\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t// Optional: Overrides the content of the tooltip\n\t\t}),\n\t);\n\n\tsurface.chartModifiers.add(\n\t\tnew CursorModifier({\n\t\t\t// Defines if crosshair is shown\n\t\t\tcrosshairStroke: shadableTWColors.sky[400],\n\t\t\tcrosshairStrokeThickness: 1,\n\t\t\tshowXLine: true,\n\t\t\tshowYLine: true,\n\t\t\ttooltipLegendTemplate: getPSDTooltipLegendTemplate,\n\t\t\ttooltipLegendOffsetX: 16,\n\t\t\ttooltipLegendOffsetY: 16,\n\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t// Shows the default tooltip\n\t\t\tshowTooltip: false,\n\t\t\taxisLabelFill: shadableTWColors.zinc[900],\n\t\t\taxisLabelStroke: shadableTWColors.zinc[100],\n\t\t}),\n\t);\n\tanimateYAxis(surface, sequenceData);\n};\n","import {\n\tFastMountainRenderableSeries,\n\tXyDataSeries,\n\tWaveAnimation,\n\tFastLineRenderableSeries,\n\tLineAnimation,\n\tCustomAnnotation,\n\tECoordinateMode,\n\tEHorizontalAnchorPoint,\n\tEVerticalAnchorPoint,\n\tGenericAnimation,\n\tDoubleAnimator,\n\teasing,\n\tSciChartSurface,\n} from 'scichart';\nimport { shadableTWColors, TWShadeableColorName } from '@/app/_helpers/colors';\nimport { PSD_CHART_AXIS_AMPLITUDE_ID, PSD_CHART_AXIS_SHAPER_ID } from '@/app/analysis/charts';\nimport type { ShaperCalibrationResult } from '@/app/analysis/_worker/input-shaper';\nimport deepEqual from 'deep-equal';\nimport { getLogger } from '@/app/_helpers/logger';\nimport { SequenceData } from '@/app/analysis/macros/[id]/recordings/[runId]/setup';\nimport { detectPeaks, MechanicalHealthResult, PeakPairingResult } from '@/app/analysis/_worker/graph-comparison';\nimport { useState, useRef, useCallback } from 'react';\n\nexport const useBeltTensionState = () => {\n\tconst [sequencePair, setSequencePair] = useState<[SequenceData, SequenceData] | null>(null);\n\tconst [peakPairingResults, setPeakPairingResults] = useState<PeakPairingResult | null>(null);\n\tconst [mechanicalHealth, setMechanicalHealth] = useState<MechanicalHealthResult | null>(null);\n\treturn {\n\t\tsequencePair,\n\t\tsetSequencePair,\n\t\tpeakPairingResults,\n\t\tsetPeakPairingResults,\n\t\tmechanicalHealth,\n\t\tsetMechanicalHealth,\n\t};\n};\n\nexport const initBeltTensionChartAnnotations = async (\n\tsurface: SciChartSurface | null,\n\tsequencePair: [SequenceData, SequenceData] | null,\n\tpeakPairingResult: PeakPairingResult | null,\n\tdelay: number = 1000,\n) => {\n\tif (sequencePair == null || peakPairingResult == null || surface == null) {\n\t\treturn;\n\t}\n\tconst [seq1, seq2] = sequencePair;\n\tconst { pairedPeaks: pairs, unpairedPeaks1, unpairedPeaks2 } = peakPairingResult;\n\tconst yAnimOffset =\n\t\tMath.max(\n\t\t\tsurface.yAxes.getById(PSD_CHART_AXIS_AMPLITUDE_ID)?.visibleRange.max,\n\t\t\tseq1.psd.total.powerRange.max,\n\t\t\tseq2.psd.total.powerRange.max,\n\t\t) * 0.1;\n\tconst annotations = pairs\n\t\t.flatMap(([p1, p2], i) => {\n\t\t\tif (\n\t\t\t\tsurface.annotations.getById(String.fromCharCode(65 + i) + '-peak-1') == null &&\n\t\t\t\tsurface.annotations.getById(String.fromCharCode(65 + i) + '-peak-2') == null\n\t\t\t) {\n\t\t\t\tconst x = p1.freq;\n\t\t\t\tconst y = p1.amplitude;\n\t\t\t\tconst x2 = p2.freq;\n\t\t\t\tconst y2 = p2.amplitude;\n\n\t\t\t\tconst a = new CustomAnnotation({\n\t\t\t\t\tid: String.fromCharCode(65 + i) + '-peak-1',\n\t\t\t\t\txCoordinateMode: ECoordinateMode.DataValue,\n\t\t\t\t\tyCoordinateMode: ECoordinateMode.DataValue,\n\t\t\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t\t\tx1: x,\n\t\t\t\t\ty1: y + yAnimOffset,\n\t\t\t\t\topacity: 0,\n\t\t\t\t\tverticalAnchorPoint: EVerticalAnchorPoint.Bottom,\n\t\t\t\t\thorizontalAnchorPoint: EHorizontalAnchorPoint.Center,\n\t\t\t\t\tsvgString: `\n\t\t\t\t\t<svg height=\"50\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<g transform=\"translate(11.5,2)\">\n\t\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-corner-left-down\"><polyline points=\"14 15 9 20 4 15\"/><path d=\"M20 4h-7a4 4 0 0 0-4 4v12\"/></svg>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t\t<text x=\"48\" y=\"8\" dominant-baseline=\"middle\" text-anchor=\"middle\" stroke-width=\"2\" paint-order=\"stroke\" stroke=\"black\" fill=\"currentColor\" font-size=\"14px\">${String.fromCharCode(65 + i)}1</text>\n\t\t\t\t\t</svg>`,\n\t\t\t\t});\n\t\t\t\tsurface.annotations.add(a);\n\n\t\t\t\tconst b = new CustomAnnotation({\n\t\t\t\t\tid: String.fromCharCode(65 + i) + '-peak-2',\n\t\t\t\t\txCoordinateMode: ECoordinateMode.DataValue,\n\t\t\t\t\tyCoordinateMode: ECoordinateMode.DataValue,\n\t\t\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t\t\tx1: x2,\n\t\t\t\t\ty1: y2 + yAnimOffset,\n\t\t\t\t\topacity: 0,\n\t\t\t\t\tverticalAnchorPoint: EVerticalAnchorPoint.Bottom,\n\t\t\t\t\thorizontalAnchorPoint: EHorizontalAnchorPoint.Center,\n\t\t\t\t\tsvgString: `\n\t\t\t\t\t<svg height=\"50\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<g transform=\"translate(11.5,2)\">\n\t\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-corner-left-down\"><polyline points=\"14 15 9 20 4 15\"/><path d=\"M20 4h-7a4 4 0 0 0-4 4v12\"/></svg>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t\t<text x=\"48\" y=\"8\" dominant-baseline=\"middle\" text-anchor=\"middle\" stroke-width=\"2\" paint-order=\"stroke\" stroke=\"black\" fill=\"currentColor\" font-size=\"14px\">${String.fromCharCode(65 + i)}2</text>\n\t\t\t\t\t</svg>`,\n\t\t\t\t});\n\t\t\t\tsurface.annotations.add(b);\n\t\t\t\treturn [\n\t\t\t\t\tnew Promise<void>((resolve) => {\n\t\t\t\t\t\tconst annotationAnimation1 = new GenericAnimation({\n\t\t\t\t\t\t\tfrom: { opacity: 0, y1: y + yAnimOffset },\n\t\t\t\t\t\t\tto: { opacity: 1, y1: y },\n\t\t\t\t\t\t\tduration: 200,\n\t\t\t\t\t\t\tdelay: delay + i * 200,\n\t\t\t\t\t\t\tease: easing.outCubic,\n\t\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\t\ta.opacity = DoubleAnimator.interpolate(from.opacity, to.opacity, progress);\n\t\t\t\t\t\t\t\ta.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsurface.addAnimation(annotationAnimation1);\n\t\t\t\t\t}),\n\t\t\t\t\tnew Promise<void>((resolve) => {\n\t\t\t\t\t\tconst annotationAnimation2 = new GenericAnimation({\n\t\t\t\t\t\t\tfrom: { opacity: 0, y1: y2 + yAnimOffset },\n\t\t\t\t\t\t\tto: { opacity: 1, y1: y2 },\n\t\t\t\t\t\t\tduration: 200,\n\t\t\t\t\t\t\tdelay: delay + i * 200,\n\t\t\t\t\t\t\tease: easing.outCubic,\n\t\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\t\tb.opacity = DoubleAnimator.interpolate(from.opacity, to.opacity, progress);\n\t\t\t\t\t\t\t\tb.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsurface.addAnimation(annotationAnimation2);\n\t\t\t\t\t}),\n\t\t\t\t];\n\t\t\t}\n\t\t})\n\t\t.concat(\n\t\t\tunpairedPeaks1.concat(unpairedPeaks2).map((p, i) => {\n\t\t\t\tconst x = p.freq;\n\t\t\t\tconst y = p.amplitude;\n\t\t\t\tif (surface.annotations.getById('unpaired-peak-' + i) != null) {\n\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t}\n\t\t\t\tconst a = new CustomAnnotation({\n\t\t\t\t\tid: 'unpaired-peak-' + i,\n\t\t\t\t\txCoordinateMode: ECoordinateMode.DataValue,\n\t\t\t\t\tyCoordinateMode: ECoordinateMode.DataValue,\n\t\t\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t\t\tx1: x,\n\t\t\t\t\ty1: y + yAnimOffset,\n\t\t\t\t\topacity: 0,\n\t\t\t\t\tverticalAnchorPoint: EVerticalAnchorPoint.Bottom,\n\t\t\t\t\thorizontalAnchorPoint: EHorizontalAnchorPoint.Right,\n\t\t\t\t\tsvgString: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" class=\"stroke-red-600\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-x\"><path d=\"M18 6 6 18\"/><path d=\"m6 6 12 12\"/></svg>`,\n\t\t\t\t});\n\t\t\t\tsurface.annotations.add(a);\n\t\t\t\treturn new Promise<void>((resolve) => {\n\t\t\t\t\tconst annotationAnimation1 = new GenericAnimation({\n\t\t\t\t\t\tfrom: { opacity: 0, y1: y + yAnimOffset },\n\t\t\t\t\t\tto: { opacity: 1, y1: y },\n\t\t\t\t\t\tduration: 200,\n\t\t\t\t\t\tdelay: delay + pairs.length * 200 + i * 200,\n\t\t\t\t\t\tease: easing.outCubic,\n\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\ta.opacity = DoubleAnimator.interpolate(from.opacity, to.opacity, progress);\n\t\t\t\t\t\t\ta.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t});\n\t\t\t\t\tsurface.addAnimation(annotationAnimation1);\n\t\t\t\t});\n\t\t\t}),\n\t\t);\n\treturn await Promise.all(annotations);\n};\n\nexport const removeBeltTensionChartAnnotations = async (\n\tsurface: SciChartSurface | null,\n\tfromPairIndex: number = 0,\n\tfromUnpairedIndex: number = 0,\n) => {\n\tif (surface == null) {\n\t\treturn;\n\t}\n\tlet i = fromPairIndex;\n\tconst yAnimOffset = surface.yAxes.getById(PSD_CHART_AXIS_AMPLITUDE_ID)?.visibleRange.max * 0.1;\n\tconst promises: Promise<void>[] = [];\n\twhile (surface.annotations.getById(String.fromCharCode(65 + i) + '-peak-1') != null) {\n\t\tconst a = surface.annotations.getById(String.fromCharCode(65 + i) + '-peak-1');\n\t\tconst b = surface.annotations.getById(String.fromCharCode(65 + i) + '-peak-2');\n\t\ti++;\n\t\tif (a != null) {\n\t\t\tpromises.push(\n\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\tconst annotationAnimation1 = new GenericAnimation({\n\t\t\t\t\t\tfrom: { opacity: a.opacity, y1: a.y1 },\n\t\t\t\t\t\tto: { opacity: 0, y1: a.y1 - yAnimOffset },\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\ta.opacity = DoubleAnimator.interpolate(from.opacity, to.opacity, progress);\n\t\t\t\t\t\t\ta.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCompleted: () => {\n\t\t\t\t\t\t\tsurface.annotations.remove(a);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tsurface.addAnimation(annotationAnimation1);\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t\tif (b != null) {\n\t\t\tpromises.push(\n\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\tconst annotationAnimation2 = new GenericAnimation({\n\t\t\t\t\t\tfrom: { opacity: b.opacity, y1: b.y1 },\n\t\t\t\t\t\tto: { opacity: 0, y1: b.y1 - yAnimOffset },\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\tb.opacity = DoubleAnimator.interpolate(from.opacity, to.opacity, progress);\n\t\t\t\t\t\t\tb.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCompleted: () => {\n\t\t\t\t\t\t\tsurface.annotations.remove(b);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tsurface.addAnimation(annotationAnimation2);\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\tlet j = fromUnpairedIndex;\n\twhile (surface.annotations.getById('unpaired-peak-' + j) != null) {\n\t\tconst a = surface.annotations.getById('unpaired-peak-' + j);\n\t\tj++;\n\t\tif (a != null) {\n\t\t\tpromises.push(\n\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\tconst annotationAnimation1 = new GenericAnimation({\n\t\t\t\t\t\tfrom: { opacity: a.opacity, y1: a.y1 },\n\t\t\t\t\t\tto: { opacity: 0, y1: a.y1 - yAnimOffset },\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\ta.opacity = DoubleAnimator.interpolate(from.opacity, to.opacity, progress);\n\t\t\t\t\t\t\ta.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCompleted: () => {\n\t\t\t\t\t\t\tsurface.annotations.remove(a);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tsurface.addAnimation(annotationAnimation1);\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\treturn await Promise.all(promises);\n};\n\nexport const updateBeltTensionChartAnnotations = async (\n\tsurface: SciChartSurface | null,\n\tsequencePair: [SequenceData, SequenceData] | null,\n\tpairedPeaks: PeakPairingResult | null,\n) => {\n\tif (sequencePair == null || pairedPeaks == null || surface == null) {\n\t\treturn await removeBeltTensionChartAnnotations(surface);\n\t}\n\tconst { pairedPeaks: pairs, unpairedPeaks1, unpairedPeaks2 } = pairedPeaks;\n\tlet foundPairs = 0;\n\tlet foundUnpaired = 0;\n\tconst promises = pairs\n\t\t.flatMap(async ([p1, p2], i) => {\n\t\t\tconst x = p1.freq;\n\t\t\tconst y = p1.amplitude;\n\t\t\tconst x2 = p2.freq;\n\t\t\tconst y2 = p2.amplitude;\n\t\t\tconst a = surface.annotations.getById(String.fromCharCode(65 + i) + '-peak-1');\n\t\t\tconst b = surface.annotations.getById(String.fromCharCode(65 + i) + '-peak-2');\n\t\t\tif (a == null || b == null) {\n\t\t\t\treturn [Promise.resolve()];\n\t\t\t}\n\t\t\tfoundPairs++;\n\t\t\treturn [\n\t\t\t\tnew Promise<void>((resolve) => {\n\t\t\t\t\tconst annotationAnimation1 = new GenericAnimation({\n\t\t\t\t\t\tfrom: { x1: a.x1, y1: a.y1 },\n\t\t\t\t\t\tto: { x1: x, y1: y },\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\ta.x1 = DoubleAnimator.interpolate(from.x1, to.x1, progress);\n\t\t\t\t\t\t\ta.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t});\n\t\t\t\t\tsurface.addAnimation(annotationAnimation1);\n\t\t\t\t}),\n\t\t\t\tnew Promise<void>((resolve) => {\n\t\t\t\t\tconst annotationAnimation2 = new GenericAnimation({\n\t\t\t\t\t\tfrom: { x1: b.x1, y1: b.y1 },\n\t\t\t\t\t\tto: { x1: x2, y1: y2 },\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\tb.x1 = DoubleAnimator.interpolate(from.x1, to.x1, progress);\n\t\t\t\t\t\t\tb.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t});\n\t\t\t\t\tsurface.addAnimation(annotationAnimation2);\n\t\t\t\t}),\n\t\t\t];\n\t\t})\n\t\t.concat(\n\t\t\tunpairedPeaks1.concat(unpairedPeaks2).flatMap(async (p, i) => {\n\t\t\t\tconst x = p.freq;\n\t\t\t\tconst y = p.amplitude;\n\t\t\t\tconst a = surface.annotations.getById('unpaired-peak-' + i);\n\t\t\t\tif (a == null) {\n\t\t\t\t\treturn [Promise.resolve()];\n\t\t\t\t}\n\t\t\t\tfoundUnpaired++;\n\t\t\t\treturn [\n\t\t\t\t\tnew Promise<void>((resolve) => {\n\t\t\t\t\t\tconst annotationAnimation1 = new GenericAnimation({\n\t\t\t\t\t\t\tfrom: { x1: a.x1, y1: a.y1 },\n\t\t\t\t\t\t\tto: { x1: x, y1: y },\n\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\tonAnimate: (from, to, progress) => {\n\t\t\t\t\t\t\t\ta.x1 = DoubleAnimator.interpolate(from.x1, to.x1, progress);\n\t\t\t\t\t\t\t\ta.y1 = DoubleAnimator.interpolate(from.y1, to.y1, progress);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsurface.addAnimation(annotationAnimation1);\n\t\t\t\t\t}),\n\t\t\t\t];\n\t\t\t}),\n\t\t);\n\t// Remove old pairs\n\treturn await Promise.all([removeBeltTensionChartAnnotations(surface, foundPairs, foundUnpaired), ...promises]);\n};\n\nexport const useInputShapersState = () => {\n\tconst [sequenceId, setSequenceId] = useState<string | null>(null);\n\tconst [shapers, setShapers] = useState<ShaperCalibrationResult[]>([]);\n\tconst [recommendedShaper, setRecommendedShaper] = useState<ShaperCalibrationResult | null>(null);\n\treturn {\n\t\tshapers,\n\t\tsetShapers,\n\t\trecommendedShaper,\n\t\tsetRecommendedShaper,\n\t\tsequenceId,\n\t\tsetSequenceId,\n\t};\n};\n\nexport const initSeriesSubcomponents = (surface: SciChartSurface | null, sequenceData: SequenceData) => {\n\tif (surface == null) {\n\t\treturn null;\n\t}\n\t// Find original series\n\tconst originalSeries = surface.renderableSeries.asArray().find((rs) => rs.id === sequenceData.sequenceId);\n\tif (originalSeries != null) {\n\t\t// Fix series title\n\t\toriginalSeries.rolloverModifierProps.tooltipTitle = sequenceData.name + ' (Total)';\n\t}\n\n\t// Initialize subcomponents\n\tfor (const axis of ['x', 'y', 'z'] as (keyof SequenceData['psd'])[]) {\n\t\tif (surface.renderableSeries.getById(sequenceData.sequenceId + '-sub-' + axis) == null) {\n\t\t\tconst color: TWShadeableColorName = axis === 'x' ? 'red' : axis === 'y' ? 'yellow' : 'blue';\n\t\t\tconst rs = new FastLineRenderableSeries(surface.webAssemblyContext2D, {\n\t\t\t\tid: sequenceData.sequenceId + '-sub-' + axis,\n\t\t\t\tdataSeries: new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\tisSorted: true,\n\t\t\t\t\txValues: sequenceData.psd[axis].frequencies,\n\t\t\t\t\tyValues: sequenceData.psd[axis].estimates,\n\t\t\t\t}),\n\t\t\t\tstroke: shadableTWColors[color][400],\n\t\t\t\tstrokeThickness: 2,\n\t\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t});\n\t\t\trs.rolloverModifierProps.tooltipTitle = sequenceData.name + ' Power';\n\t\t\trs.rolloverModifierProps.tooltipColor = color;\n\t\t\trs.animation = new WaveAnimation({\n\t\t\t\tduration: 1000,\n\t\t\t\tease: easing.inOutCubic,\n\t\t\t\tfadeEffect: true,\n\t\t\t});\n\t\t\tsurface.renderableSeries.add(rs);\n\t\t}\n\t}\n};\n\nexport const updateSeriesSubcomponents = (surface: SciChartSurface | null, sequenceData: SequenceData) => {\n\tif (surface == null) {\n\t\treturn null;\n\t}\n\t// Find original series\n\tconst originalSeries = surface.renderableSeries.asArray().find((rs) => rs.id === sequenceData.sequenceId);\n\tif (originalSeries != null) {\n\t\t// Fix series title\n\t\toriginalSeries.rolloverModifierProps.tooltipTitle = sequenceData.name + ' (Total)';\n\t}\n\t// Update subcomponents\n\tfor (const axis of ['x', 'y', 'z'] as (keyof SequenceData['psd'])[]) {\n\t\tconst rs = surface.renderableSeries.getById(sequenceData.sequenceId + '-sub-' + axis);\n\t\tif (rs == null) {\n\t\t\tcontinue;\n\t\t}\n\t\tconst newDs = new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\tcontainsNaN: false,\n\t\t\tisSorted: true,\n\t\t\txValues: sequenceData.psd[axis].frequencies,\n\t\t\tyValues: sequenceData.psd[axis].estimates,\n\t\t});\n\t\tsurface.addDeletable(newDs);\n\t\trs.enqueueAnimation(\n\t\t\tnew LineAnimation({\n\t\t\t\tduration: 500,\n\t\t\t\tease: easing.inOutCirc,\n\t\t\t\tdataSeries: newDs,\n\t\t\t}),\n\t\t);\n\t}\n};\n\nexport const useSeriesSubcomponentsChart = () => {\n\tconst [subcomponentSeries, setSubcomponentSeries] = useState<string[]>([]);\n\treturn {\n\t\tsubcomponentSeries,\n\t\tsetSubcomponentSeries,\n\t};\n};\n\nexport const useInputShaperChart = (\n\tenabled: boolean,\n\tsequenceData: SequenceData,\n\tshapers: ShaperCalibrationResult[],\n\trecommendedShaper?: ShaperCalibrationResult | null,\n) => {\n\tconst currentInputShapers = useRef(shapers);\n\tcurrentInputShapers.current = shapers;\n\tconst currentRecommendedShaper = useRef(recommendedShaper);\n\tcurrentRecommendedShaper.current = recommendedShaper;\n\tconst prevShapers = useRef(shapers);\n\tconst prevRecommendedShaper = useRef(recommendedShaper);\n\n\tconst initializeInputShapers = useCallback(\n\t\t(surface: SciChartSurface, skip: string[] = []) => {\n\t\t\t// Initialize input shapers\n\t\t\tif (currentRecommendedShaper.current != null && surface.renderableSeries.getById('recommended-shaper') == null) {\n\t\t\t\tconst rs = new FastMountainRenderableSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\tid: 'recommended-shaper',\n\t\t\t\t\tdataSeries: new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\txValues: sequenceData.psd.total.frequencies,\n\t\t\t\t\t\tyValues: currentRecommendedShaper.current.psd,\n\t\t\t\t\t}),\n\t\t\t\t\tstroke: shadableTWColors[currentRecommendedShaper.current.color][400],\n\t\t\t\t\tfill: shadableTWColors[currentRecommendedShaper.current.color][600] + 11,\n\t\t\t\t\tstrokeThickness: 4,\n\t\t\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t\t});\n\t\t\t\trs.rolloverModifierProps.tooltipTitle =\n\t\t\t\t\tcurrentRecommendedShaper.current.name.toLocaleUpperCase() +\n\t\t\t\t\t' @ ' +\n\t\t\t\t\tMath.round(currentRecommendedShaper.current.freq * 100) / 100 +\n\t\t\t\t\t'Hz';\n\t\t\t\trs.rolloverModifierProps.tooltipColor = currentRecommendedShaper.current.color;\n\t\t\t\trs.animation = new WaveAnimation({\n\t\t\t\t\tduration: 1000,\n\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\tfadeEffect: true,\n\t\t\t\t});\n\t\t\t\tsurface.renderableSeries.add(rs);\n\t\t\t}\n\t\t\tcurrentInputShapers.current?.forEach((shaper, i) => {\n\t\t\t\tif (surface == null || skip.includes(shaper.name) || surface.renderableSeries.getById(shaper.name) != null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst rs = new FastLineRenderableSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\tid: shaper.name,\n\t\t\t\t\tdataSeries: new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\txValues: sequenceData.psd.total.frequencies,\n\t\t\t\t\t\tyValues: shaper.vals,\n\t\t\t\t\t}),\n\t\t\t\t\tstroke: shadableTWColors[shaper.color][400],\n\t\t\t\t\tstrokeThickness: shaper.name === currentRecommendedShaper.current?.name ? 5 : 2,\n\t\t\t\t\tstrokeDashArray: shaper.name === currentRecommendedShaper.current?.name ? [10, 5, 2, 5] : [3, 5],\n\t\t\t\t\tyAxisId: PSD_CHART_AXIS_SHAPER_ID,\n\t\t\t\t});\n\t\t\t\trs.rolloverModifierProps.showRollover = false;\n\t\t\t\trs.animation = new WaveAnimation({\n\t\t\t\t\tduration: 1000,\n\t\t\t\t\tease: easing.inOutCubic,\n\t\t\t\t\tfadeEffect: true,\n\t\t\t\t});\n\t\t\t\tsurface.renderableSeries.add(rs);\n\t\t\t});\n\t\t\tprevShapers.current = currentInputShapers.current;\n\t\t},\n\t\t[sequenceData],\n\t);\n\n\tconst updateInputShapers = useCallback(\n\t\tasync (surface: SciChartSurface) => {\n\t\t\t// Update input shapers\n\t\t\tif (surface == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tenabled === true &&\n\t\t\t\t(shapers?.length ?? 0) > 0 &&\n\t\t\t\t(deepEqual(shapers, prevShapers.current) === false ||\n\t\t\t\t\t(recommendedShaper &&\n\t\t\t\t\t\t(deepEqual(recommendedShaper, prevRecommendedShaper.current) === false ||\n\t\t\t\t\t\t\tprevRecommendedShaper.current == null)))\n\t\t\t) {\n\t\t\t\tif ((prevShapers.current?.length ?? 0) > 0) {\n\t\t\t\t\t// Animate input shapers\n\t\t\t\t\tconst skip: string[] = [];\n\t\t\t\t\tsurface.renderableSeries\n\t\t\t\t\t\t.asArray()\n\t\t\t\t\t\t.filter((rs) => rs.yAxisId === PSD_CHART_AXIS_SHAPER_ID)\n\t\t\t\t\t\t.forEach((rs) => {\n\t\t\t\t\t\t\tif (surface == null) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst shaper = shapers?.find((shaper) => shaper.name === rs.id);\n\t\t\t\t\t\t\tconst prevShaper = prevShapers.current?.find((shaper) => shaper.name === rs.id);\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t(shaper && prevShaper && !deepEqual(shaper.vals, prevShaper.vals)) ||\n\t\t\t\t\t\t\t\t(currentRecommendedShaper.current?.name === rs.id && prevRecommendedShaper.current?.name != rs.id)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tconst newDs = new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tsurface.addDeletable(newDs);\n\t\t\t\t\t\t\t\tif (shaper == null) {\n\t\t\t\t\t\t\t\t\t// Remove shaper if it no longer exists\n\t\t\t\t\t\t\t\t\tnewDs.appendRange(sequenceData.psd.total.frequencies, new Array(rs.dataSeries.count()).fill(0));\n\t\t\t\t\t\t\t\t\tsurface.addDeletable(newDs);\n\t\t\t\t\t\t\t\t\trs.enqueueAnimation(\n\t\t\t\t\t\t\t\t\t\tnew LineAnimation({\n\t\t\t\t\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\t\t\t\t\tfadeEffect: true,\n\t\t\t\t\t\t\t\t\t\t\treverse: true,\n\t\t\t\t\t\t\t\t\t\t\tdataSeries: newDs,\n\t\t\t\t\t\t\t\t\t\t\tonCompleted: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tsurface?.renderableSeries.remove(rs, true);\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!rs.isRunningAnimation) {\n\t\t\t\t\t\t\t\t\tnewDs.appendRange(sequenceData.psd.total.frequencies, shaper.vals);\n\t\t\t\t\t\t\t\t\trs.enqueueAnimation(\n\t\t\t\t\t\t\t\t\t\tnew LineAnimation({\n\t\t\t\t\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\t\t\t\t\tdataSeries: newDs,\n\t\t\t\t\t\t\t\t\t\t\tstyles: {\n\t\t\t\t\t\t\t\t\t\t\t\tstrokeThickness: rs.id === currentRecommendedShaper.current?.name ? 5 : 2,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tskip.push(rs.id);\n\t\t\t\t\t\t});\n\t\t\t\t\tinitializeInputShapers(surface, skip);\n\t\t\t\t} else {\n\t\t\t\t\tinitializeInputShapers(surface);\n\t\t\t\t}\n\t\t\t} else if (shapers?.length === 0 && (prevShapers.current?.length ?? 0) > 0) {\n\t\t\t\t// Animate input shapers to zero\n\t\t\t\tsurface.renderableSeries\n\t\t\t\t\t.asArray()\n\t\t\t\t\t.filter((rs) => rs.yAxisId === PSD_CHART_AXIS_SHAPER_ID || rs.id === 'recommended-shaper')\n\t\t\t\t\t.forEach((rs) => {\n\t\t\t\t\t\tif (surface == null || rs.isRunningAnimation) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst newDs = new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsurface.addDeletable(newDs);\n\t\t\t\t\t\tif (rs.dataSeries == null) {\n\t\t\t\t\t\t\tgetLogger().warn(rs.id, 'dataSeries is null');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewDs.appendRange(sequenceData.psd.total.frequencies, new Array(rs.dataSeries.count()).fill(0));\n\t\t\t\t\t\trs.enqueueAnimation(\n\t\t\t\t\t\t\tnew LineAnimation({\n\t\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\t\tfadeEffect: true,\n\t\t\t\t\t\t\t\treverse: true,\n\t\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\t\tdataSeries: newDs,\n\t\t\t\t\t\t\t\tonCompleted: () => {\n\t\t\t\t\t\t\t\t\tsurface?.renderableSeries.remove(rs, true);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\t// if (\n\t\t\t// \tenabled === true &&\n\t\t\t// \t(shapers?.length ?? 0) > 0 &&\n\t\t\t// \trecommendedShaper &&\n\t\t\t// \tdeepEqual(recommendedShaper, prevRecommendedShaper.current) === false\n\t\t\t// ) {\n\t\t\t// \tconst rs = surface.renderableSeries.getById(recommendedShaper.name);\n\t\t\t// \tif (surface == null || rs.isRunningAnimation) {\n\t\t\t// \t\treturn;\n\t\t\t// \t}\n\t\t\t// \tconst newDs = new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t// \t\tcontainsNaN: false,\n\t\t\t// \t\tisSorted: true,\n\t\t\t// \t});\n\t\t\t// \tsurface.addDeletable(newDs);\n\t\t\t// \tif (rs.dataSeries == null) {\n\t\t\t// \t\tgetLogger().warn(rs.id, 'dataSeries is null');\n\t\t\t// \t\treturn;\n\t\t\t// \t}\n\t\t\t// \tnewDs.appendRange(sequenceData.psd.total.frequencies, new Array(rs.dataSeries.count()).fill(0));\n\t\t\t// \tawait new Promise<void>((resolve) => {\n\t\t\t// \t\trs.enqueueAnimation(\n\t\t\t// \t\t\tnew LineAnimation({\n\t\t\t// \t\t\t\tduration: 500,\n\t\t\t// \t\t\t\tfadeEffect: true,\n\t\t\t// \t\t\t\treverse: true,\n\t\t\t// \t\t\t\tease: easing.inOutCirc,\n\t\t\t// \t\t\t\tdataSeries: newDs,\n\t\t\t// \t\t\t\tonCompleted: () => {\n\t\t\t// \t\t\t\t\tsurface?.renderableSeries.remove(rs, true);\n\t\t\t// \t\t\t\t\tresolve();\n\t\t\t// \t\t\t\t},\n\t\t\t// \t\t\t}),\n\t\t\t// \t\t);\n\t\t\t// \t});\n\t\t\t// \tconst newRs = new FastLineRenderableSeries(surface.webAssemblyContext2D, {\n\t\t\t// \t\tid: recommendedShaper.name,\n\t\t\t// \t\tdataSeries: new XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\t// \t\t\tcontainsNaN: false,\n\t\t\t// \t\t\tisSorted: true,\n\t\t\t// \t\t\txValues: sequenceData.psd.total.frequencies,\n\t\t\t// \t\t\tyValues: recommendedShaper.psd,\n\t\t\t// \t\t}),\n\t\t\t// \t\tstroke: shadableTWColors[recommendedShaper.color][400],\n\t\t\t// \t\tstrokeThickness: 5,\n\t\t\t// \t\tstrokeDashArray: [10, 5, 2, 5],\n\t\t\t// \t\tyAxisId: PSD_CHART_AXIS_SHAPER_ID,\n\t\t\t// \t});\n\t\t\t// \tnewRs.rolloverModifierProps.showRollover = false;\n\t\t\t// \tnewRs.animation = new WaveAnimation({\n\t\t\t// \t\tduration: 1000,\n\t\t\t// \t\tease: easing.inOutCubic,\n\t\t\t// \t\tfadeEffect: true,\n\t\t\t// \t});\n\t\t\t// \tsurface.renderableSeries.add(newRs);\n\t\t\t// \tprevRecommendedShaper.current = recommendedShaper;\n\t\t\t// }\n\t\t\tprevRecommendedShaper.current = recommendedShaper;\n\t\t\tprevShapers.current = shapers;\n\t\t},\n\t\t[enabled, shapers, recommendedShaper, initializeInputShapers, sequenceData.psd.total.frequencies],\n\t);\n\n\treturn {\n\t\tupdateInputShapers,\n\t\tinitializeInputShapers,\n\t\tshapers,\n\t\tprevShapers,\n\t};\n};\n","'use client';\nimport { isXyDataSeries, isXyyDataSeries } from '@/app/analysis/charts';\nimport React, { MutableRefObject, useCallback, useEffect, useRef, useState } from 'react';\nimport {\n\tBandAnimation,\n\tLineAnimation,\n\tMountainAnimation,\n\tSciChartSurface,\n\tXyDataSeries,\n\tXyyDataSeries,\n\teasing,\n} from 'scichart';\nimport { shadableTWColors } from '@/app/_helpers/colors';\nimport { SciChartReact } from 'scichart-react';\nimport deepEqual from 'deep-equal';\nimport { animateYAxis, SequenceData, setupChart } from '@/app/analysis/macros/[id]/recordings/[runId]/setup';\nimport { ShaperCalibrationResult } from '@/app/analysis/_worker/input-shaper';\nimport { useChart } from '@/app/analysis/hooks';\nimport {\n\tuseSeriesSubcomponentsChart,\n\tuseInputShaperChart,\n\tinitSeriesSubcomponents,\n\tupdateSeriesSubcomponents,\n} from '@/app/analysis/macros/hooks';\n\nSciChartSurface.configure({\n\twasmUrl: '/configure/scichart2d.wasm',\n\tdataUrl: '/configure/scichart2d.data',\n});\n\ninterface MacroRunChartProps {\n\tsequenceSeries: SequenceData[];\n\tshapers?: ShaperCalibrationResult[];\n\tprevShapers?: MutableRefObject<ShaperCalibrationResult[]>;\n\trecommendedShaper?: ShaperCalibrationResult | null;\n\tchart: ReturnType<typeof useChart>;\n\tsubcomponentSeries: ReturnType<typeof useSeriesSubcomponentsChart>['subcomponentSeries'];\n}\n\nexport const MacroRunChart: React.FC<MacroRunChartProps> = (props) => {\n\tconst { sequenceSeries, shapers, recommendedShaper, chart, prevShapers, subcomponentSeries } = props;\n\tconst [isTransitioning, setIsTransitioning] = useState(false);\n\tconst isTransitioningRef = useRef(isTransitioning);\n\tisTransitioningRef.current = isTransitioning;\n\tconst afterTransition = useRef<Promise<void | void[]>>(Promise.resolve());\n\tconst subComponentSeriesRef = useRef(subcomponentSeries);\n\tsubComponentSeriesRef.current = subcomponentSeries;\n\n\tconst prevSequenceData = useRef(sequenceSeries);\n\tconst { updateInputShapers, initializeInputShapers } = useInputShaperChart(\n\t\t(shapers?.length ?? 0) > 0,\n\t\tsequenceSeries[0],\n\t\tshapers ?? [],\n\t\trecommendedShaper,\n\t);\n\n\tconst transitionToChart = useCallback(\n\t\t(data: typeof sequenceSeries) => {\n\t\t\tif (chart.surface.current == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst subcomponentData = data.filter((d) => subcomponentSeries.includes(d.sequenceId));\n\t\t\t// if no previous sequenceSeries, run setupChart\n\t\t\tif (prevSequenceData.current.length === 0) {\n\t\t\t\tsetupChart(chart.surface.current, data);\n\t\t\t\tinitializeInputShapers(chart.surface.current);\n\t\t\t\tsubcomponentData.forEach((seq) => {\n\t\t\t\t\tinitSeriesSubcomponents(chart.surface.current, seq);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetIsTransitioning(true);\n\t\t\tconst promises: Promise<void | void>[] = [];\n\t\t\t// If same number of data series, animate style and data\n\t\t\tif (data.length === prevSequenceData.current.length) {\n\t\t\t\tdata.forEach((seq, i) => {\n\t\t\t\t\tconst rs = chart.surface.current?.renderableSeries.get(i);\n\t\t\t\t\tif (rs) {\n\t\t\t\t\t\tif (chart.surface.current == null) {\n\t\t\t\t\t\t\tthrow new Error('Missing chart surface');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst prevCount = rs.dataSeries.count();\n\t\t\t\t\t\tif (isXyyDataSeries(rs.dataSeries)) {\n\t\t\t\t\t\t\t// We're dealing with a band series, which means it's combined with the next sequence as well.\n\t\t\t\t\t\t\tconst nextSeq = data[i + 1];\n\t\t\t\t\t\t\tif (prevCount > seq.psd.total.frequencies.length) {\n\t\t\t\t\t\t\t\t// Pad new sequence data\n\t\t\t\t\t\t\t\tconst padFreq = new Array(prevCount - seq.psd.total.frequencies.length).fill(0);\n\t\t\t\t\t\t\t\tconst padEstimates = new Array(prevCount - seq.psd.total.estimates.length).fill(0);\n\t\t\t\t\t\t\t\tseq.psd.total.frequencies.unshift(...padFreq);\n\t\t\t\t\t\t\t\tseq.psd.total.estimates.unshift(...padEstimates);\n\t\t\t\t\t\t\t\tnextSeq.psd.total.frequencies.unshift(...padFreq);\n\t\t\t\t\t\t\t\tnextSeq.psd.total.estimates.unshift(...padEstimates);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (prevCount < seq.psd.total.frequencies.length) {\n\t\t\t\t\t\t\t\t// Drop the last n elements of the new sequence data\n\t\t\t\t\t\t\t\tseq.psd.total.frequencies = seq.psd.total.frequencies.slice(0, prevCount);\n\t\t\t\t\t\t\t\tseq.psd.total.estimates = seq.psd.total.estimates.slice(0, prevCount);\n\t\t\t\t\t\t\t\tnextSeq.psd.total.frequencies = nextSeq.psd.total.frequencies.slice(0, prevCount);\n\t\t\t\t\t\t\t\tnextSeq.psd.total.estimates = nextSeq.psd.total.estimates.slice(0, prevCount);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst newDs = new XyyDataSeries(chart.surface.current.webAssemblyContext2D, {\n\t\t\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnewDs.appendRange(seq.psd.total.frequencies, seq.psd.total.estimates, nextSeq.psd.total.estimates);\n\t\t\t\t\t\t\tchart.surface.current.addDeletable(newDs);\n\t\t\t\t\t\t\trs.rolloverModifierProps.tooltipColor = seq.color ?? 'zinc';\n\t\t\t\t\t\t\trs.rolloverModifierProps.tooltipTitle = seq.name + ' Power';\n\t\t\t\t\t\t\trs.rolloverModifierProps1.tooltipColor = nextSeq.color ?? 'zinc';\n\t\t\t\t\t\t\trs.rolloverModifierProps1.tooltipTitle = nextSeq.name + ' Power';\n\t\t\t\t\t\t\tpromises.push(\n\t\t\t\t\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t\t\t\t\trs.runAnimation(\n\t\t\t\t\t\t\t\t\t\tnew BandAnimation({\n\t\t\t\t\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\t\t\t\t\tdataSeries: newDs,\n\t\t\t\t\t\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isXyDataSeries(rs.dataSeries)) {\n\t\t\t\t\t\t\tif (prevCount > seq.psd.total.frequencies.length) {\n\t\t\t\t\t\t\t\t// Pad new sequence data\n\t\t\t\t\t\t\t\tconst padFreq = new Array(prevCount - seq.psd.total.frequencies.length).fill(0);\n\t\t\t\t\t\t\t\tconst padEstimates = new Array(prevCount - seq.psd.total.estimates.length).fill(0);\n\t\t\t\t\t\t\t\tseq.psd.total.frequencies.unshift(...padFreq);\n\t\t\t\t\t\t\t\tseq.psd.total.estimates.unshift(...padEstimates);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (prevCount < seq.psd.total.frequencies.length) {\n\t\t\t\t\t\t\t\t// Drop the last n elements of the new sequence data\n\t\t\t\t\t\t\t\tseq.psd.total.frequencies = seq.psd.total.frequencies.slice(0, prevCount);\n\t\t\t\t\t\t\t\tseq.psd.total.estimates = seq.psd.total.estimates.slice(0, prevCount);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst newDs = new XyDataSeries(chart.surface.current.webAssemblyContext2D, {\n\t\t\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnewDs.appendRange(seq.psd.total.frequencies, seq.psd.total.estimates);\n\t\t\t\t\t\t\tchart.surface.current.addDeletable(newDs);\n\t\t\t\t\t\t\trs.rolloverModifierProps.tooltipColor = seq.color ?? 'zinc';\n\t\t\t\t\t\t\trs.rolloverModifierProps.tooltipTitle = seq.name + ' Power';\n\t\t\t\t\t\t\tpromises.push(\n\t\t\t\t\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t\t\t\t\trs.runAnimation(\n\t\t\t\t\t\t\t\t\t\tnew MountainAnimation({\n\t\t\t\t\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\t\t\t\t\tdataSeries: newDs,\n\t\t\t\t\t\t\t\t\t\t\tonCompleted: resolve,\n\t\t\t\t\t\t\t\t\t\t\tstyles: {\n\t\t\t\t\t\t\t\t\t\t\t\tstroke: shadableTWColors[(seq.color ?? 'zinc') as keyof typeof shadableTWColors][400],\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// Update input shapers\n\t\t\t\tupdateInputShapers(chart.surface.current);\n\t\t\t\tsubcomponentData.forEach((seq) => {\n\t\t\t\t\tupdateSeriesSubcomponents(chart.surface.current, seq);\n\t\t\t\t});\n\t\t\t\tanimateYAxis(chart.surface.current, data);\n\t\t\t\tafterTransition.current = Promise.all(promises);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// If different number of data series, animate data to zero, then run setupChart.\n\t\t\tif (data.length !== prevSequenceData.current.length) {\n\t\t\t\tchart.surface.current?.renderableSeries.asArray().forEach((rs) => {\n\t\t\t\t\tif (rs) {\n\t\t\t\t\t\tif (chart.surface.current == null) {\n\t\t\t\t\t\t\tthrow new Error('Missing chart surface');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst prevCount = rs.dataSeries.count();\n\t\t\t\t\t\tconst prevNativeXValues = rs.dataSeries.getNativeXValues();\n\t\t\t\t\t\tconst prevXValues: number[] = [];\n\t\t\t\t\t\tfor (let i = 0; i < prevNativeXValues.size(); i++) {\n\t\t\t\t\t\t\tprevXValues.push(prevNativeXValues.get(i));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isXyyDataSeries(rs.dataSeries)) {\n\t\t\t\t\t\t\tconst newDs = new XyyDataSeries(chart.surface.current.webAssemblyContext2D, {\n\t\t\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnewDs.appendRange(prevXValues, new Array(prevCount).fill(0), new Array(prevCount).fill(0));\n\t\t\t\t\t\t\tchart.surface.current.addDeletable(newDs);\n\t\t\t\t\t\t\tpromises.push(\n\t\t\t\t\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t\t\t\t\trs.runAnimation(\n\t\t\t\t\t\t\t\t\t\tnew BandAnimation({\n\t\t\t\t\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\t\t\t\t\tfadeEffect: true,\n\t\t\t\t\t\t\t\t\t\t\treverse: true,\n\t\t\t\t\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\t\t\t\t\tdataSeries: newDs,\n\t\t\t\t\t\t\t\t\t\t\tonCompleted: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tchart.surface.current?.renderableSeries.remove(rs);\n\t\t\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isXyDataSeries(rs.dataSeries)) {\n\t\t\t\t\t\t\tconst newDs = new XyDataSeries(chart.surface.current.webAssemblyContext2D, {\n\t\t\t\t\t\t\t\tcontainsNaN: false,\n\t\t\t\t\t\t\t\tisSorted: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnewDs.appendRange(prevXValues, new Array(prevCount).fill(0));\n\t\t\t\t\t\t\tchart.surface.current.addDeletable(newDs);\n\t\t\t\t\t\t\tpromises.push(\n\t\t\t\t\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t\t\t\t\trs.runAnimation(\n\t\t\t\t\t\t\t\t\t\tnew LineAnimation({\n\t\t\t\t\t\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\t\t\t\t\t\tease: easing.inOutCirc,\n\t\t\t\t\t\t\t\t\t\t\tdataSeries: newDs,\n\t\t\t\t\t\t\t\t\t\t\tfadeEffect: true,\n\t\t\t\t\t\t\t\t\t\t\treverse: true,\n\t\t\t\t\t\t\t\t\t\t\tonCompleted: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tchart.surface.current?.renderableSeries.remove(rs);\n\t\t\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tafterTransition.current = Promise.all(promises).then(\n\t\t\t\t\t() =>\n\t\t\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t\t\tif (chart.surface.current) {\n\t\t\t\t\t\t\t\tchart.surface.current?.renderableSeries.clear();\n\t\t\t\t\t\t\t\tchart.surface.current?.chartModifiers.clear();\n\t\t\t\t\t\t\t\tsetupChart(chart.surface.current, data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t},\n\t\t[chart.surface, initializeInputShapers, subcomponentSeries, updateInputShapers],\n\t);\n\n\tuseEffect(() => {\n\t\tif (sequenceSeries.length != 0 && deepEqual(sequenceSeries, prevSequenceData.current) === false) {\n\t\t\tif (chart.surface.current) {\n\t\t\t\ttransitionToChart(sequenceSeries);\n\t\t\t}\n\t\t\tprevSequenceData.current = sequenceSeries;\n\t\t} else {\n\t\t\tif (chart.surface.current) {\n\t\t\t\tupdateInputShapers(chart.surface.current);\n\t\t\t}\n\t\t}\n\t}, [\n\t\tchart.surface,\n\t\tinitializeInputShapers,\n\t\tprevShapers,\n\t\tsequenceSeries,\n\t\tshapers,\n\t\tsubcomponentSeries,\n\t\ttransitionToChart,\n\t\tupdateInputShapers,\n\t]);\n\n\tuseEffect(() => {\n\t\tif (subcomponentSeries.length && chart.surface.current) {\n\t\t\tif (isTransitioningRef.current) {\n\t\t\t\tafterTransition.current.then(() => {\n\t\t\t\t\tsubComponentSeriesRef.current.forEach((seq) => {\n\t\t\t\t\t\tsequenceSeries\n\t\t\t\t\t\t\t.filter((s) => subComponentSeriesRef.current.includes(s.sequenceId))\n\t\t\t\t\t\t\t.forEach((seq) => {\n\t\t\t\t\t\t\t\tinitSeriesSubcomponents(chart.surface.current, seq);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsubComponentSeriesRef.current.forEach((seq) => {\n\t\t\t\t\tsequenceSeries\n\t\t\t\t\t\t.filter((s) => subComponentSeriesRef.current.includes(s.sequenceId))\n\t\t\t\t\t\t.forEach((seq) => {\n\t\t\t\t\t\t\tinitSeriesSubcomponents(chart.surface.current, seq);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, [chart.surface, sequenceSeries, subcomponentSeries]);\n\n\treturn <SciChartReact {...chart.forwardProps} className=\"flex-1 bg-zinc-900/50\"></SciChartReact>;\n};\n","/**\n * @license lucide-react v0.363.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst SkipBack = createLucideIcon(\"SkipBack\", [\n  [\"polygon\", { points: \"19 20 9 12 19 4 19 20\", key: \"o2sva\" }],\n  [\"line\", { x1: \"5\", x2: \"5\", y1: \"19\", y2: \"5\", key: \"1ocqjk\" }]\n]);\n\nexport { SkipBack as default };\n//# sourceMappingURL=skip-back.js.map\n","/**\n * @license lucide-react v0.363.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst SkipForward = createLucideIcon(\"SkipForward\", [\n  [\"polygon\", { points: \"5 4 15 12 5 20 5 4\", key: \"16p6eg\" }],\n  [\"line\", { x1: \"19\", x2: \"19\", y1: \"5\", y2: \"19\", key: \"futhcm\" }]\n]);\n\nexport { SkipForward as default };\n//# sourceMappingURL=skip-forward.js.map\n","import { useContext, createContext, useState, useCallback, useRef, useLayoutEffect, useEffect } from 'react';\nimport { jsx } from 'react/jsx-runtime';\n\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\nvar reservedModifierKeywords = ['shift', 'alt', 'meta', 'mod', 'ctrl'];\nvar mappedKeys = {\n  esc: 'escape',\n  \"return\": 'enter',\n  '.': 'period',\n  ',': 'comma',\n  '-': 'slash',\n  ' ': 'space',\n  '`': 'backquote',\n  '#': 'backslash',\n  '+': 'bracketright',\n  ShiftLeft: 'shift',\n  ShiftRight: 'shift',\n  AltLeft: 'alt',\n  AltRight: 'alt',\n  MetaLeft: 'meta',\n  MetaRight: 'meta',\n  OSLeft: 'meta',\n  OSRight: 'meta',\n  ControlLeft: 'ctrl',\n  ControlRight: 'ctrl'\n};\nfunction mapKey(key) {\n  return (mappedKeys[key] || key).trim().toLowerCase().replace(/key|digit|numpad|arrow/, '');\n}\nfunction isHotkeyModifier(key) {\n  return reservedModifierKeywords.includes(key);\n}\nfunction parseKeysHookInput(keys, splitKey) {\n  if (splitKey === void 0) {\n    splitKey = ',';\n  }\n  return keys.split(splitKey);\n}\nfunction parseHotkey(hotkey, combinationKey, description) {\n  if (combinationKey === void 0) {\n    combinationKey = '+';\n  }\n  var keys = hotkey.toLocaleLowerCase().split(combinationKey).map(function (k) {\n    return mapKey(k);\n  });\n  var modifiers = {\n    alt: keys.includes('alt'),\n    ctrl: keys.includes('ctrl') || keys.includes('control'),\n    shift: keys.includes('shift'),\n    meta: keys.includes('meta'),\n    mod: keys.includes('mod')\n  };\n  var singleCharKeys = keys.filter(function (k) {\n    return !reservedModifierKeywords.includes(k);\n  });\n  return _extends({}, modifiers, {\n    keys: singleCharKeys,\n    description: description\n  });\n}\n\n(function () {\n  if (typeof document !== 'undefined') {\n    document.addEventListener('keydown', function (e) {\n      if (e.key === undefined) {\n        // Synthetic event (e.g., Chrome autofill).  Ignore.\n        return;\n      }\n      pushToCurrentlyPressedKeys([mapKey(e.key), mapKey(e.code)]);\n    });\n    document.addEventListener('keyup', function (e) {\n      if (e.key === undefined) {\n        // Synthetic event (e.g., Chrome autofill).  Ignore.\n        return;\n      }\n      removeFromCurrentlyPressedKeys([mapKey(e.key), mapKey(e.code)]);\n    });\n  }\n  if (typeof window !== 'undefined') {\n    window.addEventListener('blur', function () {\n      currentlyPressedKeys.clear();\n    });\n  }\n})();\nvar currentlyPressedKeys = /*#__PURE__*/new Set();\n// https://github.com/microsoft/TypeScript/issues/17002\nfunction isReadonlyArray(value) {\n  return Array.isArray(value);\n}\nfunction isHotkeyPressed(key, splitKey) {\n  if (splitKey === void 0) {\n    splitKey = ',';\n  }\n  var hotkeyArray = isReadonlyArray(key) ? key : key.split(splitKey);\n  return hotkeyArray.every(function (hotkey) {\n    return currentlyPressedKeys.has(hotkey.trim().toLowerCase());\n  });\n}\nfunction pushToCurrentlyPressedKeys(key) {\n  var hotkeyArray = Array.isArray(key) ? key : [key];\n  /*\r\n  Due to a weird behavior on macOS we need to clear the set if the user pressed down the meta key and presses another key.\r\n  https://stackoverflow.com/questions/11818637/why-does-javascript-drop-keyup-events-when-the-metakey-is-pressed-on-mac-browser\r\n  Otherwise the set will hold all ever pressed keys while the meta key is down which leads to wrong results.\r\n   */\n  if (currentlyPressedKeys.has('meta')) {\n    currentlyPressedKeys.forEach(function (key) {\n      return !isHotkeyModifier(key) && currentlyPressedKeys[\"delete\"](key.toLowerCase());\n    });\n  }\n  hotkeyArray.forEach(function (hotkey) {\n    return currentlyPressedKeys.add(hotkey.toLowerCase());\n  });\n}\nfunction removeFromCurrentlyPressedKeys(key) {\n  var hotkeyArray = Array.isArray(key) ? key : [key];\n  /*\r\n  Due to a weird behavior on macOS we need to clear the set if the user pressed down the meta key and presses another key.\r\n  https://stackoverflow.com/questions/11818637/why-does-javascript-drop-keyup-events-when-the-metakey-is-pressed-on-mac-browser\r\n  Otherwise the set will hold all ever pressed keys while the meta key is down which leads to wrong results.\r\n   */\n  if (key === 'meta') {\n    currentlyPressedKeys.clear();\n  } else {\n    hotkeyArray.forEach(function (hotkey) {\n      return currentlyPressedKeys[\"delete\"](hotkey.toLowerCase());\n    });\n  }\n}\n\nfunction maybePreventDefault(e, hotkey, preventDefault) {\n  if (typeof preventDefault === 'function' && preventDefault(e, hotkey) || preventDefault === true) {\n    e.preventDefault();\n  }\n}\nfunction isHotkeyEnabled(e, hotkey, enabled) {\n  if (typeof enabled === 'function') {\n    return enabled(e, hotkey);\n  }\n  return enabled === true || enabled === undefined;\n}\nfunction isKeyboardEventTriggeredByInput(ev) {\n  return isHotkeyEnabledOnTag(ev, ['input', 'textarea', 'select']);\n}\nfunction isHotkeyEnabledOnTag(_ref, enabledOnTags) {\n  var target = _ref.target;\n  if (enabledOnTags === void 0) {\n    enabledOnTags = false;\n  }\n  var targetTagName = target && target.tagName;\n  if (isReadonlyArray(enabledOnTags)) {\n    return Boolean(targetTagName && enabledOnTags && enabledOnTags.some(function (tag) {\n      return tag.toLowerCase() === targetTagName.toLowerCase();\n    }));\n  }\n  return Boolean(targetTagName && enabledOnTags && enabledOnTags === true);\n}\nfunction isScopeActive(activeScopes, scopes) {\n  if (activeScopes.length === 0 && scopes) {\n    console.warn('A hotkey has the \"scopes\" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>');\n    return true;\n  }\n  if (!scopes) {\n    return true;\n  }\n  return activeScopes.some(function (scope) {\n    return scopes.includes(scope);\n  }) || activeScopes.includes('*');\n}\nvar isHotkeyMatchingKeyboardEvent = function isHotkeyMatchingKeyboardEvent(e, hotkey, ignoreModifiers) {\n  if (ignoreModifiers === void 0) {\n    ignoreModifiers = false;\n  }\n  var alt = hotkey.alt,\n    meta = hotkey.meta,\n    mod = hotkey.mod,\n    shift = hotkey.shift,\n    ctrl = hotkey.ctrl,\n    keys = hotkey.keys;\n  var pressedKeyUppercase = e.key,\n    code = e.code,\n    ctrlKey = e.ctrlKey,\n    metaKey = e.metaKey,\n    shiftKey = e.shiftKey,\n    altKey = e.altKey;\n  var keyCode = mapKey(code);\n  var pressedKey = pressedKeyUppercase.toLowerCase();\n  if (!(keys != null && keys.includes(keyCode)) && !(keys != null && keys.includes(pressedKey)) && !['ctrl', 'control', 'unknown', 'meta', 'alt', 'shift', 'os'].includes(keyCode)) {\n    return false;\n  }\n  if (!ignoreModifiers) {\n    // We check the pressed keys for compatibility with the keyup event. In keyup events the modifier flags are not set.\n    if (alt === !altKey && pressedKey !== 'alt') {\n      return false;\n    }\n    if (shift === !shiftKey && pressedKey !== 'shift') {\n      return false;\n    }\n    // Mod is a special key name that is checking for meta on macOS and ctrl on other platforms\n    if (mod) {\n      if (!metaKey && !ctrlKey) {\n        return false;\n      }\n    } else {\n      if (meta === !metaKey && pressedKey !== 'meta' && pressedKey !== 'os') {\n        return false;\n      }\n      if (ctrl === !ctrlKey && pressedKey !== 'ctrl' && pressedKey !== 'control') {\n        return false;\n      }\n    }\n  }\n  // All modifiers are correct, now check the key\n  // If the key is set, we check for the key\n  if (keys && keys.length === 1 && (keys.includes(pressedKey) || keys.includes(keyCode))) {\n    return true;\n  } else if (keys) {\n    // Check if all keys are present in pressedDownKeys set\n    return isHotkeyPressed(keys);\n  } else if (!keys) {\n    // If the key is not set, we only listen for modifiers, that check went alright, so we return true\n    return true;\n  }\n  // There is nothing that matches.\n  return false;\n};\n\nvar BoundHotkeysProxyProvider = /*#__PURE__*/createContext(undefined);\nvar useBoundHotkeysProxy = function useBoundHotkeysProxy() {\n  return useContext(BoundHotkeysProxyProvider);\n};\nfunction BoundHotkeysProxyProviderProvider(_ref) {\n  var addHotkey = _ref.addHotkey,\n    removeHotkey = _ref.removeHotkey,\n    children = _ref.children;\n  return /*#__PURE__*/jsx(BoundHotkeysProxyProvider.Provider, {\n    value: {\n      addHotkey: addHotkey,\n      removeHotkey: removeHotkey\n    },\n    children: children\n  });\n}\n\nfunction deepEqual(x, y) {\n  //@ts-ignore\n  return x && y && typeof x === 'object' && typeof y === 'object' ? Object.keys(x).length === Object.keys(y).length &&\n  //@ts-ignore\n  Object.keys(x).reduce(function (isEqual, key) {\n    return isEqual && deepEqual(x[key], y[key]);\n  }, true) : x === y;\n}\n\nvar HotkeysContext = /*#__PURE__*/createContext({\n  hotkeys: [],\n  enabledScopes: [],\n  toggleScope: function toggleScope() {},\n  enableScope: function enableScope() {},\n  disableScope: function disableScope() {}\n});\nvar useHotkeysContext = function useHotkeysContext() {\n  return useContext(HotkeysContext);\n};\nvar HotkeysProvider = function HotkeysProvider(_ref) {\n  var _ref$initiallyActiveS = _ref.initiallyActiveScopes,\n    initiallyActiveScopes = _ref$initiallyActiveS === void 0 ? ['*'] : _ref$initiallyActiveS,\n    children = _ref.children;\n  var _useState = useState((initiallyActiveScopes == null ? void 0 : initiallyActiveScopes.length) > 0 ? initiallyActiveScopes : ['*']),\n    internalActiveScopes = _useState[0],\n    setInternalActiveScopes = _useState[1];\n  var _useState2 = useState([]),\n    boundHotkeys = _useState2[0],\n    setBoundHotkeys = _useState2[1];\n  var enableScope = useCallback(function (scope) {\n    setInternalActiveScopes(function (prev) {\n      if (prev.includes('*')) {\n        return [scope];\n      }\n      return Array.from(new Set([].concat(prev, [scope])));\n    });\n  }, []);\n  var disableScope = useCallback(function (scope) {\n    setInternalActiveScopes(function (prev) {\n      if (prev.filter(function (s) {\n        return s !== scope;\n      }).length === 0) {\n        return ['*'];\n      } else {\n        return prev.filter(function (s) {\n          return s !== scope;\n        });\n      }\n    });\n  }, []);\n  var toggleScope = useCallback(function (scope) {\n    setInternalActiveScopes(function (prev) {\n      if (prev.includes(scope)) {\n        if (prev.filter(function (s) {\n          return s !== scope;\n        }).length === 0) {\n          return ['*'];\n        } else {\n          return prev.filter(function (s) {\n            return s !== scope;\n          });\n        }\n      } else {\n        if (prev.includes('*')) {\n          return [scope];\n        }\n        return Array.from(new Set([].concat(prev, [scope])));\n      }\n    });\n  }, []);\n  var addBoundHotkey = useCallback(function (hotkey) {\n    setBoundHotkeys(function (prev) {\n      return [].concat(prev, [hotkey]);\n    });\n  }, []);\n  var removeBoundHotkey = useCallback(function (hotkey) {\n    setBoundHotkeys(function (prev) {\n      return prev.filter(function (h) {\n        return !deepEqual(h, hotkey);\n      });\n    });\n  }, []);\n  return /*#__PURE__*/jsx(HotkeysContext.Provider, {\n    value: {\n      enabledScopes: internalActiveScopes,\n      hotkeys: boundHotkeys,\n      enableScope: enableScope,\n      disableScope: disableScope,\n      toggleScope: toggleScope\n    },\n    children: /*#__PURE__*/jsx(BoundHotkeysProxyProviderProvider, {\n      addHotkey: addBoundHotkey,\n      removeHotkey: removeBoundHotkey,\n      children: children\n    })\n  });\n};\n\nfunction useDeepEqualMemo(value) {\n  var ref = useRef(undefined);\n  if (!deepEqual(ref.current, value)) {\n    ref.current = value;\n  }\n  return ref.current;\n}\n\nvar stopPropagation = function stopPropagation(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  e.stopImmediatePropagation();\n};\nvar useSafeLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\nfunction useHotkeys(keys, callback, options, dependencies) {\n  var ref = useRef(null);\n  var hasTriggeredRef = useRef(false);\n  var _options = !(options instanceof Array) ? options : !(dependencies instanceof Array) ? dependencies : undefined;\n  var _keys = isReadonlyArray(keys) ? keys.join(_options == null ? void 0 : _options.splitKey) : keys;\n  var _deps = options instanceof Array ? options : dependencies instanceof Array ? dependencies : undefined;\n  var memoisedCB = useCallback(callback, _deps != null ? _deps : []);\n  var cbRef = useRef(memoisedCB);\n  if (_deps) {\n    cbRef.current = memoisedCB;\n  } else {\n    cbRef.current = callback;\n  }\n  var memoisedOptions = useDeepEqualMemo(_options);\n  var _useHotkeysContext = useHotkeysContext(),\n    enabledScopes = _useHotkeysContext.enabledScopes;\n  var proxy = useBoundHotkeysProxy();\n  useSafeLayoutEffect(function () {\n    if ((memoisedOptions == null ? void 0 : memoisedOptions.enabled) === false || !isScopeActive(enabledScopes, memoisedOptions == null ? void 0 : memoisedOptions.scopes)) {\n      return;\n    }\n    var listener = function listener(e, isKeyUp) {\n      var _e$target;\n      if (isKeyUp === void 0) {\n        isKeyUp = false;\n      }\n      if (isKeyboardEventTriggeredByInput(e) && !isHotkeyEnabledOnTag(e, memoisedOptions == null ? void 0 : memoisedOptions.enableOnFormTags)) {\n        return;\n      }\n      // TODO: SINCE THE EVENT IS NOW ATTACHED TO THE REF, THE ACTIVE ELEMENT CAN NEVER BE INSIDE THE REF. THE HOTKEY ONLY TRIGGERS IF THE\n      // REF IS THE ACTIVE ELEMENT. THIS IS A PROBLEM SINCE FOCUSED SUB COMPONENTS WON'T TRIGGER THE HOTKEY.\n      if (ref.current !== null) {\n        var rootNode = ref.current.getRootNode();\n        if ((rootNode instanceof Document || rootNode instanceof ShadowRoot) && rootNode.activeElement !== ref.current && !ref.current.contains(rootNode.activeElement)) {\n          stopPropagation(e);\n          return;\n        }\n      }\n      if ((_e$target = e.target) != null && _e$target.isContentEditable && !(memoisedOptions != null && memoisedOptions.enableOnContentEditable)) {\n        return;\n      }\n      parseKeysHookInput(_keys, memoisedOptions == null ? void 0 : memoisedOptions.splitKey).forEach(function (key) {\n        var _hotkey$keys;\n        var hotkey = parseHotkey(key, memoisedOptions == null ? void 0 : memoisedOptions.combinationKey);\n        if (isHotkeyMatchingKeyboardEvent(e, hotkey, memoisedOptions == null ? void 0 : memoisedOptions.ignoreModifiers) || (_hotkey$keys = hotkey.keys) != null && _hotkey$keys.includes('*')) {\n          if (memoisedOptions != null && memoisedOptions.ignoreEventWhen != null && memoisedOptions.ignoreEventWhen(e)) {\n            return;\n          }\n          if (isKeyUp && hasTriggeredRef.current) {\n            return;\n          }\n          maybePreventDefault(e, hotkey, memoisedOptions == null ? void 0 : memoisedOptions.preventDefault);\n          if (!isHotkeyEnabled(e, hotkey, memoisedOptions == null ? void 0 : memoisedOptions.enabled)) {\n            stopPropagation(e);\n            return;\n          }\n          // Execute the user callback for that hotkey\n          cbRef.current(e, hotkey);\n          if (!isKeyUp) {\n            hasTriggeredRef.current = true;\n          }\n        }\n      });\n    };\n    var handleKeyDown = function handleKeyDown(event) {\n      if (event.key === undefined) {\n        // Synthetic event (e.g., Chrome autofill).  Ignore.\n        return;\n      }\n      pushToCurrentlyPressedKeys(mapKey(event.code));\n      if ((memoisedOptions == null ? void 0 : memoisedOptions.keydown) === undefined && (memoisedOptions == null ? void 0 : memoisedOptions.keyup) !== true || memoisedOptions != null && memoisedOptions.keydown) {\n        listener(event);\n      }\n    };\n    var handleKeyUp = function handleKeyUp(event) {\n      if (event.key === undefined) {\n        // Synthetic event (e.g., Chrome autofill).  Ignore.\n        return;\n      }\n      removeFromCurrentlyPressedKeys(mapKey(event.code));\n      hasTriggeredRef.current = false;\n      if (memoisedOptions != null && memoisedOptions.keyup) {\n        listener(event, true);\n      }\n    };\n    var domNode = ref.current || (_options == null ? void 0 : _options.document) || document;\n    // @ts-ignore\n    domNode.addEventListener('keyup', handleKeyUp);\n    // @ts-ignore\n    domNode.addEventListener('keydown', handleKeyDown);\n    if (proxy) {\n      parseKeysHookInput(_keys, memoisedOptions == null ? void 0 : memoisedOptions.splitKey).forEach(function (key) {\n        return proxy.addHotkey(parseHotkey(key, memoisedOptions == null ? void 0 : memoisedOptions.combinationKey, memoisedOptions == null ? void 0 : memoisedOptions.description));\n      });\n    }\n    return function () {\n      // @ts-ignore\n      domNode.removeEventListener('keyup', handleKeyUp);\n      // @ts-ignore\n      domNode.removeEventListener('keydown', handleKeyDown);\n      if (proxy) {\n        parseKeysHookInput(_keys, memoisedOptions == null ? void 0 : memoisedOptions.splitKey).forEach(function (key) {\n          return proxy.removeHotkey(parseHotkey(key, memoisedOptions == null ? void 0 : memoisedOptions.combinationKey, memoisedOptions == null ? void 0 : memoisedOptions.description));\n        });\n      }\n    };\n  }, [_keys, memoisedOptions, enabledScopes]);\n  return ref;\n}\n\nfunction useRecordHotkeys() {\n  var _useState = useState(new Set()),\n    keys = _useState[0],\n    setKeys = _useState[1];\n  var _useState2 = useState(false),\n    isRecording = _useState2[0],\n    setIsRecording = _useState2[1];\n  var handler = useCallback(function (event) {\n    if (event.key === undefined) {\n      // Synthetic event (e.g., Chrome autofill).  Ignore.\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    setKeys(function (prev) {\n      var newKeys = new Set(prev);\n      newKeys.add(mapKey(event.code));\n      return newKeys;\n    });\n  }, []);\n  var stop = useCallback(function () {\n    if (typeof document !== 'undefined') {\n      document.removeEventListener('keydown', handler);\n      setIsRecording(false);\n    }\n  }, [handler]);\n  var start = useCallback(function () {\n    setKeys(new Set());\n    if (typeof document !== 'undefined') {\n      stop();\n      document.addEventListener('keydown', handler);\n      setIsRecording(true);\n    }\n  }, [handler, stop]);\n  var resetKeys = useCallback(function () {\n    setKeys(new Set());\n  }, []);\n  return [keys, {\n    start: start,\n    stop: stop,\n    resetKeys: resetKeys,\n    isRecording: isRecording\n  }];\n}\n\nexport { HotkeysProvider, isHotkeyPressed, useHotkeys, useHotkeysContext, useRecordHotkeys };\n//# sourceMappingURL=react-hotkeys-hook.esm.js.map\n","// packages/react/context/src/createContext.tsx\nimport * as React from \"react\";\nimport { jsx } from \"react/jsx-runtime\";\nfunction createContext2(rootComponentName, defaultContext) {\n  const Context = React.createContext(defaultContext);\n  function Provider(props) {\n    const { children, ...context } = props;\n    const value = React.useMemo(() => context, Object.values(context));\n    return /* @__PURE__ */ jsx(Context.Provider, { value, children });\n  }\n  function useContext2(consumerName) {\n    const context = React.useContext(Context);\n    if (context) return context;\n    if (defaultContext !== void 0) return defaultContext;\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${rootComponentName}\\``);\n  }\n  Provider.displayName = rootComponentName + \"Provider\";\n  return [Provider, useContext2];\n}\nfunction createContextScope(scopeName, createContextScopeDeps = []) {\n  let defaultContexts = [];\n  function createContext3(rootComponentName, defaultContext) {\n    const BaseContext = React.createContext(defaultContext);\n    const index = defaultContexts.length;\n    defaultContexts = [...defaultContexts, defaultContext];\n    function Provider(props) {\n      const { scope, children, ...context } = props;\n      const Context = scope?.[scopeName][index] || BaseContext;\n      const value = React.useMemo(() => context, Object.values(context));\n      return /* @__PURE__ */ jsx(Context.Provider, { value, children });\n    }\n    function useContext2(consumerName, scope) {\n      const Context = scope?.[scopeName][index] || BaseContext;\n      const context = React.useContext(Context);\n      if (context) return context;\n      if (defaultContext !== void 0) return defaultContext;\n      throw new Error(`\\`${consumerName}\\` must be used within \\`${rootComponentName}\\``);\n    }\n    Provider.displayName = rootComponentName + \"Provider\";\n    return [Provider, useContext2];\n  }\n  const createScope = () => {\n    const scopeContexts = defaultContexts.map((defaultContext) => {\n      return React.createContext(defaultContext);\n    });\n    return function useScope(scope) {\n      const contexts = scope?.[scopeName] || scopeContexts;\n      return React.useMemo(\n        () => ({ [`__scope${scopeName}`]: { ...scope, [scopeName]: contexts } }),\n        [scope, contexts]\n      );\n    };\n  };\n  createScope.scopeName = scopeName;\n  return [createContext3, composeContextScopes(createScope, ...createContextScopeDeps)];\n}\nfunction composeContextScopes(...scopes) {\n  const baseScope = scopes[0];\n  if (scopes.length === 1) return baseScope;\n  const createScope = () => {\n    const scopeHooks = scopes.map((createScope2) => ({\n      useScope: createScope2(),\n      scopeName: createScope2.scopeName\n    }));\n    return function useComposedScopes(overrideScopes) {\n      const nextScopes = scopeHooks.reduce((nextScopes2, { useScope, scopeName }) => {\n        const scopeProps = useScope(overrideScopes);\n        const currentScope = scopeProps[`__scope${scopeName}`];\n        return { ...nextScopes2, ...currentScope };\n      }, {});\n      return React.useMemo(() => ({ [`__scope${baseScope.scopeName}`]: nextScopes }), [nextScopes]);\n    };\n  };\n  createScope.scopeName = baseScope.scopeName;\n  return createScope;\n}\nexport {\n  createContext2 as createContext,\n  createContextScope\n};\n//# sourceMappingURL=index.mjs.map\n","// packages/react/compose-refs/src/composeRefs.tsx\nimport * as React from \"react\";\nfunction setRef(ref, value) {\n  if (typeof ref === \"function\") {\n    ref(value);\n  } else if (ref !== null && ref !== void 0) {\n    ref.current = value;\n  }\n}\nfunction composeRefs(...refs) {\n  return (node) => refs.forEach((ref) => setRef(ref, node));\n}\nfunction useComposedRefs(...refs) {\n  return React.useCallback(composeRefs(...refs), refs);\n}\nexport {\n  composeRefs,\n  useComposedRefs\n};\n//# sourceMappingURL=index.mjs.map\n","// packages/react/slot/src/Slot.tsx\nimport * as React from \"react\";\nimport { composeRefs } from \"@radix-ui/react-compose-refs\";\nimport { Fragment, jsx } from \"react/jsx-runtime\";\nvar Slot = React.forwardRef((props, forwardedRef) => {\n  const { children, ...slotProps } = props;\n  const childrenArray = React.Children.toArray(children);\n  const slottable = childrenArray.find(isSlottable);\n  if (slottable) {\n    const newElement = slottable.props.children;\n    const newChildren = childrenArray.map((child) => {\n      if (child === slottable) {\n        if (React.Children.count(newElement) > 1) return React.Children.only(null);\n        return React.isValidElement(newElement) ? newElement.props.children : null;\n      } else {\n        return child;\n      }\n    });\n    return /* @__PURE__ */ jsx(SlotClone, { ...slotProps, ref: forwardedRef, children: React.isValidElement(newElement) ? React.cloneElement(newElement, void 0, newChildren) : null });\n  }\n  return /* @__PURE__ */ jsx(SlotClone, { ...slotProps, ref: forwardedRef, children });\n});\nSlot.displayName = \"Slot\";\nvar SlotClone = React.forwardRef((props, forwardedRef) => {\n  const { children, ...slotProps } = props;\n  if (React.isValidElement(children)) {\n    const childrenRef = getElementRef(children);\n    return React.cloneElement(children, {\n      ...mergeProps(slotProps, children.props),\n      // @ts-ignore\n      ref: forwardedRef ? composeRefs(forwardedRef, childrenRef) : childrenRef\n    });\n  }\n  return React.Children.count(children) > 1 ? React.Children.only(null) : null;\n});\nSlotClone.displayName = \"SlotClone\";\nvar Slottable = ({ children }) => {\n  return /* @__PURE__ */ jsx(Fragment, { children });\n};\nfunction isSlottable(child) {\n  return React.isValidElement(child) && child.type === Slottable;\n}\nfunction mergeProps(slotProps, childProps) {\n  const overrideProps = { ...childProps };\n  for (const propName in childProps) {\n    const slotPropValue = slotProps[propName];\n    const childPropValue = childProps[propName];\n    const isHandler = /^on[A-Z]/.test(propName);\n    if (isHandler) {\n      if (slotPropValue && childPropValue) {\n        overrideProps[propName] = (...args) => {\n          childPropValue(...args);\n          slotPropValue(...args);\n        };\n      } else if (slotPropValue) {\n        overrideProps[propName] = slotPropValue;\n      }\n    } else if (propName === \"style\") {\n      overrideProps[propName] = { ...slotPropValue, ...childPropValue };\n    } else if (propName === \"className\") {\n      overrideProps[propName] = [slotPropValue, childPropValue].filter(Boolean).join(\" \");\n    }\n  }\n  return { ...slotProps, ...overrideProps };\n}\nfunction getElementRef(element) {\n  let getter = Object.getOwnPropertyDescriptor(element.props, \"ref\")?.get;\n  let mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.ref;\n  }\n  getter = Object.getOwnPropertyDescriptor(element, \"ref\")?.get;\n  mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.props.ref;\n  }\n  return element.props.ref || element.ref;\n}\nvar Root = Slot;\nexport {\n  Root,\n  Slot,\n  Slottable\n};\n//# sourceMappingURL=index.mjs.map\n","// packages/react/primitive/src/Primitive.tsx\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { jsx } from \"react/jsx-runtime\";\nvar NODES = [\n  \"a\",\n  \"button\",\n  \"div\",\n  \"form\",\n  \"h2\",\n  \"h3\",\n  \"img\",\n  \"input\",\n  \"label\",\n  \"li\",\n  \"nav\",\n  \"ol\",\n  \"p\",\n  \"span\",\n  \"svg\",\n  \"ul\"\n];\nvar Primitive = NODES.reduce((primitive, node) => {\n  const Node = React.forwardRef((props, forwardedRef) => {\n    const { asChild, ...primitiveProps } = props;\n    const Comp = asChild ? Slot : node;\n    if (typeof window !== \"undefined\") {\n      window[Symbol.for(\"radix-ui\")] = true;\n    }\n    return /* @__PURE__ */ jsx(Comp, { ...primitiveProps, ref: forwardedRef });\n  });\n  Node.displayName = `Primitive.${node}`;\n  return { ...primitive, [node]: Node };\n}, {});\nfunction dispatchDiscreteCustomEvent(target, event) {\n  if (target) ReactDOM.flushSync(() => target.dispatchEvent(event));\n}\nvar Root = Primitive;\nexport {\n  Primitive,\n  Root,\n  dispatchDiscreteCustomEvent\n};\n//# sourceMappingURL=index.mjs.map\n","\"use client\";\n\n// packages/react/progress/src/Progress.tsx\nimport * as React from \"react\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { jsx } from \"react/jsx-runtime\";\nvar PROGRESS_NAME = \"Progress\";\nvar DEFAULT_MAX = 100;\nvar [createProgressContext, createProgressScope] = createContextScope(PROGRESS_NAME);\nvar [ProgressProvider, useProgressContext] = createProgressContext(PROGRESS_NAME);\nvar Progress = React.forwardRef(\n  (props, forwardedRef) => {\n    const {\n      __scopeProgress,\n      value: valueProp = null,\n      max: maxProp,\n      getValueLabel = defaultGetValueLabel,\n      ...progressProps\n    } = props;\n    if ((maxProp || maxProp === 0) && !isValidMaxNumber(maxProp)) {\n      console.error(getInvalidMaxError(`${maxProp}`, \"Progress\"));\n    }\n    const max = isValidMaxNumber(maxProp) ? maxProp : DEFAULT_MAX;\n    if (valueProp !== null && !isValidValueNumber(valueProp, max)) {\n      console.error(getInvalidValueError(`${valueProp}`, \"Progress\"));\n    }\n    const value = isValidValueNumber(valueProp, max) ? valueProp : null;\n    const valueLabel = isNumber(value) ? getValueLabel(value, max) : void 0;\n    return /* @__PURE__ */ jsx(ProgressProvider, { scope: __scopeProgress, value, max, children: /* @__PURE__ */ jsx(\n      Primitive.div,\n      {\n        \"aria-valuemax\": max,\n        \"aria-valuemin\": 0,\n        \"aria-valuenow\": isNumber(value) ? value : void 0,\n        \"aria-valuetext\": valueLabel,\n        role: \"progressbar\",\n        \"data-state\": getProgressState(value, max),\n        \"data-value\": value ?? void 0,\n        \"data-max\": max,\n        ...progressProps,\n        ref: forwardedRef\n      }\n    ) });\n  }\n);\nProgress.displayName = PROGRESS_NAME;\nvar INDICATOR_NAME = \"ProgressIndicator\";\nvar ProgressIndicator = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeProgress, ...indicatorProps } = props;\n    const context = useProgressContext(INDICATOR_NAME, __scopeProgress);\n    return /* @__PURE__ */ jsx(\n      Primitive.div,\n      {\n        \"data-state\": getProgressState(context.value, context.max),\n        \"data-value\": context.value ?? void 0,\n        \"data-max\": context.max,\n        ...indicatorProps,\n        ref: forwardedRef\n      }\n    );\n  }\n);\nProgressIndicator.displayName = INDICATOR_NAME;\nfunction defaultGetValueLabel(value, max) {\n  return `${Math.round(value / max * 100)}%`;\n}\nfunction getProgressState(value, maxValue) {\n  return value == null ? \"indeterminate\" : value === maxValue ? \"complete\" : \"loading\";\n}\nfunction isNumber(value) {\n  return typeof value === \"number\";\n}\nfunction isValidMaxNumber(max) {\n  return isNumber(max) && !isNaN(max) && max > 0;\n}\nfunction isValidValueNumber(value, max) {\n  return isNumber(value) && !isNaN(value) && value <= max && value >= 0;\n}\nfunction getInvalidMaxError(propValue, componentName) {\n  return `Invalid prop \\`max\\` of value \\`${propValue}\\` supplied to \\`${componentName}\\`. Only numbers greater than 0 are valid max values. Defaulting to \\`${DEFAULT_MAX}\\`.`;\n}\nfunction getInvalidValueError(propValue, componentName) {\n  return `Invalid prop \\`value\\` of value \\`${propValue}\\` supplied to \\`${componentName}\\`. The \\`value\\` prop must be:\n  - a positive number\n  - less than the value passed to \\`max\\` (or ${DEFAULT_MAX} if no \\`max\\` prop is set)\n  - \\`null\\` or \\`undefined\\` if the progress is indeterminate.\n\nDefaulting to \\`null\\`.`;\n}\nvar Root = Progress;\nvar Indicator = ProgressIndicator;\nexport {\n  Indicator,\n  Progress,\n  ProgressIndicator,\n  Root,\n  createProgressScope\n};\n//# sourceMappingURL=index.mjs.map\n","'use client';\n\nimport * as React from 'react';\nimport * as ProgressPrimitive from '@radix-ui/react-progress';\n\nimport { cn, setDisplayName } from '@/helpers/utils';\n\nconst Progress = React.forwardRef<\n\tReact.ElementRef<typeof ProgressPrimitive.Root>,\n\tReact.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n\t<ProgressPrimitive.Root\n\t\tref={ref}\n\t\tclassName={cn('relative h-2 w-full overflow-hidden rounded-full bg-lime-400/20', className)}\n\t\t{...props}\n\t>\n\t\t<ProgressPrimitive.Indicator\n\t\t\tclassName=\"h-full w-full flex-1 bg-lime-400 transition-all\"\n\t\t\tstyle={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n\t\t/>\n\t</ProgressPrimitive.Root>\n));\nsetDisplayName(Progress, ProgressPrimitive.Root.displayName);\n\nexport { Progress };\n","import { getLogger } from '@/app/_helpers/logger';\nimport {\n\tInputShaperWorker,\n\tShaperCalibrationResult,\n\tInputShaperWorkerInput,\n} from '@/app/analysis/_worker/input-shaper';\nimport { INPUT_SHAPERS } from '@/app/analysis/_worker/shapers';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { twJoin } from 'tailwind-merge';\nimport { Progress } from '@/components/ui/progress';\nimport { AnimatedContainer } from '@/components/common/animated-container';\nimport { TableHeader, TableRow, TableHead, TableBody, TableCell, Table } from '@/components/ui/table';\nimport { Spinner } from '@/components/common/spinner';\nimport { Minus } from 'lucide-react';\nimport { TypedArrayPSD } from '@/app/analysis/periodogram';\nimport { PSD } from '@/zods/analysis';\nimport { shadableTWColors } from '@/app/_helpers/colors';\n\ninterface InputShapersProps {\n\trecordings: {\n\t\tsequenceId: string;\n\t\tpsd: {\n\t\t\ttotal: PSD | TypedArrayPSD;\n\t\t};\n\t\tscv: number;\n\t}[];\n\tsequenceId: string | null;\n\tcurrentRunId: string;\n\trecommendedShaper?: ShaperCalibrationResult | null;\n\tshapers: ShaperCalibrationResult[];\n\tsetRecommendedShaper: React.Dispatch<React.SetStateAction<ShaperCalibrationResult | null>>;\n\tsetShapers: React.Dispatch<React.SetStateAction<ShaperCalibrationResult[]>>;\n}\n\nlet _jobId = 1;\n\nexport const InputShapers: React.FC<InputShapersProps> = (props) => {\n\tconst { recordings, sequenceId, currentRunId, setRecommendedShaper, setShapers, shapers, recommendedShaper } = props;\n\tconst [isLoadingShapers, setIsLoadingShapers] = useState<boolean | number>(false);\n\tconst [shaperEstimationProgress, setShaperEstimationProgress] = useState<number>(0);\n\tconst shaperWorker = useRef<InputShaperWorker | null>(null);\n\tconst currentJobId = useRef<number | null>(null);\n\tconst [isWorkerReady, setIsWorkerReady] = useState(false);\n\tconst recording = sequenceId != null ? recordings.find((r) => r.sequenceId === props.sequenceId) : null;\n\n\t// Reset shapers as soon as runId changes.\n\tuseEffect(() => {\n\t\tsetShapers([]);\n\t\tsetRecommendedShaper(null);\n\t}, [currentRunId, setRecommendedShaper, setShapers]);\n\n\tuseEffect(() => {\n\t\tshaperWorker.current = new Worker(\n\t\t\tnew URL('@/app/analysis/_worker/input-shaper', import.meta.url),\n\t\t) as InputShaperWorker;\n\t\tshaperWorker.current.onmessage = (event) => {\n\t\t\tconst data = event.data;\n\t\t\tif (data.type === 'findBestShaper' && data.jobId === currentJobId.current) {\n\t\t\t\tperformance.mark('findBestShaperEnd');\n\t\t\t\tconst measure = performance.measure('findBestShaper', 'findBestShaperStart', 'findBestShaperEnd');\n\t\t\t\tgetLogger().info(measure, 'Best shaper found in ' + measure.duration + ' ms');\n\t\t\t\tlet prevShaperTime = 0;\n\t\t\t\tfor (let shaper of INPUT_SHAPERS) {\n\t\t\t\t\tconst shaperMeasure = performance.measure('fitShaper-' + shaper.name, {\n\t\t\t\t\t\tstart: measure.startTime,\n\t\t\t\t\t\tend: 'fitShaper-' + shaper.name,\n\t\t\t\t\t});\n\t\t\t\t\tgetLogger().info(\n\t\t\t\t\t\tshaperMeasure,\n\t\t\t\t\t\t'Fitting ' + shaper.name + ' took ' + (shaperMeasure.duration - prevShaperTime) + ' ms',\n\t\t\t\t\t);\n\t\t\t\t\tprevShaperTime = shaperMeasure.duration;\n\t\t\t\t}\n\t\t\t\tsetShapers(data.shapers.filter(Boolean));\n\t\t\t\tsetRecommendedShaper(data.result);\n\t\t\t\tsetIsLoadingShapers(false);\n\t\t\t}\n\t\t\tif (data.type === 'fitShaper' && data.jobId === currentJobId.current) {\n\t\t\t\tperformance.mark('fitShaper-' + data.result?.name);\n\t\t\t\tif (data.result != null) {\n\t\t\t\t\tconst newShaper = data.result;\n\t\t\t\t\tsetShapers((prev) => [...prev.filter((s) => s.name != newShaper.name), newShaper]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.type === 'findBestShaperProgress' && data.jobId === currentJobId.current) {\n\t\t\t\tsetShaperEstimationProgress(data.progress);\n\t\t\t}\n\t\t\tif (data.type === 'jobCancelled' && data.id === currentJobId.current) {\n\t\t\t\tsetIsLoadingShapers(false);\n\t\t\t\tsetShaperEstimationProgress(0);\n\t\t\t\tsetShapers([]);\n\t\t\t\tcurrentJobId.current = null;\n\t\t\t}\n\t\t};\n\t\tsetIsWorkerReady(true);\n\t\treturn () => {\n\t\t\tsetIsWorkerReady(false);\n\t\t\tshaperWorker.current?.terminate();\n\t\t};\n\t}, [setRecommendedShaper, setShapers]);\n\n\tuseEffect(() => {\n\t\tif (recording != null && isWorkerReady) {\n\t\t\tconst id = _jobId++;\n\t\t\tcurrentJobId.current = id;\n\t\t\tsetIsLoadingShapers(id);\n\t\t\tsetShaperEstimationProgress(0);\n\t\t\tperformance.mark('findBestShaperStart');\n\t\t\tshaperWorker.current?.postMessage({\n\t\t\t\tid: id,\n\t\t\t\ttype: 'findBestShaper',\n\t\t\t\tcalibrationData: recording.psd.total,\n\t\t\t\tscv: recording.scv,\n\t\t\t} satisfies InputShaperWorkerInput);\n\t\t\treturn () => {\n\t\t\t\tshaperWorker.current?.postMessage({ type: 'cancelJob', id: id });\n\t\t\t\tsetIsLoadingShapers(false);\n\t\t\t};\n\t\t} else {\n\t\t\tsetShapers([]);\n\t\t\tsetRecommendedShaper(null);\n\t\t}\n\t}, [recording, isWorkerReady, setShapers, setRecommendedShaper]);\n\n\treturn (\n\t\t<div>\n\t\t\t<AnimatedContainer containerClassName=\"overflow-hidden\">\n\t\t\t\t{(isLoadingShapers || shapers.length > 0) && (\n\t\t\t\t\t<Table className=\"rounded-none\" containerClassName=\"rounded-none\">\n\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t<TableRow className=\"text-xs\">\n\t\t\t\t\t\t\t\t<TableHead className=\"\">Shaper</TableHead>\n\t\t\t\t\t\t\t\t<TableHead className=\"\">Freq.</TableHead>\n\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">Vibr.</div>\n\t\t\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">Smooth.</div>\n\t\t\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">Rec. Accel.</div>\n\t\t\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t{shapers.map((shaper) => (\n\t\t\t\t\t\t\t\t<TableRow\n\t\t\t\t\t\t\t\t\tkey={shaper.name}\n\t\t\t\t\t\t\t\t\tstyle={{ color: shadableTWColors[shaper.color][400] }}\n\t\t\t\t\t\t\t\t\tclassName={twJoin('text-xs', recommendedShaper?.name === shaper.name && 'font-bold')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap text-nowrap\">\n\t\t\t\t\t\t\t\t\t\t<Minus\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"inline-block size-5\"\n\t\t\t\t\t\t\t\t\t\t\tstrokeWidth={shaper.name === recommendedShaper?.name ? '4' : '2'}\n\t\t\t\t\t\t\t\t\t\t\tstrokeDasharray={shaper.name === recommendedShaper?.name ? '7, 6.5' : '3, 5'}\n\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"square\"\n\t\t\t\t\t\t\t\t\t\t/>{' '}\n\t\t\t\t\t\t\t\t\t\t{shaper.name.toLocaleUpperCase()}\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell>{(Math.round(shaper.freq * 100) / 100).toFixed(2)}hz</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">{(shaper.vibrs * 100).toFixed(2)}%</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">{shaper.smoothing.toFixed(2)}</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap text-nowrap text-right\">\n\t\t\t\t\t\t\t\t\t\t{Math.round(shaper.maxAccel)} mm/s\n\t\t\t\t\t\t\t\t\t\t<sup>2</sup>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t)}\n\t\t\t</AnimatedContainer>\n\t\t\t{isLoadingShapers ? (\n\t\t\t\t<div className=\"mt-0 block space-y-3 p-3 text-xs text-muted-foreground\">\n\t\t\t\t\t<Spinner className=\"mr-1 inline-block size-4\" noMargin={true} strokeWidth={4} /> Calculating input shapers (\n\t\t\t\t\t{(shaperEstimationProgress * 100).toFixed(2)}%)...\n\t\t\t\t\t<Progress value={shaperEstimationProgress * 100}></Progress>\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\trecommendedShaper != null && (\n\t\t\t\t\t<div className=\"mt-0 block space-y-3 p-3 text-xs text-muted-foreground\">\n\t\t\t\t\t\t{recommendedShaper.name.toLocaleUpperCase()} is recommended at {recommendedShaper.freq.toFixed(2)}\n\t\t\t\t\t\tHz. Resulting in a resonance reduction of {(100 - recommendedShaper.vibrs).toFixed(2)}%. Recommended maximum\n\t\t\t\t\t\tacceleration before noticeable smoothing is {Math.round(recommendedShaper.maxAccel)} mm/s\n\t\t\t\t\t\t<sup>2</sup>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t)}\n\t\t</div>\n\t);\n};\n","import { PSD } from '@/zods/analysis';\nimport { SciChartSurface, XyMovingAverageFilter, XyDataSeries, FastLineRenderableSeries } from 'scichart';\nimport { calculatePercentile, maxArrayIndex, pearsonCorrelation } from '@/app/analysis/math';\nimport { PSD_CHART_AXIS_AMPLITUDE_ID } from '@/app/analysis/charts';\n\n/**\n * Methods to compare responses from two signals.\n * Most of this is borrowed from https://github.com/Frix-x/klippain-shaketune by @Frix-x\n * and as such is licensed under GNU General Public License v3.0 (GPL-3.0).\n */\n\nconst DC_MAX_PEAKS = 2;\nconst DC_MAX_UNPAIRED_PEAKS_ALLOWED = 0;\n\ntype Peak = { freq: number; amplitude: number };\n\nexport const detectPeaks = (\n\tsurface: SciChartSurface,\n\tpsd: PSD,\n\tdetectionThreshold: number,\n\tseriesColor?: string,\n): Peak[] => {\n\t// Moving average\n\tconst movingAverage = new XyMovingAverageFilter(\n\t\tnew XyDataSeries(surface.webAssemblyContext2D, {\n\t\t\tcontainsNaN: false,\n\t\t\tisSorted: true,\n\t\t\txValues: psd.frequencies,\n\t\t\tyValues: psd.estimates,\n\t\t}),\n\t\t{ length: 3, isSorted: true, containsNaN: false },\n\t);\n\tconst avgValues = movingAverage.getNativeYValues();\n\tconst peaks: Peak[] = [];\n\n\tif (seriesColor) {\n\t\tsurface.renderableSeries.add(\n\t\t\tnew FastLineRenderableSeries(surface.webAssemblyContext2D, {\n\t\t\t\tdataSeries: movingAverage,\n\t\t\t\tyAxisId: PSD_CHART_AXIS_AMPLITUDE_ID,\n\t\t\t\tstroke: seriesColor,\n\t\t\t\tstrokeThickness: 5,\n\t\t\t\tstrokeDashArray: [5, 5],\n\t\t\t}),\n\t\t);\n\t}\n\n\tconst vicinity = 10;\n\tconst freqPerStep = psd.frequencies[1] - psd.frequencies[0];\n\tlet vicinitySteps = Math.ceil(vicinity / freqPerStep);\n\tif (!isFinite(vicinitySteps)) {\n\t\tvicinitySteps = vicinity;\n\t}\n\tconst peakIndex: number[] = [];\n\tfor (let i = 1; i < avgValues.size(); i++) {\n\t\tconst prev = avgValues.get(i - 1);\n\t\tconst current = avgValues.get(i);\n\t\tconst next = avgValues.get(i + 1);\n\t\tif (prev < current && current > next && current > detectionThreshold) {\n\t\t\t// peak identified.\n\t\t\t// Find the highest peak where psd.frequencies[index] is within `vicinity` hz.\n\t\t\tlet highestPeakIndex = i;\n\t\t\tnew Array(vicinitySteps).fill(0).forEach((_, j) => {\n\t\t\t\tconst index = i - j;\n\t\t\t\tif (\n\t\t\t\t\tindex > 0 &&\n\t\t\t\t\tindex < psd.estimates.length &&\n\t\t\t\t\tpsd.estimates[index] > psd.estimates[highestPeakIndex] &&\n\t\t\t\t\tpsd.estimates[index - 1] < psd.estimates[index] &&\n\t\t\t\t\tpsd.estimates[index + 1] < psd.estimates[index]\n\t\t\t\t) {\n\t\t\t\t\thighestPeakIndex = index;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (peakIndex.indexOf(highestPeakIndex) === -1) {\n\t\t\t\tpeakIndex.push(highestPeakIndex);\n\t\t\t\tpeaks.push({ freq: psd.frequencies[highestPeakIndex], amplitude: psd.estimates[highestPeakIndex] });\n\t\t\t}\n\t\t}\n\t}\n\treturn peaks;\n};\n\nexport type PeakPairingResult = {\n\tpairedPeaks: [Peak, Peak][];\n\tunpairedPeaks1: Peak[];\n\tunpairedPeaks2: Peak[];\n};\n\nexport const pairPeaks = (\n\tpeaks1: { freq: number; amplitude: number }[],\n\tpeaks2: { freq: number; amplitude: number }[],\n): PeakPairingResult => {\n\tconst pairedPeaks: [Peak, Peak][] = [];\n\tconst unpairedPeaks1: Peak[] = peaks1.slice();\n\tconst unpairedPeaks2: Peak[] = peaks2.slice();\n\n\tlet distances: number[] = [];\n\tfor (let p1 of peaks1) {\n\t\tfor (let p2 of peaks2) {\n\t\t\tdistances.push(Math.abs(p1.freq - p2.freq));\n\t\t}\n\t}\n\n\tdistances.sort((a, b) => a - b);\n\n\tconst medianDistance = calculatePercentile(distances, 50);\n\tconst iqr = calculatePercentile(distances, 75) - calculatePercentile(distances, 25);\n\n\tlet threshold = medianDistance + 1.5 * iqr;\n\tthreshold = Math.min(threshold, 10);\n\n\t// Pair peaks\n\tlet i = 0;\n\twhile (unpairedPeaks1.length > 0 && unpairedPeaks2.length > 0 && i < unpairedPeaks1.length * unpairedPeaks2.length) {\n\t\ti++;\n\t\tlet minDistance = threshold + 1;\n\t\tlet pair: [Peak, Peak] | null = null;\n\t\tfor (const p1 of unpairedPeaks1) {\n\t\t\tfor (const p2 of unpairedPeaks2) {\n\t\t\t\tconst distance = Math.abs(p1.freq - p2.freq);\n\t\t\t\tif (distance < minDistance) {\n\t\t\t\t\tminDistance = distance;\n\t\t\t\t\tpair = [p1, p2];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (pair) {\n\t\t\tpairedPeaks.push(pair);\n\t\t\tunpairedPeaks1.splice(unpairedPeaks1.indexOf(pair[0]), 1);\n\t\t\tunpairedPeaks2.splice(unpairedPeaks2.indexOf(pair[1]), 1);\n\t\t}\n\t}\n\n\treturn { pairedPeaks, unpairedPeaks1, unpairedPeaks2 };\n};\n\nfunction mechanicalHealthLookupTable(mechanicalHealthIndicator: number): string {\n\tconst ranges: [number, number, string][] = [\n\t\t[90, 100, 'Excellent mechanical health'],\n\t\t[70, 90, 'Good mechanical health'],\n\t\t[55, 70, 'Acceptable mechanical health'],\n\t\t[45, 55, 'Potential signs of overtensioning'],\n\t\t[30, 45, 'Potential signs of mechanical issues or overtensioning'],\n\t\t[15, 30, 'Very likely mechanical issues'],\n\t\t[0, 15, 'Mechanical issues detected'],\n\t];\n\tconst mhi = Math.max(0, Math.min(mechanicalHealthIndicator, 100));\n\tfor (const [min, max, label] of ranges) {\n\t\tif (mhi >= min && mhi <= max) {\n\t\t\treturn label;\n\t\t}\n\t}\n\treturn 'Unknown mechanical health';\n}\n\nexport type MechanicalHealthResult = { mhi: number; label: string };\n\nconst padSignal = (signal: number[], targetLength: number): number[] => {\n\tif (signal.length >= targetLength) return signal;\n\treturn [...signal, ...Array(targetLength - signal.length).fill(0)];\n};\n\nexport function computeMechanicalHealth(\n\tsignal1: { unpairedPeaks: Peak[]; pairedPeaks: [Peak, Peak][]; psd: PSD },\n\tsignal2: { unpairedPeaks: Peak[]; pairedPeaks: [Peak, Peak][]; psd: PSD },\n): MechanicalHealthResult {\n\t// Pad the PSDs to the same length\n\tconst maxLength = Math.max(signal1.psd.estimates.length, signal2.psd.estimates.length);\n\n\tconst signal1Estimates = padSignal(signal1.psd.estimates, maxLength);\n\tconst signal2Estimates = padSignal(signal2.psd.estimates, maxLength);\n\tconst similarityFactor = pearsonCorrelation(signal1Estimates, signal2Estimates) * 100;\n\tconst numUnpairedPeaks = signal1.unpairedPeaks.length + signal2.unpairedPeaks.length;\n\tconst numPairedPeaks = signal1.pairedPeaks.length;\n\n\t// Combine unpaired peaks from both signals, tagging each peak with its respective signal\n\tconst combinedUnpairedPeaks = signal1.unpairedPeaks.concat(signal2.unpairedPeaks);\n\n\tconst psdHighestMax = Math.max(signal1.psd.powerRange.max, signal2.psd.powerRange.max);\n\n\t// Start with the similarity factor directly scaled to a percentage\n\tlet mhi = similarityFactor;\n\n\t// Bonus for ideal number of total peaks (2)\n\tif (numPairedPeaks >= DC_MAX_PEAKS) {\n\t\tmhi *= DC_MAX_PEAKS / numPairedPeaks; // Reduce MHI if more than ideal number of peaks\n\t}\n\tif (numPairedPeaks < DC_MAX_PEAKS) {\n\t\tmhi *= numPairedPeaks / DC_MAX_PEAKS; // Reduce MHI if less than ideal number of peaks\n\t}\n\n\t// Penalty from unpaired peaks weighted by their amplitude relative to the maximum PSD amplitude\n\tlet unpairedPeakPenalty = 0;\n\tif (numUnpairedPeaks > DC_MAX_UNPAIRED_PEAKS_ALLOWED) {\n\t\tfor (const peak of combinedUnpairedPeaks) {\n\t\t\tunpairedPeakPenalty += (peak.amplitude / psdHighestMax) * 30;\n\t\t}\n\t\tmhi -= unpairedPeakPenalty;\n\t}\n\n\t// Ensure the result lies between 0 and 100 by clipping the computed value\n\tmhi = Math.max(0, Math.min(mhi, 100));\n\n\treturn { mhi, label: mechanicalHealthLookupTable(mhi) };\n}\n","import {\n\tdetectPeaks,\n\tpairPeaks,\n\tcomputeMechanicalHealth,\n\tMechanicalHealthResult,\n\tPeakPairingResult,\n} from '@/app/analysis/_worker/graph-comparison';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { SciChartSurface } from 'scichart';\nimport { SequenceData } from '@/app/analysis/macros/[id]/recordings/[runId]/setup';\nimport { initBeltTensionChartAnnotations, updateBeltTensionChartAnnotations } from '@/app/analysis/macros/hooks';\nimport { AnimatedContainer } from '@/components/common/animated-container';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { twJoin } from 'tailwind-merge';\nimport { CardDescription, CardTitle } from '@/components/ui/card';\nimport { useChart } from '@/app/analysis/hooks';\nimport deepEqual from 'deep-equal';\n\ninterface BeltTensionComparisonProps {\n\tsequencePair: [SequenceData, SequenceData] | null;\n\tchart: ReturnType<typeof useChart>;\n\tpeakPairingResults: PeakPairingResult | null;\n\tmechanicalHealth: MechanicalHealthResult | null;\n\tsetPeakPairingResults: React.Dispatch<React.SetStateAction<PeakPairingResult | null>>;\n\tsetMechanicalHealth: React.Dispatch<React.SetStateAction<MechanicalHealthResult | null>>;\n}\n\nexport const BeltTensionComparison: React.FC<BeltTensionComparisonProps> = (props) => {\n\tconst { sequencePair, chart, setPeakPairingResults, setMechanicalHealth, peakPairingResults, mechanicalHealth } =\n\t\tprops;\n\tconst initializedSurfaceId = useRef<string | null>(null);\n\tconst [surfaceId, setSurfaceId] = useState<string | null>(null);\n\tconst prevPairingResult = useRef<PeakPairingResult | null>(null);\n\n\tconst updateSurfaceId = useCallback((surface: SciChartSurface) => {\n\t\tsetSurfaceId(surface.id);\n\t}, []);\n\n\tuseEffect(() => {\n\t\tchart.onInitialize(updateSurfaceId);\n\t}, [chart, chart.onInitialize, updateSurfaceId]);\n\n\tuseEffect(() => {\n\t\tif (!chart.isInitialized) {\n\t\t\treturn;\n\t\t}\n\t\tif (sequencePair != null && sequencePair.length === 2 && chart.surface.current != null) {\n\t\t\tconst detectionThreshold =\n\t\t\t\tMath.max(sequencePair[0].psd.total.powerRange.max, sequencePair[1].psd.total.powerRange.max) * 0.12;\n\t\t\tconst peaks1 = detectPeaks(chart.surface.current, sequencePair[0].psd.total, detectionThreshold);\n\t\t\tconst peaks2 = detectPeaks(chart.surface.current, sequencePair[1].psd.total, detectionThreshold);\n\t\t\tconst newPeakPairingResults = pairPeaks(peaks1, peaks2);\n\t\t\tconst newMechanicalHealth = computeMechanicalHealth(\n\t\t\t\t{\n\t\t\t\t\tpairedPeaks: newPeakPairingResults.pairedPeaks,\n\t\t\t\t\tunpairedPeaks: newPeakPairingResults.unpairedPeaks1,\n\t\t\t\t\tpsd: sequencePair[0].psd.total,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpairedPeaks: newPeakPairingResults.pairedPeaks,\n\t\t\t\t\tunpairedPeaks: newPeakPairingResults.unpairedPeaks2,\n\t\t\t\t\tpsd: sequencePair[1].psd.total,\n\t\t\t\t},\n\t\t\t);\n\t\t\tsetPeakPairingResults(newPeakPairingResults);\n\t\t\tsetMechanicalHealth(newMechanicalHealth);\n\t\t\tif (surfaceId !== initializedSurfaceId.current) {\n\t\t\t\tinitBeltTensionChartAnnotations(chart.surface.current, sequencePair, newPeakPairingResults);\n\t\t\t\tinitializedSurfaceId.current = surfaceId;\n\t\t\t\tprevPairingResult.current = newPeakPairingResults;\n\t\t\t} else if (!deepEqual(prevPairingResult.current, newPeakPairingResults)) {\n\t\t\t\tupdateBeltTensionChartAnnotations(chart.surface.current, sequencePair, newPeakPairingResults).then(() =>\n\t\t\t\t\tinitBeltTensionChartAnnotations(chart.surface.current, sequencePair, newPeakPairingResults, 0),\n\t\t\t\t);\n\t\t\t\tprevPairingResult.current = newPeakPairingResults;\n\t\t\t}\n\t\t} else if (sequencePair == null && initializedSurfaceId.current != null) {\n\t\t\tsetPeakPairingResults(null);\n\t\t\tsetMechanicalHealth(null);\n\t\t\tupdateBeltTensionChartAnnotations(chart.surface.current, null, null);\n\t\t\tinitializedSurfaceId.current = null;\n\t\t}\n\t}, [sequencePair, setMechanicalHealth, chart.surface, setPeakPairingResults, chart.isInitialized, surfaceId]);\n\n\treturn (\n\t\t<AnimatedContainer containerClassName=\"overflow-hidden\">\n\t\t\t{peakPairingResults && sequencePair && (\n\t\t\t\t<div>\n\t\t\t\t\t<Table className=\"rounded-none\" containerClassName=\"rounded-none\">\n\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t<TableRow className=\"text-xs\">\n\t\t\t\t\t\t\t\t<TableHead className=\"\">Pair</TableHead>\n\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">Freq. Delta</div>\n\t\t\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">Ampl. Delta</div>\n\t\t\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t{peakPairingResults.pairedPeaks.map((pair, i) => (\n\t\t\t\t\t\t\t\t<TableRow key={pair[0].freq + pair[1].freq} className={twJoin('text-xs')}>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"whitespace-nowrap text-nowrap\">Peaks {String.fromCharCode(65 + i)}</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t{(Math.round(Math.abs(pair[0].freq - pair[1].freq) * 10) / 10).toFixed(1)}hz\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t{(\n\t\t\t\t\t\t\t\t\t\t\t(Math.abs(pair[0].amplitude - pair[1].amplitude) /\n\t\t\t\t\t\t\t\t\t\t\t\tMath.max(pair[0].amplitude, pair[1].amplitude)) *\n\t\t\t\t\t\t\t\t\t\t\t100\n\t\t\t\t\t\t\t\t\t\t).toFixed(1)}\n\t\t\t\t\t\t\t\t\t\t%\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t\t<div className=\"mt-0 grid grid-cols-2 gap-3 p-3\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<CardTitle className=\"text-sm\">Estimated Similarity</CardTitle>\n\t\t\t\t\t\t\t<CardDescription className=\"text-xs\">{mechanicalHealth?.mhi.toFixed(1)}%</CardDescription>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<CardTitle className=\"text-sm\">Status</CardTitle>\n\t\t\t\t\t\t\t<CardDescription className=\"text-xs\">{mechanicalHealth?.label}</CardDescription>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"col-span-full\">\n\t\t\t\t\t\t\t<CardTitle className=\"text-sm\">Unpaired Peaks</CardTitle>\n\t\t\t\t\t\t\t<CardDescription className=\"text-xs\">\n\t\t\t\t\t\t\t\t{peakPairingResults.unpairedPeaks1.length} on {sequencePair[0].name}\n\t\t\t\t\t\t\t</CardDescription>\n\t\t\t\t\t\t\t<CardDescription className=\"text-xs\">\n\t\t\t\t\t\t\t\t{peakPairingResults.unpairedPeaks2.length} on {sequencePair[1].name}\n\t\t\t\t\t\t\t</CardDescription>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</AnimatedContainer>\n\t);\n};\n","'use client';\nimport { MacroRunChart } from '@/app/analysis/macros/[id]/recordings/[runId]/macro-run-chart';\nimport { useTopMenu } from '@/app/topmenu';\nimport { trpc } from '@/utils/trpc';\nimport { ChevronLeft, SkipBack, SkipForward } from 'lucide-react';\nimport { useCallback, useState, useMemo, useEffect, useRef } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport * as luxon from 'luxon';\nimport { CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Card } from '@/components/common/card';\nimport { TWShadeableColorName } from '@/app/_helpers/colors';\n\nimport { useChart } from '@/app/analysis/hooks';\nimport { PSDChartNoSeriesDefinition } from '@/app/analysis/charts';\nimport { SequenceData, SequenceDataChartType, setupChart } from '@/app/analysis/macros/[id]/recordings/[runId]/setup';\nimport { SciChartSurface } from 'scichart';\nimport { InputShapers } from '@/app/analysis/macros/[id]/recordings/[runId]/input-shapers';\nimport { useInputShapersState, useSeriesSubcomponentsChart, useBeltTensionState } from '@/app/analysis/macros/hooks';\nimport { BeltTensionComparison } from '@/app/analysis/macros/[id]/recordings/[runId]/belt-tension-comparison';\nimport deepEqual from 'deep-equal';\n\nluxon.Settings.defaultLocale = 'en-GB';\nconst userLocale = luxon.DateTime.local().locale;\n\nexport const MacroRun = ({ id, runId }: { id: string; runId: string }) => {\n\tconst [currentRun, setCurrentRun] = useState(runId);\n\tconst [macro] = trpc.analysis.findMacro.useSuspenseQuery({ id });\n\tconst [recordings] = trpc.analysis.getRunRecordings.useSuspenseQuery(\n\t\t{ runId: currentRun, macroId: id },\n\t\t{ keepPreviousData: true },\n\t);\n\n\tconst inputShapersState = useInputShapersState();\n\tconst seriesSubcomponents = useSeriesSubcomponentsChart();\n\tconst beltTensionState = useBeltTensionState();\n\n\tconst [{ next, previous }] = trpc.analysis.getNextAndPreviousRunRecordingIds.useSuspenseQuery(\n\t\t{\n\t\t\tmacroId: id,\n\t\t\trunId: currentRun,\n\t\t},\n\t\t{ keepPreviousData: true },\n\t);\n\n\tuseHotkeys(\n\t\t'left',\n\t\t() => {\n\t\t\tif (previous != null) {\n\t\t\t\tsetCurrentRun(previous);\n\t\t\t}\n\t\t},\n\t\t[previous],\n\t);\n\tuseHotkeys(\n\t\t'right',\n\t\t() => {\n\t\t\tif (next != null) {\n\t\t\t\tsetCurrentRun(next);\n\t\t\t}\n\t\t},\n\t\t[next],\n\t);\n\n\tconst date = useMemo(() => {\n\t\tconst start = luxon.DateTime.fromMillis(recordings.result[0].startTimeStamp);\n\t\tconst end = luxon.DateTime.fromMillis(recordings.result[recordings.result.length - 1].endTimeStamp);\n\t\tconst date = start.equals(end)\n\t\t\t? start.toFormat('yyyy-MM-dd HH:mm')\n\t\t\t: `${start.toFormat('yyyy-MM-dd HH:mm')} - ${end.toFormat('HH:mm')}`;\n\t\tconst human = luxon.DateTime.fromMillis(recordings.result[0].startTimeStamp)\n\t\t\t.setLocale(userLocale)\n\t\t\t.toLocaleString({ dateStyle: 'long', timeStyle: 'short' });\n\t\tconst duration = luxon.Duration.fromMillis(\n\t\t\trecordings.result[recordings.result.length - 1].endTimeStamp - recordings.result[0].startTimeStamp,\n\t\t)\n\t\t\t.shiftTo('minutes', 'seconds')\n\t\t\t.toHuman({ unitDisplay: 'short', maximumSignificantDigits: 2 });\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div title={date} className=\"min-w-0 truncate\">\n\t\t\t\t\t{human}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"min-w-0 truncate opacity-80\">{duration}</div>\n\t\t\t</>\n\t\t);\n\t}, [recordings]);\n\n\tconst sequenceSeries: SequenceData[] = useMemo(\n\t\t() =>\n\t\t\trecordings.result\n\t\t\t\t.flatMap((rec) => {\n\t\t\t\t\tconst sequence = macro.sequences.find((seq) => seq.id === rec.sequenceId);\n\t\t\t\t\treturn sequence?.recording\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tsequenceId: sequence.id,\n\t\t\t\t\t\t\t\tcolor: (sequence?.recording?.color ?? 'lime') as TWShadeableColorName,\n\t\t\t\t\t\t\t\tname: rec.name,\n\t\t\t\t\t\t\t\tpsd: rec.psd,\n\t\t\t\t\t\t\t\ttype: SequenceDataChartType.Mountain,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t: null;\n\t\t\t\t})\n\t\t\t\t.filter(Boolean),\n\t\t[recordings, macro],\n\t);\n\n\tconst chartInit = useCallback(\n\t\t(surface: SciChartSurface) => {\n\t\t\tsetupChart(surface, sequenceSeries);\n\t\t},\n\t\t[sequenceSeries],\n\t);\n\n\tconst chart = useChart(PSDChartNoSeriesDefinition, chartInit);\n\n\tconst { setSubcomponentSeries } = seriesSubcomponents;\n\tconst { setSequenceId } = inputShapersState;\n\n\tconst { setSequencePair } = beltTensionState;\n\tconst sequencePair = useRef(beltTensionState.sequencePair);\n\tsequencePair.current = beltTensionState.sequencePair;\n\n\tuseEffect(() => {\n\t\tif (recordings.result.length === 1) {\n\t\t\tconst sequenceId = recordings.result[0].sequenceId;\n\t\t\tsetSequenceId(sequenceId);\n\t\t\tsetSubcomponentSeries((series) => series.filter((s) => s !== sequenceId).concat([sequenceId]));\n\t\t} else {\n\t\t\tsetSubcomponentSeries([]);\n\t\t\tsetSequenceId(null);\n\t\t}\n\t}, [recordings.result, setSequenceId, setSubcomponentSeries]);\n\n\tuseEffect(() => {\n\t\tconst newPair: [SequenceData, SequenceData] = [sequenceSeries[0], sequenceSeries[1]];\n\t\tif (recordings.result.length === 2 && sequenceSeries.length === 2 && !deepEqual(sequencePair.current, newPair)) {\n\t\t\tsetSequencePair(newPair);\n\t\t} else if (!deepEqual(sequencePair.current, newPair)) {\n\t\t\tsetSequencePair(null);\n\t\t}\n\t}, [recordings.result.length, sequenceSeries, setSequencePair]);\n\n\tuseTopMenu(\n\t\t'Analysis',\n\t\tuseCallback(\n\t\t\t(Menu) => {\n\t\t\t\treturn (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Menu.MenubarMenu>\n\t\t\t\t\t\t\t<Menu.MenubarTrigger className=\"cursor-pointer\" asChild>\n\t\t\t\t\t\t\t\t<span onClick={() => window.history.back()}>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarIcon Icon={ChevronLeft} />\n\t\t\t\t\t\t\t\t\t<span className=\"hidden lg:inline\">Back</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</Menu.MenubarTrigger>\n\t\t\t\t\t\t\t<Menu.MenubarContent className=\"hidden\" />\n\t\t\t\t\t\t</Menu.MenubarMenu>\n\t\t\t\t\t\t<Menu.MenubarMenu>\n\t\t\t\t\t\t\t<Menu.MenubarTrigger asChild disabled={previous == null}>\n\t\t\t\t\t\t\t\t<span onClick={() => previous != null && setCurrentRun(previous)}>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarIcon Icon={SkipBack} />\n\t\t\t\t\t\t\t\t\t<span className=\"hidden lg:inline\">Previous recording</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</Menu.MenubarTrigger>\n\t\t\t\t\t\t\t<Menu.MenubarContent className=\"hidden\" />\n\t\t\t\t\t\t</Menu.MenubarMenu>\n\t\t\t\t\t\t<Menu.MenubarMenu>\n\t\t\t\t\t\t\t<Menu.MenubarTrigger asChild disabled={next == null}>\n\t\t\t\t\t\t\t\t<span onClick={() => next != null && setCurrentRun(next)}>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarIcon Icon={SkipForward} />\n\t\t\t\t\t\t\t\t\t<span className=\"hidden lg:inline\">Next recording</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</Menu.MenubarTrigger>\n\t\t\t\t\t\t\t<Menu.MenubarContent className=\"hidden\" />\n\t\t\t\t\t\t</Menu.MenubarMenu>\n\t\t\t\t\t</>\n\t\t\t\t);\n\t\t\t},\n\t\t\t[next, previous, setCurrentRun],\n\t\t),\n\t);\n\treturn (\n\t\t<div className=\"relative flex flex-1\">\n\t\t\t<MacroRunChart\n\t\t\t\tsequenceSeries={sequenceSeries}\n\t\t\t\tchart={chart}\n\t\t\t\tshapers={inputShapersState.shapers}\n\t\t\t\trecommendedShaper={inputShapersState.recommendedShaper}\n\t\t\t\tsubcomponentSeries={seriesSubcomponents.subcomponentSeries}\n\t\t\t/>\n\t\t\t<Card className=\"absolute right-4 top-4 w-[420px]\">\n\t\t\t\t<CardHeader className=\"flex flex-row items-center gap-2 space-y-0 p-3 @sm:p-3\">\n\t\t\t\t\t<CardTitle className=\"flex-1\">{macro.name}</CardTitle>\n\t\t\t\t\t<CardDescription className=\"m-0 text-right text-xs\">{date}</CardDescription>\n\t\t\t\t</CardHeader>\n\t\t\t\t<BeltTensionComparison chart={chart} {...beltTensionState} />\n\t\t\t\t{recordings.result.length === 1 && (\n\t\t\t\t\t<InputShapers currentRunId={currentRun} {...inputShapersState} recordings={recordings.result} />\n\t\t\t\t)}\n\t\t\t</Card>\n\t\t</div>\n\t);\n};\n","export const sumArray = (arr: number[]) => arr.reduce((a, b) => a + b, 0);\nexport const meanArray = (arr: number[]) => sumArray(arr) / arr.length;\nexport const maxArrayIndex = (arr: number[]) => arr.reduce((iMax, x, i, arr) => (x > arr[iMax] ? i : iMax), 0);\n\nexport function pearsonCorrelation(x: number[], y: number[]): number {\n\tif (x.length !== y.length) {\n\t\tthrow new Error('Input arrays must have the same length.');\n\t}\n\n\tconst n = x.length;\n\tconst meanX = meanArray(x);\n\tconst meanY = meanArray(y);\n\n\tlet numerator = 0;\n\tlet denominatorX = 0;\n\tlet denominatorY = 0;\n\n\tfor (let i = 0; i < n; i++) {\n\t\tconst dx = x[i] - meanX;\n\t\tconst dy = y[i] - meanY;\n\t\tnumerator += dx * dy;\n\t\tdenominatorX += dx * dx;\n\t\tdenominatorY += dy * dy;\n\t}\n\n\tconst denominator = Math.sqrt(denominatorX) * Math.sqrt(denominatorY);\n\tif (denominator === 0) {\n\t\treturn 0; // Avoid division by zero\n\t}\n\n\treturn numerator / denominator;\n}\n\nexport function calculatePercentile(arr: number[], percentile: number): number {\n\tarr.sort((a, b) => a - b);\n\tconst index = (percentile / 100) * (arr.length - 1);\n\tconst lower = Math.floor(index);\n\tconst upper = Math.ceil(index);\n\tif (lower === upper) {\n\t\treturn arr[lower];\n\t}\n\treturn arr[lower] + (arr[upper] - arr[lower]) * (index - lower);\n}\n","import { useDebounce } from '@/app/_hooks/debounce';\nimport useResizeObserver from '@react-hook/resize-observer';\nimport { motion, SpringOptions } from 'framer-motion';\nimport { useState, useRef, PropsWithChildren, useCallback, useLayoutEffect, useEffect } from 'react';\nimport { twJoin, twMerge } from 'tailwind-merge';\n\nexport const AnimatedContainer = (\n\tprops: PropsWithChildren<{ containerClassName?: string; className?: string; transition?: SpringOptions }>,\n) => {\n\tconst [height, setHeight] = useState(0);\n\tconst heightRef = useRef(height);\n\theightRef.current = height;\n\tconst [isOverflowVisible, setIsOverflowVisible] = useState(false);\n\tconst isOverflowVisibleRef = useRef(isOverflowVisible);\n\tisOverflowVisibleRef.current = isOverflowVisible;\n\tconst containerRef = useRef<HTMLDivElement>(null);\n\n\tuseResizeObserver(containerRef, (entry) => {\n\t\tif (entry.contentRect.height === heightRef.current) {\n\t\t\treturn;\n\t\t}\n\t\tsetHeight(entry.contentRect.height);\n\t});\n\n\tconst onComplete = useDebounce(\n\t\tuseCallback(() => {\n\t\t\tsetIsOverflowVisible(true);\n\t\t}, []),\n\t\t200,\n\t\ttrue,\n\t);\n\tconst onStart = useDebounce(\n\t\tuseCallback(() => {\n\t\t\tsetIsOverflowVisible(false);\n\t\t}, []),\n\t\t200,\n\t\ttrue,\n\t);\n\n\treturn (\n\t\t<motion.div\n\t\t\tclassName={twMerge(isOverflowVisible ? 'overflow-visible' : 'overflow-hidden', props.containerClassName)}\n\t\t\tstyle={{ height }}\n\t\t\tonAnimationComplete={onComplete}\n\t\t\tonAnimationStart={onStart}\n\t\t\tanimate={{ height }}\n\t\t\ttransition={props.transition}\n\t\t>\n\t\t\t<div ref={containerRef} className={props.className}>\n\t\t\t\t{props.children}\n\t\t\t</div>\n\t\t</motion.div>\n\t);\n};\n","import { VariantProps, cva } from 'class-variance-authority';\nimport { twMerge } from 'tailwind-merge';\nimport { z } from 'zod';\n\nexport const badgeColorOptions = z.union([\n\tz.literal('rose'),\n\tz.literal('red'),\n\tz.literal('yellow'),\n\tz.literal('orange'),\n\tz.literal('green'),\n\tz.literal('lime'),\n\tz.literal('blue'),\n\tz.literal('sky'),\n\tz.literal('indigo'),\n\tz.literal('purple'),\n\tz.literal('pink'),\n\tz.literal('brand'),\n\tz.literal('gray'),\n\tz.literal('plain'),\n]);\nexport const badgeTextColorStyle = cva('', {\n\tvariants: {\n\t\tcolor: {\n\t\t\trose: 'text-rose-700 dark:text-rose-400',\n\t\t\tred: 'text-red-700 dark:text-red-400',\n\t\t\tyellow: 'text-yellow-800 dark:text-yellow-500',\n\t\t\torange: 'text-orange-800 dark:text-orange-500',\n\t\t\tgreen: 'text-green-700 dark:text-green-400',\n\t\t\tlime: 'text-lime-700 dark:text-lime-400',\n\t\t\tblue: 'text-blue-700 dark:text-blue-400',\n\t\t\tsky: 'text-sky-700 dark:text-sky-400',\n\t\t\tindigo: 'text-indigo-700 dark:text-indigo-400',\n\t\t\tpurple: 'text-purple-700 dark:text-purple-400',\n\t\t\tpink: 'text-pink-700 dark:text-pink-400',\n\t\t\tbrand: 'text-brand-700 dark:text-brand-400',\n\t\t\tgray: 'text-zinc-600 dark:text-zinc-400',\n\t\t\tplain: 'text-zinc-900 dark:text-zinc-100',\n\t\t} satisfies { [key in z.infer<typeof badgeColorOptions>]: string },\n\t},\n});\n\nexport const badgeBackgroundColorStyle = cva('', {\n\tvariants: {\n\t\tcolor: {\n\t\t\trose: 'bg-rose-50 dark:bg-rose-400/10',\n\t\t\tred: 'bg-red-50 dark:bg-red-400/10',\n\t\t\tyellow: 'bg-yellow-50 dark:bg-yellow-400/10',\n\t\t\torange: 'bg-orange-50 dark:bg-orange-400/10',\n\t\t\tgreen: 'bg-green-50 dark:bg-green-500/10',\n\t\t\tlime: 'bg-lime-50 dark:bg-lime-500/10',\n\t\t\tblue: 'bg-blue-50 dark:bg-blue-400/10',\n\t\t\tsky: 'bg-sky-50 dark:bg-sky-400/10',\n\t\t\tindigo: 'bg-indigo-50 dark:bg-indigo-400/10',\n\t\t\tpurple: 'bg-purple-50 dark:bg-purple-400/10',\n\t\t\tpink: 'bg-pink-50 dark:bg-pink-400/10',\n\t\t\tbrand: 'bg-brand-100 dark:bg-brand-400/10',\n\t\t\tgray: 'bg-zinc-50 dark:bg-zinc-400/10',\n\t\t\tplain: 'bg-zinc-900/10 dark:bg-zinc-100/10',\n\t\t} satisfies { [key in z.infer<typeof badgeColorOptions>]: string },\n\t},\n});\n\nexport const badgeBorderColorStyle = cva('', {\n\tvariants: {\n\t\tcolor: {\n\t\t\trose: 'border-rose-600/10 dark:border-rose-400/20 ring-rose-600/10 dark:ring-rose-400/20',\n\t\t\tred: 'border-red-600/10 dark:border-red-400/20 ring-red-600/10 dark:ring-red-400/20',\n\t\t\tyellow: 'border-yellow-600/20 dark:border-yellow-400/20 ring-yellow-600/20 dark:ring-yellow-400/20',\n\t\t\torange: 'border-orange-600/20 dark:border-orange-400/20 ring-orange-600/20 dark:ring-orange-400/20',\n\t\t\tgreen: 'border-green-600/20 dark:border-green-500/20 ring-green-600/20 dark:ring-green-500/20',\n\t\t\tlime: 'border-lime-600/20 dark:border-lime-500/20 ring-lime-600/20 dark:ring-lime-500/20',\n\t\t\tblue: 'border-blue-700/10 dark:border-blue-400/30 ring-blue-700/10 dark:ring-blue-400/30',\n\t\t\tsky: 'border-sky-700/10 dark:border-sky-400/30 ring-sky-700/10 dark:ring-sky-400/30',\n\t\t\tindigo: 'border-indigo-700/10 dark:border-indigo-400/30 ring-indigo-700/10 dark:ring-indigo-400/30',\n\t\t\tpurple: 'border-purple-700/10 dark:border-purple-400/30 ring-purple-700/10 dark:ring-purple-400/30',\n\t\t\tpink: 'border-pink-700/10 dark:border-pink-400/20 ring-pink-700/10 dark:ring-pink-400/20',\n\t\t\tbrand: 'border-brand-600/40 dark:border-brand-400/30 ring-brand-600/40 dark:ring-brand-400/30',\n\t\t\tgray: 'border-zinc-500/10 dark:border-zinc-400/20 ring-zinc-500/10 dark:ring-zinc-400/20',\n\t\t\tplain: 'border-zinc-900 dark:border-zinc-100 ring-zinc-900 dark:ring-zinc-100',\n\t\t} satisfies { [key in z.infer<typeof badgeColorOptions>]: string },\n\t},\n});\n\nconst badgeStyle = cva('flex-0 inline-flex w-auto items-center rounded-md font-medium ring-1 ring-inset', {\n\tvariants: {\n\t\tsize: {\n\t\t\tsm: 'px-1.5 gap-1.5 py-1 text-2xs leading-3',\n\t\t\tmd: 'px-2 gap-2 py-1 text-xs leading-4',\n\t\t\tlg: 'px-2 gap-2 py-1 text-xs leading-6',\n\t\t},\n\t\tcolor: {\n\t\t\trose: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'rose' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'rose' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'rose' }),\n\t\t\t],\n\t\t\tred: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'red' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'red' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'red' }),\n\t\t\t],\n\t\t\tyellow: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'yellow' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'yellow' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'yellow' }),\n\t\t\t],\n\t\t\torange: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'orange' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'orange' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'orange' }),\n\t\t\t],\n\t\t\tgreen: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'green' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'green' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'green' }),\n\t\t\t],\n\t\t\tlime: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'lime' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'lime' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'lime' }),\n\t\t\t],\n\t\t\tblue: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'blue' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'blue' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'blue' }),\n\t\t\t],\n\t\t\tsky: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'sky' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'sky' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'sky' }),\n\t\t\t],\n\t\t\tindigo: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'indigo' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'indigo' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'indigo' }),\n\t\t\t],\n\t\t\tpurple: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'purple' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'purple' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'purple' }),\n\t\t\t],\n\t\t\tpink: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'pink' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'pink' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'pink' }),\n\t\t\t],\n\t\t\tbrand: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'brand' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'brand' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'brand' }),\n\t\t\t],\n\t\t\tgray: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'gray' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'gray' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'gray' }),\n\t\t\t],\n\t\t\tplain: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'plain' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'plain' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'plain' }),\n\t\t\t],\n\t\t} satisfies { [key in z.infer<typeof badgeColorOptions>]: string[] },\n\t},\n\tdefaultVariants: {\n\t\tsize: 'md',\n\t\tcolor: 'gray',\n\t},\n});\n\nexport type BadgeProps = JSX.IntrinsicElements['span'] &\n\tVariantProps<typeof badgeStyle> & {\n\t\tchildren: React.ReactNode;\n\t\tclassName?: string;\n\t};\n\nexport const Badge: React.FC<BadgeProps> = (props) => {\n\tconst { size, color, className, children, ...forwardProps } = props;\n\treturn (\n\t\t<span className={twMerge(badgeStyle({ size, color }), className)} {...forwardProps}>\n\t\t\t{children}\n\t\t</span>\n\t);\n};\n","import React from 'react';\nimport { badgeBackgroundColorStyle, badgeBorderColorStyle, badgeTextColorStyle } from '@/components/common/badge';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport { VariantProps, cva } from 'class-variance-authority';\n\nconst bannerStyle = cva('rounded-md p-4 border', {\n\tvariants: {\n\t\tcolor: {\n\t\t\tred: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'red' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'red' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'red' }),\n\t\t\t],\n\t\t\tyellow: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'yellow' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'yellow' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'yellow' }),\n\t\t\t],\n\t\t\torange: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'orange' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'orange' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'orange' }),\n\t\t\t],\n\t\t\tgreen: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'green' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'green' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'green' }),\n\t\t\t],\n\t\t\tlime: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'lime' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'lime' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'lime' }),\n\t\t\t],\n\t\t\tblue: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'blue' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'blue' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'blue' }),\n\t\t\t],\n\t\t\tsky: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'sky' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'sky' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'sky' }),\n\t\t\t],\n\t\t\tindigo: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'indigo' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'indigo' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'indigo' }),\n\t\t\t],\n\t\t\tpurple: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'purple' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'purple' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'purple' }),\n\t\t\t],\n\t\t\tpink: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'pink' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'pink' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'pink' }),\n\t\t\t],\n\t\t\tbrand: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'brand' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'brand' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'brand' }),\n\t\t\t],\n\t\t\tgray: [\n\t\t\t\tbadgeBackgroundColorStyle({ color: 'gray' }),\n\t\t\t\tbadgeBorderColorStyle({ color: 'gray' }),\n\t\t\t\tbadgeTextColorStyle({ color: 'gray' }),\n\t\t\t],\n\t\t},\n\t},\n\tdefaultVariants: {\n\t\tcolor: 'gray',\n\t},\n});\n\ninterface BannerProps extends React.PropsWithChildren<VariantProps<typeof bannerStyle>> {\n\tclassName?: string;\n\tIcon: React.ComponentType<{ className?: string }>;\n\ttitle?: string;\n}\n\nexport const Banner: React.FC<BannerProps> = (props) => {\n\tconst { Icon, className, title } = props;\n\treturn (\n\t\t<div className={twMerge(bannerStyle({ color: props.color }), props.className)}>\n\t\t\t<div className=\"flex\">\n\t\t\t\t<div className=\"flex-shrink-0\">\n\t\t\t\t\t<Icon className={twJoin('h-5 w-5')} aria-hidden=\"true\" />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"ml-3 flex-1\">\n\t\t\t\t\t<h3 className={twJoin('text-sm font-bold')}>{props.title}</h3>\n\t\t\t\t\t<div className=\"mt-2 text-sm\">{props.children}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","'use client';\nimport Link, { LinkProps } from 'next/link';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport React, { Fragment, forwardRef } from 'react';\nimport { VariantProps, cva } from 'class-variance-authority';\nimport { Menu, Transition } from '@headlessui/react';\nimport { ChevronDownIcon } from '@heroicons/react/20/solid';\nimport { Route } from 'next';\n\nexport const buttonVariants = cva(\n\t'inline-flex items-center justify-center border font-semibold rounded-md shadow-sm focus:outline-none focus:ring-2 capitalize relative active:translate-y-px active:scale-[99%] active:outline-none transition-all',\n\t{\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tdanger: twJoin(\n\t\t\t\t\t'text-red-50 bg-red-500/70 hover:bg-red-600 border-transparent focus:ring-offset-2 focus:ring-red-400 dark:focus:ring-offset-zinc-900',\n\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--red-900)),_0px_1px_0px_0px_hsl(var(--red-400)_/_50%)_inset]',\n\t\t\t\t),\n\t\t\t\twarning: twJoin(\n\t\t\t\t\t'text-yellow-50 bg-yellow-400/70 hover:bg-yellow-600 border-transparent focus:ring-offset-2 focus:ring-yellow-400 dark:focus:ring-offset-zinc-900',\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--yellow-900)),_0px_1px_0px_0px_hsl(var(--yellow-400)_/_50%)_inset]',\n\t\t\t\t),\n\t\t\t\tinfo: twJoin(\n\t\t\t\t\t'text-blue-50 bg-sky-400/70 hover:bg-sky-600 border-transparent focus:ring-offset-2 focus:ring-sky-400 dark:focus:ring-offset-zinc-900',\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--sky-900)),_0px_1px_0px_0px_hsl(var(--sky-400)_/_50%)_inset]',\n\t\t\t\t),\n\t\t\t\tprimary: twJoin(\n\t\t\t\t\t'text-white bg-brand-400/50 hover:bg-brand-700 border-transparent focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900',\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--brand-900)),_0px_1px_0px_0px_hsl(var(--brand-400)_/_50%)_inset]',\n\t\t\t\t),\n\t\t\t\tsuccess:\n\t\t\t\t\t'text-green-100 bg-green-500 hover:bg-green-600 border-transparent focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900',\n\t\t\t\tindeterminate: twJoin(\n\t\t\t\t\t'border-transparent bg-zinc-100 hover:bg-zinc-200 text-black dark:text-zinc-300 dark:bg-zinc-800 dark:transparent dark:hover:bg-zinc-700 dark:hover:text-zinc-100 dark:hover:transparent focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900',\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--zinc-900)),_0px_1px_0px_0px_hsl(var(--zinc-400)_/_20%)_inset]',\n\t\t\t\t),\n\t\t\t\toutline:\n\t\t\t\t\t'border-zinc-700 shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 hover:bg-zinc-500/30 hover:border-zinc-500/50 hover:text-zinc-800 dark:hover:text-zinc-200 focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900',\n\t\t\t\tplain:\n\t\t\t\t\t'border-transparent shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 hover:underline hover:text-zinc-800 dark:hover:text-zinc-200 focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900',\n\t\t\t},\n\t\t\tdisabled: {\n\t\t\t\ttrue: 'opacity-60 cursor-not-allowed',\n\t\t\t},\n\t\t\tsize: {\n\t\t\t\tsm: 'px-2 py-1 text-xs gap-2',\n\t\t\t\tlg: 'px-6 py-3 text-lg gap-4',\n\t\t\t\tdefault: 'px-3 py-2 text-sm gap-2',\n\t\t\t\ticon: 'h-9 w-9',\n\t\t\t\t'icon-sm': 'h-6 w-6',\n\t\t\t\t'icon-xs': 'h-4 w-4',\n\t\t\t},\n\t\t},\n\t\tcompoundVariants: [\n\t\t\t{\n\t\t\t\tvariant: 'primary',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-brand-400/50',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'danger',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-red-500/70',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'warning',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-yellow-500',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'indeterminate',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-zinc-100 dark:hover:bg-zinc-800',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'info',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-sky-400/70',\n\t\t\t},\n\t\t],\n\t\tdefaultVariants: {\n\t\t\tvariant: 'primary',\n\t\t\tsize: 'default',\n\t\t\tdisabled: false,\n\t\t},\n\t},\n);\n\nexport type ButtonVariantProps = VariantProps<typeof buttonVariants>;\nexport type Intents = NonNullable<Required<ButtonVariantProps>['variant']>;\n\nexport interface ButtonProps<T extends string>\n\textends React.PropsWithChildren<ButtonVariantProps & React.ButtonHTMLAttributes<HTMLButtonElement>> {\n\tonClick?: () => void;\n\tclassName?: string;\n\ttarget?: string;\n\tasChild?: boolean;\n\thref?: Route<T> | URL;\n\ttitle?: string;\n\trel?: string;\n\tdropdownItems?: {\n\t\tonClick: () => void;\n\t\ttitle: string;\n\t}[];\n}\n\nexport const Button = forwardRef(function Button<T extends string>(\n\tprops: ButtonProps<T>,\n\tref: React.ForwardedRef<HTMLButtonElement & HTMLAnchorElement>,\n) {\n\tconst {\n\t\tvariant,\n\t\tdisabled,\n\t\tsize,\n\t\thref,\n\t\ttarget,\n\t\tonClick,\n\t\ttitle,\n\t\trel,\n\t\tdropdownItems,\n\t\tclassName,\n\t\tchildren,\n\t\t...forwardProps\n\t} = props;\n\tconst buttonClasses = twMerge(buttonVariants({ variant: variant, disabled: disabled, size: size }), className);\n\tif (href) {\n\t\treturn (\n\t\t\t<Link<T>\n\t\t\t\thref={href}\n\t\t\t\tref={ref}\n\t\t\t\tclassName={buttonClasses}\n\t\t\t\ttarget={target}\n\t\t\t\tonClick={onClick}\n\t\t\t\ttitle={title}\n\t\t\t\trel={rel}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</Link>\n\t\t);\n\t}\n\tif (dropdownItems && dropdownItems.length && onClick == null) {\n\t\treturn (\n\t\t\t<Menu as=\"span\" className=\"relative inline-block text-left\">\n\t\t\t\t<Menu.Button className={buttonClasses} title={title} disabled={!!disabled}>\n\t\t\t\t\t{children}\n\t\t\t\t\t<ChevronDownIcon className=\"-mr-2 h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t</Menu.Button>\n\n\t\t\t\t<Transition\n\t\t\t\t\tas={Fragment}\n\t\t\t\t\tenter=\"transition ease-out duration-100\"\n\t\t\t\t\tenterFrom=\"transform opacity-0 scale-95\"\n\t\t\t\t\tenterTo=\"transform opacity-100 scale-100\"\n\t\t\t\t\tleave=\"transition ease-in duration-75\"\n\t\t\t\t\tleaveFrom=\"transform opacity-100 scale-100\"\n\t\t\t\t\tleaveTo=\"transform opacity-0 scale-95\"\n\t\t\t\t>\n\t\t\t\t\t<Menu.Items className=\"absolute right-0 z-10 mt-2 w-56 origin-top-right divide-y divide-zinc-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none dark:divide-zinc-800 dark:bg-zinc-900 dark:shadow-black dark:ring-zinc-800\">\n\t\t\t\t\t\t{dropdownItems.map((item) => (\n\t\t\t\t\t\t\t<div className=\"py-1\" key={item.title}>\n\t\t\t\t\t\t\t\t<Menu.Item>\n\t\t\t\t\t\t\t\t\t{({ active }) => (\n\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\tonClick={item.onClick}\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\t\tactive\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-zinc-100 text-zinc-900 dark:bg-zinc-800 dark:text-zinc-100'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'text-zinc-700 dark:text-zinc-300',\n\t\t\t\t\t\t\t\t\t\t\t\t'block cursor-pointer break-words px-4 py-2 text-sm',\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{item.title}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</Menu.Items>\n\t\t\t\t</Transition>\n\t\t\t</Menu>\n\t\t);\n\t}\n\treturn (\n\t\t<button\n\t\t\tref={ref}\n\t\t\tclassName={buttonClasses}\n\t\t\tonClick={disabled ? undefined : onClick}\n\t\t\ttitle={title}\n\t\t\t{...forwardProps}\n\t\t>\n\t\t\t{children}\n\t\t</button>\n\t);\n});\n","import { twMerge } from 'tailwind-merge';\n\nexport const Spinner: React.FC<{ className?: string; noMargin?: boolean; strokeWidth?: number }> = (props) => {\n\treturn (\n\t\t<svg\n\t\t\tclassName={twMerge(\n\t\t\t\t'h-5 w-5 animate-spin text-black/50 dark:text-white/50',\n\t\t\t\t!props.noMargin ? '-ml-1 mr-3' : '',\n\t\t\t\tprops.className,\n\t\t\t)}\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\tfill=\"none\"\n\t\t\tviewBox=\"0 0 24 24\"\n\t\t>\n\t\t\t<circle\n\t\t\t\tclassName=\"opacity-20\"\n\t\t\t\tcx=\"12\"\n\t\t\t\tcy=\"12\"\n\t\t\t\tr=\"10\"\n\t\t\t\tstroke=\"currentColor\"\n\t\t\t\tstrokeWidth={props.strokeWidth ?? 4}\n\t\t\t></circle>\n\t\t\t<circle\n\t\t\t\tclassName=\"opacity-100\"\n\t\t\t\tcx=\"12\"\n\t\t\t\tcy=\"12\"\n\t\t\t\tr=\"10\"\n\t\t\t\tstrokeDasharray={(Math.PI * 10) / 3}\n\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\tstroke=\"currentColor\"\n\t\t\t\tstrokeWidth={props.strokeWidth ?? 4}\n\t\t\t></circle>\n\t\t</svg>\n\t);\n};\n","import * as React from 'react';\n\nimport { cn } from '@/helpers/utils';\n\nconst CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<div ref={ref} className={cn('flex flex-col space-y-1.5 p-4 @sm:p-6', className)} {...props} />\n\t),\n);\n(CardHeader as React.FC).displayName = 'CardHeader';\n\nconst CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<h3 ref={ref} className={cn('font-semibold leading-none tracking-tight', className)} {...props} />\n\t),\n);\n(CardTitle as React.FC).displayName = 'CardTitle';\n\nconst CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<div ref={ref} className={cn('text-sm text-muted-foreground', className)} {...props} />\n\t),\n);\n(CardDescription as React.FC).displayName = 'CardDescription';\n\nconst CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n\t({ className, ...props }, ref) => <div ref={ref} className={cn('p-4 pt-0 @sm:p-6', className)} {...props} />,\n);\n(CardContent as React.FC).displayName = 'CardContent';\n\nconst CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<div ref={ref} className={cn('flex items-center p-4 pt-0 @sm:p-6', className)} {...props} />\n\t),\n);\n(CardFooter as React.FC).displayName = 'CardFooter';\n\nexport { CardHeader, CardFooter, CardTitle, CardDescription, CardContent };\n","'use client';\n\nimport * as React from 'react';\nimport * as DialogPrimitive from '@radix-ui/react-dialog';\nimport { Cross2Icon } from '@radix-ui/react-icons';\n\nimport { cn } from '@/helpers/utils';\n\nconst Dialog = DialogPrimitive.Root;\n\nconst DialogTrigger = DialogPrimitive.Trigger;\n\nconst DialogPortal = DialogPrimitive.Portal;\n\nconst DialogClose = DialogPrimitive.Close;\n\nconst DialogOverlay = React.forwardRef<\n\tReact.ElementRef<typeof DialogPrimitive.Overlay>,\n\tReact.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n\t<DialogPrimitive.Overlay\n\t\tref={ref}\n\t\tclassName={cn(\n\t\t\t'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',\n\t\t\tclassName,\n\t\t)}\n\t\t{...props}\n\t/>\n));\n(DialogOverlay as any).displayName = DialogPrimitive.Overlay.displayName;\n\nconst DialogContent = React.forwardRef<\n\tReact.ElementRef<typeof DialogPrimitive.Content>,\n\tReact.ComponentPropsWithoutRef<typeof DialogPrimitive.Content> & {\n\t\tnoClose?: boolean;\n\t}\n>(({ className, children, noClose, ...props }, ref) => (\n\t<DialogPortal>\n\t\t<DialogOverlay />\n\t\t<DialogPrimitive.Content\n\t\t\tref={ref}\n\t\t\tclassName={cn(\n\t\t\t\t'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t{children}\n\t\t\t{!noClose && (\n\t\t\t\t<DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none\">\n\t\t\t\t\t<Cross2Icon className=\"h-4 w-4\" />\n\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t</DialogPrimitive.Close>\n\t\t\t)}\n\t\t</DialogPrimitive.Content>\n\t</DialogPortal>\n));\n(DialogContent as any).displayName = DialogPrimitive.Content.displayName;\n\nconst DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n\t<div className={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)} {...props} />\n);\n(DialogHeader as any).displayName = 'DialogHeader';\n\nconst DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n\t<div className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)} {...props} />\n);\n(DialogFooter as any).displayName = 'DialogFooter';\n\nconst DialogTitle = React.forwardRef<\n\tReact.ElementRef<typeof DialogPrimitive.Title>,\n\tReact.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n\t<DialogPrimitive.Title\n\t\tref={ref}\n\t\tclassName={cn('text-lg font-semibold leading-none tracking-tight', className)}\n\t\t{...props}\n\t/>\n));\n(DialogTitle as any).displayName = DialogPrimitive.Title.displayName;\n\nconst DialogDescription = React.forwardRef<\n\tReact.ElementRef<typeof DialogPrimitive.Description>,\n\tReact.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n\t<DialogPrimitive.Description ref={ref} className={cn('text-sm text-muted-foreground', className)} {...props} />\n));\n(DialogDescription as any).displayName = DialogPrimitive.Description.displayName;\n\nexport {\n\tDialog,\n\tDialogPortal,\n\tDialogOverlay,\n\tDialogTrigger,\n\tDialogClose,\n\tDialogContent,\n\tDialogHeader,\n\tDialogFooter,\n\tDialogTitle,\n\tDialogDescription,\n};\n","import * as React from 'react';\n\nimport { cn, setDisplayName } from '@/helpers/utils';\nimport { twJoin } from 'tailwind-merge';\n\nconst Table = React.forwardRef<\n\tHTMLTableElement,\n\tReact.HTMLAttributes<HTMLTableElement> & { containerClassName?: string }\n>(({ className, containerClassName, ...props }, ref) => (\n\t<div className={twJoin('scrollable, relative w-full overflow-auto rounded-md border', containerClassName)}>\n\t\t<table ref={ref} className={cn('w-full caption-bottom rounded-md text-sm', className)} {...props} />\n\t</div>\n));\nsetDisplayName(Table, 'Table');\n\nconst TableHeader = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<thead\n\t\t\tref={ref}\n\t\t\tclassName={cn('border-l border-l-zinc-400/5 bg-zinc-400/5 [&_tr]:border-b', className)}\n\t\t\t{...props}\n\t\t/>\n\t),\n);\nsetDisplayName(TableHeader, 'TableHeader');\n\nconst TableBody = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<tbody\n\t\t\tref={ref}\n\t\t\tclassName={cn('rounded-b-sm [&_tr:last-child]:rounded-b-sm [&_tr:last-child]:border-b-0', className)}\n\t\t\t{...props}\n\t\t/>\n\t),\n);\nsetDisplayName(TableBody, 'TableBody');\n\nconst TableFooter = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<tfoot ref={ref} className={cn('border-t bg-muted/50 font-medium [&>tr]:last:border-b-0', className)} {...props} />\n\t),\n);\nsetDisplayName(TableFooter, 'TableFooter');\n\nconst TableRow = React.forwardRef<HTMLTableRowElement, React.HTMLAttributes<HTMLTableRowElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<tr\n\t\t\tref={ref}\n\t\t\tclassName={cn(\n\t\t\t\t'border-x-transparent border-t-transparent transition-colors data-[state=selected]:!border data-[state=selected]:!border-brand-800 data-[state=selected]:!bg-brand-400/10 data-[state=selected]:ring-1 data-[state=selected]:ring-brand-800 [tbody>&]:border [tbody>&]:hover:border-x-muted/50 [tbody>&]:hover:bg-muted/50',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t/>\n\t),\n);\nsetDisplayName(TableRow, 'TableRow');\n\nconst TableHead = React.forwardRef<HTMLTableCellElement, React.ThHTMLAttributes<HTMLTableCellElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<th\n\t\t\tref={ref}\n\t\t\tclassName={cn(\n\t\t\t\t'h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t/>\n\t),\n);\nsetDisplayName(TableHead, 'TableHead');\n\nconst TableCell = React.forwardRef<HTMLTableCellElement, React.TdHTMLAttributes<HTMLTableCellElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<td ref={ref} className={cn('p-2 align-middle [&:has([role=checkbox])]:pr-0', className)} {...props} />\n\t),\n);\nsetDisplayName(TableCell, 'TableCell');\n\nconst TableCaption = React.forwardRef<HTMLTableCaptionElement, React.HTMLAttributes<HTMLTableCaptionElement>>(\n\t({ className, ...props }, ref) => (\n\t\t<caption ref={ref} className={cn('mt-4 text-sm text-muted-foreground', className)} {...props} />\n\t),\n);\nsetDisplayName(TableCaption, 'TableCaption');\n\nexport { Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption };\n","import { LoggerOptions } from 'pino';\n\nexport const globalPinoOpts: LoggerOptions = {\n\ttimestamp: true,\n\tlevel: process.env.NODE_ENV === 'development' ? 'debug' : 'info',\n};\n","import { proxyClient, trpc } from '@/utils/trpc';\nexport { trpc, proxyClient as trpcClient };\n","'use client';\nexport const getHost = () => {\n\treturn process.env.NEXT_PUBLIC_KLIPPER_HOSTNAME != null && process.env.NEXT_PUBLIC_KLIPPER_HOSTNAME.trim() != ''\n\t\t? process.env.NEXT_PUBLIC_KLIPPER_HOSTNAME\n\t\t: typeof window !== 'undefined' && window.location?.hostname != null\n\t\t\t? window.location.hostname\n\t\t\t: null;\n};\nexport function formatBytes(bytes: number, decimals: number = 2) {\n\tif (bytes == 0) return '0 bytes';\n\tvar k = 1024,\n\t\tsizes = ['bytes', 'kb', 'mb', 'gb', 'tb', 'pb', 'eb', 'zb', 'yb'],\n\t\ti = Math.floor(Math.log(bytes) / Math.log(k));\n\treturn parseFloat((bytes / Math.pow(k, i)).toFixed(decimals)) + ' ' + sizes[i];\n}\n","/* eslint-disable no-console */\nimport { getHost } from '@/helpers/util';\nimport { MoonrakerDBItemResponse } from '@/moonraker/types';\n\ninterface Migration {\n\tversion: number;\n\tdescription: string;\n\tup: () => Promise<{ result: string }>;\n\tdown: () => Promise<{ result: string }>;\n}\n\nexport const migrations: Migration[] = [\n\t{\n\t\tversion: 1,\n\t\tdescription: \"Undo double JSON encoding of RatOS's data\",\n\t\tup: async () => {\n\t\t\tconst res = await window.fetch(`http://${getHost()}/server/database/item?namespace=RatOS`);\n\t\t\tif (res.ok) {\n\t\t\t\tconst data = (await res.json()) as\n\t\t\t\t\t| { result: MoonrakerDBItemResponse<{ [key: string]: unknown }> }\n\t\t\t\t\t| { error: { message: string } };\n\t\t\t\tif ('error' in data) {\n\t\t\t\t\tthrow new Error(data.error.message);\n\t\t\t\t}\n\t\t\t\tconst result: string[] = [];\n\t\t\t\tif (data.result.value == null) {\n\t\t\t\t\treturn { result: 'Nothing to migrate' };\n\t\t\t\t}\n\t\t\t\tfor await (const [key, value] of Object.entries(data.result.value)) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst parsed = JSON.parse(value as any);\n\t\t\t\t\t\tconsole.log('Migrating', key, 'from', value, 'to', parsed);\n\t\t\t\t\t\tawait window.fetch(`http://${getHost()}/server/database/item`, {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\tnamespace: 'RatOS',\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tvalue: parsed,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.error('Error migrating', key, value, 'clearing key');\n\t\t\t\t\t\tawait window.fetch(\n\t\t\t\t\t\t\t`http://${getHost()}/server/database/item?namespace=RatOS&key=${encodeURIComponent(key)}`,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmethod: 'DELETE',\n\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\t\tnamespace: 'RatOS',\n\t\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { result: `Succesfully decoded ${result.length} keys.\\n${result.join('\\n')}` };\n\t\t\t} else {\n\t\t\t\treturn { result: 'Nothing to migrate' };\n\t\t\t}\n\t\t},\n\t\tdown: async () => {\n\t\t\t// drop table\n\t\t\tconst res = await window.fetch(`http://${getHost()}/server/database/item?namespace=RatOS`);\n\t\t\tif (res.ok) {\n\t\t\t\tconst data = (await res.json()) as\n\t\t\t\t\t| { result: MoonrakerDBItemResponse<{ [key: string]: unknown }> }\n\t\t\t\t\t| { error: { message: string } };\n\t\t\t\tif ('error' in data) {\n\t\t\t\t\tthrow new Error(data.error.message);\n\t\t\t\t}\n\t\t\t\tif (data.result.value == null) {\n\t\t\t\t\treturn { result: 'Nothing to migrate' };\n\t\t\t\t}\n\t\t\t\tconst result: string[] = [];\n\t\t\t\tfor await (const [key, value] of Object.entries(data.result.value)) {\n\t\t\t\t\tconst encoded = JSON.stringify(value as any);\n\t\t\t\t\tawait window.fetch(`http://${getHost()}/server/database/item`, {\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\tnamespace: 'RatOS',\n\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\tvalue: encoded,\n\t\t\t\t\t\t}),\n\t\t\t\t\t});\n\t\t\t\t\tresult.push(`Re-encoded ${key}`);\n\t\t\t\t}\n\t\t\t\treturn { result: `Succesfully re-encoded ${result.length} keys.\\n${result.join('\\n')}` };\n\t\t\t}\n\t\t\treturn { result: 'Nothing to migrate' };\n\t\t},\n\t},\n\t{\n\t\tversion: 2,\n\t\tdescription: 'Change caramba printers to v-core-4 / v-chonk',\n\t\tup: async () => {\n\t\t\tconst res = await window.fetch(`http://${getHost()}/server/database/item?namespace=RatOS`);\n\t\t\tif (res.ok) {\n\t\t\t\tconst data = (await res.json()) as\n\t\t\t\t\t| { result: MoonrakerDBItemResponse<{ [key: string]: unknown }> }\n\t\t\t\t\t| { error: { message: string } };\n\t\t\t\tif ('error' in data) {\n\t\t\t\t\tthrow new Error(data.error.message);\n\t\t\t\t}\n\t\t\t\tconst result: string[] = [];\n\t\t\t\tif (data.result.value == null) {\n\t\t\t\t\treturn { result: 'Nothing to migrate' };\n\t\t\t\t}\n\t\t\t\tfor await (const [key, value] of Object.entries(data.result.value)) {\n\t\t\t\t\tif (key === 'Printer' && typeof value === 'string') {\n\t\t\t\t\t\tconst migratedValue = value.replace(/caramba-chonk/g, 'v-chonk').replace(/caramba/g, 'v-core-4');\n\t\t\t\t\t\tif (migratedValue === value) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tawait window.fetch(`http://${getHost()}/server/database/item`, {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\tnamespace: 'RatOS',\n\t\t\t\t\t\t\t\tkey: 'Printer',\n\t\t\t\t\t\t\t\tvalue: migratedValue,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresult.push(`Migrated ${value} to ${migratedValue}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { result: `Succesfully migrated ${result.length} keys.\\n${result.join('\\n')}` };\n\t\t\t} else {\n\t\t\t\treturn { result: 'Nothing to migrate' };\n\t\t\t}\n\t\t},\n\t\tdown: async () => {\n\t\t\tconst res = await window.fetch(`http://${getHost()}/server/database/item?namespace=RatOS`);\n\t\t\tif (res.ok) {\n\t\t\t\tconst data = (await res.json()) as\n\t\t\t\t\t| { result: MoonrakerDBItemResponse<{ [key: string]: unknown }> }\n\t\t\t\t\t| { error: { message: string } };\n\t\t\t\tif ('error' in data) {\n\t\t\t\t\tthrow new Error(data.error.message);\n\t\t\t\t}\n\t\t\t\tconst result: string[] = [];\n\t\t\t\tif (data.result.value == null) {\n\t\t\t\t\treturn { result: 'Nothing to migrate' };\n\t\t\t\t}\n\t\t\t\tfor await (const [key, value] of Object.entries(data.result.value)) {\n\t\t\t\t\tif (key === 'Printer' && typeof value === 'string') {\n\t\t\t\t\t\tconst migratedValue = value.replace(/v-chonk/g, 'caramba-chonk').replace(/v-core-4/g, 'caramba');\n\t\t\t\t\t\tif (migratedValue === value) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tawait window.fetch(`http://${getHost()}/server/database/item`, {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\tnamespace: 'RatOS',\n\t\t\t\t\t\t\t\tkey: 'Printer',\n\t\t\t\t\t\t\t\tvalue: migratedValue,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresult.push(`Migrated ${value} to ${migratedValue}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { result: `Succesfully migrated ${result.length} keys.\\n${result.join('\\n')}` };\n\t\t\t} else {\n\t\t\t\treturn { result: 'Nothing to migrate' };\n\t\t\t}\n\t\t},\n\t},\n];\n\nexport const getCurrentVersion = async (): Promise<number> => {\n\tconst res = await window.fetch(`http://${getHost()}/server/database/item?namespace=RatOS&key=__db_version`);\n\tif (res.ok) {\n\t\tconst data = (await res.json()) as { result: MoonrakerDBItemResponse<number> } | { error: { message: string } };\n\t\tif ('error' in data) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn data.result.value as number;\n\t}\n\treturn 0;\n};\n\nexport const setCurrentVersion = async (version: number) => {\n\tawait window.fetch(`http://${getHost()}/server/database/item`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tnamespace: 'RatOS',\n\t\t\tkey: '__db_version',\n\t\t\tvalue: version,\n\t\t}),\n\t});\n};\n\nlet isMigrating = false;\nexport const migrate = async (from: number, to: number) => {\n\tif (isMigrating) {\n\t\treturn console.log('Already migrating, ignoring..');\n\t}\n\tif (from === to) {\n\t\treturn console.log('Already at target version');\n\t}\n\tisMigrating = true;\n\ttry {\n\t\tconst migrationsToRun = migrations\n\t\t\t.filter((m) => m.version > from && m.version <= to)\n\t\t\t.sort((a, b) => (from <= to ? a.version - b.version : b.version - a.version));\n\t\tfor await (const migration of migrationsToRun) {\n\t\t\tconst result = await (from < to ? migration.up() : migration.down());\n\t\t\tconsole.log(`Migrated to version ${migration.version}: ${result.result}`);\n\t\t}\n\t\tawait setCurrentVersion(to);\n\t} finally {\n\t\tisMigrating = false;\n\t}\n};\n\nlet isMigrated = false;\nexport const migrateToLatest = async () => {\n\tif (isMigrated) {\n\t\treturn console.log('Already migrated, ignoring..');\n\t}\n\tconst currentVersion = await getCurrentVersion();\n\tconst latestVersion = Math.max(...migrations.map((m) => m.version));\n\tif (currentVersion === latestVersion) {\n\t\tconsole.log('Already at latest version');\n\t\treturn;\n\t}\n\tif (isMigrating) {\n\t\tconsole.log('Already migrating, ignoring..');\n\t\treturn;\n\t}\n\tconsole.log('Migrating to latest version...', currentVersion, latestVersion);\n\tawait migrate(currentVersion, latestVersion);\n\tisMigrated = true;\n\tconsole.log('Migration complete.');\n};\n","'use client';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { UseMutationOptions, UseQueryOptions, useMutation, useQuery } from '@tanstack/react-query';\nimport useWebSocket from 'react-use-websocket';\nimport { migrateToLatest } from '@/moonraker/migrations';\nimport type {\n\tInFlightRequestCallbacks,\n\tInFlightRequestTimeouts,\n\tJSONRPCResponse,\n\tMoonrakerStatus,\n\tMoonrakerSaveItemFn,\n\tMoonrakerNamespaces,\n\tMoonrakerDBItemResponse,\n\tMoonrakerGetItemFn,\n\tMoonrakerNamespaceKeys,\n\tMoonrakerDBValue,\n\tMoonrakerQueryFn,\n\tMoonrakerQueryKeys,\n\tMoonrakerQueryParams,\n\tMoonrakerQueryResult,\n\tMoonrakerMutationKeys,\n\tMoonrakerMutationParams,\n\tMoonrakerMutationResult,\n\tMoonrakerMutationFn,\n\tPrinterObjectKeys,\n\tPrinterObjectsMoonrakerQueryParams,\n\tPrinterObjectResult,\n\tJSONRPCResponseSuccess,\n} from '@/moonraker/types';\nimport { getHost } from '@/helpers/util';\nimport { merge } from 'ts-deepmerge';\nimport deepEqual from 'deep-equal';\nimport { getLogger } from '@/app/_helpers/logger';\n\nlet REQ_ID = 0;\n\nconst getWsURL = () => {\n\tconst host = getHost();\n\tif (host == null || host.trim() == '') {\n\t\treturn null;\n\t}\n\treturn `ws://${host}/websocket`;\n};\n\nconst subscriptions: { [key: number]: Partial<PrinterObjectsMoonrakerQueryParams> } = {};\n\ntype MoonrakerStatusUpdate = { [key in PrinterObjectKeys]: PrinterObjectResult<PrinterObjectKeys> };\n\ninterface MoonrakerHookOptions {\n\tonStatusUpdate?: (status: MoonrakerStatusUpdate) => void;\n\tpassThroughUpdateMethods?: string[];\n}\n\nexport const useMoonraker = (options?: MoonrakerHookOptions) => {\n\tconst inFlightRequests = useRef<InFlightRequestCallbacks>({});\n\tconst inFlightRequestTimeouts = useRef<InFlightRequestTimeouts>({});\n\tconst localSubscriptions = useRef<number[]>([]);\n\tconst onReadyCallbacks = useRef<{ resolve: () => void; reject: () => void }[]>([]);\n\tconst [wsUrl, setWsUrl] = useState(getWsURL());\n\tuseEffect(() => {\n\t\tsetWsUrl(getWsURL());\n\t}, []);\n\n\tconst containsSubscriptionUpdate = useCallback(\n\t\t(jsonMessage: JSONRPCResponse): jsonMessage is JSONRPCResponseSuccess => {\n\t\t\tif ('error' in jsonMessage) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (jsonMessage.method === 'notify_status_update' && jsonMessage.params != null) {\n\t\t\t\tconst res = jsonMessage.params[0] as MoonrakerStatusUpdate;\n\t\t\t\tif (res != null) {\n\t\t\t\t\tfor (const sub of localSubscriptions.current) {\n\t\t\t\t\t\tconst objects = subscriptions[sub];\n\t\t\t\t\t\tif (objects != null) {\n\t\t\t\t\t\t\tfor (const key in objects) {\n\t\t\t\t\t\t\t\tif (res[key as PrinterObjectKeys] != null) {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t[],\n\t);\n\n\tconst { lastJsonMessage, sendJsonMessage, readyState } = useWebSocket<JSONRPCResponse>(wsUrl, {\n\t\tfilter: (message) => {\n\t\t\tif (moonrakerStatus !== 'connected') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tconst parsed = JSON.parse(message.data) as JSONRPCResponse;\n\t\t\t\tif (inFlightRequests.current[parsed.id] != null) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\toptions?.passThroughUpdateMethods?.length &&\n\t\t\t\t\t'method' in parsed &&\n\t\t\t\t\toptions.passThroughUpdateMethods.includes(parsed.method)\n\t\t\t\t) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} catch (e) {\n\t\t\t\tgetLogger().warn({ e, messageData: message.data }, 'Filter: Failed to parse message');\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tonMessage: (message) => {\n\t\t\tif (options?.onStatusUpdate) {\n\t\t\t\ttry {\n\t\t\t\t\tconst parsed = JSON.parse(message.data) as JSONRPCResponse;\n\t\t\t\t\tif (containsSubscriptionUpdate(parsed)) {\n\t\t\t\t\t\tconst res = parsed.params[0] as MoonrakerStatusUpdate;\n\t\t\t\t\t\toptions.onStatusUpdate?.(res);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tgetLogger().warn({ e, messageData: message.data }, 'OnMessage: Failed to parse message');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshouldReconnect: (closeEvent) => {\n\t\t\treturn true;\n\t\t},\n\t\treconnectAttempts: Infinity,\n\t\treconnectInterval: 3000,\n\t\tshare: true,\n\t});\n\tconst readyStateRef = useRef(readyState);\n\treadyStateRef.current = readyState;\n\tconst [moonrakerStatus, setMoonrakerStatus] = useState<null | MoonrakerStatus>(\n\t\treadyState === 1 ? 'connected' : 'connecting',\n\t);\n\n\tconst whenReady = useCallback((resolve: () => void, reject: () => void) => {\n\t\tif (readyStateRef.current === 1) {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tonReadyCallbacks.current.push({ resolve, reject });\n\t\t}\n\t}, []);\n\n\tconst isReady = useCallback(\n\t\t() =>\n\t\t\tnew Promise<void>((resolve, reject) => {\n\t\t\t\twhenReady(resolve, reject);\n\t\t\t}),\n\t\t[whenReady],\n\t);\n\tconst moonrakerQuery: MoonrakerQueryFn & MoonrakerMutationFn = useCallback(\n\t\tasync <Response = any,>(method: string, params: any = {}) => {\n\t\t\tconst id = ++REQ_ID;\n\t\t\tawait isReady();\n\t\t\treturn new Promise<Response>((resolve, reject) => {\n\t\t\t\tinFlightRequests.current[id] = (err, result) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t}\n\t\t\t\t\tif (result && typeof result === 'object' && 'error' in result && result.error) {\n\t\t\t\t\t\treturn reject(result.error);\n\t\t\t\t\t}\n\t\t\t\t\tif (result == null) {\n\t\t\t\t\t\treturn reject(new Error('No result. Unknown response format.'));\n\t\t\t\t\t}\n\t\t\t\t\tresolve(result as Response);\n\t\t\t\t};\n\t\t\t\tlet timeout = 10 * 1000;\n\t\t\t\tif (method === 'printer.gcode.script') {\n\t\t\t\t\t// Allow 10 minutes for gcode macros.\n\t\t\t\t\ttimeout = 10 * 60 * 1000;\n\t\t\t\t}\n\t\t\t\tinFlightRequestTimeouts.current[id] = window.setTimeout(() => {\n\t\t\t\t\tinFlightRequests.current[id]?.(new Error('Request timed out'), null);\n\t\t\t\t\tdelete inFlightRequests.current[id];\n\t\t\t\t\tdelete inFlightRequestTimeouts.current[id];\n\t\t\t\t}, timeout); // 10 second timeout.\n\t\t\t\tsendJsonMessage({\n\t\t\t\t\tjsonrpc: '2.0',\n\t\t\t\t\tmethod,\n\t\t\t\t\tparams,\n\t\t\t\t\tid: id,\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t[isReady, sendJsonMessage],\n\t);\n\n\tconst subscribeToObject = useCallback(\n\t\tasync <TArgs extends [PrinterObjectKeys, ...PrinterObjectKeys[]]>(...args: TArgs) => {\n\t\t\tconst objects = Object.fromEntries(args.map((key) => [key, null])) as PrinterObjectsMoonrakerQueryParams;\n\t\t\tconst allSubscribedObjects = Object.assign(\n\t\t\t\t{},\n\t\t\t\tobjects,\n\t\t\t\t...Object.values(subscriptions).filter((v) => v != null),\n\t\t\t) as PrinterObjectsMoonrakerQueryParams;\n\t\t\tconst q = moonrakerQuery('printer.objects.subscribe' as 'printer.objects.query', {\n\t\t\t\tobjects: allSubscribedObjects,\n\t\t\t});\n\t\t\t// Capture request id we just generated;\n\t\t\tconst reqId = REQ_ID;\n\t\t\tsubscriptions[reqId] = objects;\n\t\t\tlocalSubscriptions.current.push(reqId);\n\n\t\t\tconst res = (await q).status as {\n\t\t\t\t[K in TArgs[number]]: PrinterObjectResult<K>;\n\t\t\t};\n\t\t\treturn {\n\t\t\t\tres,\n\t\t\t\tunsuscribe: async () => {\n\t\t\t\t\tlocalSubscriptions.current = localSubscriptions.current.filter((v) => v !== reqId);\n\t\t\t\t\tif (subscriptions[reqId] == null) {\n\t\t\t\t\t\tdelete subscriptions[reqId];\n\t\t\t\t\t\tconst allSubscribedObjects = Object.assign(\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t...Object.values(subscriptions).filter((v) => v != null),\n\t\t\t\t\t\t) as PrinterObjectsMoonrakerQueryParams;\n\t\t\t\t\t\tawait moonrakerQuery('printer.objects.subscribe' as 'printer.objects.query', {\n\t\t\t\t\t\t\tobjects: allSubscribedObjects,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\t[moonrakerQuery],\n\t);\n\n\tconst saveItem = useCallback<MoonrakerSaveItemFn>(\n\t\tasync <Data,>(namespace: MoonrakerNamespaces, key: unknown, value: unknown) => {\n\t\t\tawait isReady();\n\t\t\treturn (await moonrakerQuery('server.database.post_item', {\n\t\t\t\tnamespace: namespace,\n\t\t\t\tkey,\n\t\t\t\tvalue: value,\n\t\t\t})) as Data;\n\t\t},\n\t\t[moonrakerQuery, isReady],\n\t);\n\n\tconst getItem = useCallback<MoonrakerGetItemFn>(\n\t\tasync <Data,>(namespace: MoonrakerNamespaces, key: unknown): Promise<Data | null> => {\n\t\t\tawait isReady();\n\t\t\ttry {\n\t\t\t\tconst result = await moonrakerQuery('server.database.get_item', {\n\t\t\t\t\tnamespace: namespace,\n\t\t\t\t\tkey,\n\t\t\t\t});\n\t\t\t\treturn (result?.value ?? null) as Data;\n\t\t\t} catch (e) {\n\t\t\t\tgetLogger().warn(e);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t[moonrakerQuery, isReady],\n\t);\n\n\tuseEffect(() => {\n\t\tif (readyState === 1) {\n\t\t\t(async () => {\n\t\t\t\tawait migrateToLatest();\n\t\t\t\tonReadyCallbacks.current.forEach((cb) => cb.resolve());\n\t\t\t\tonReadyCallbacks.current = [];\n\t\t\t\tsetMoonrakerStatus('connected');\n\t\t\t})();\n\t\t} else {\n\t\t\tsetMoonrakerStatus('connecting');\n\t\t}\n\t}, [readyState]);\n\n\tuseEffect(() => {\n\t\tif (lastJsonMessage?.id && inFlightRequests.current[lastJsonMessage.id]) {\n\t\t\twindow.clearTimeout(inFlightRequestTimeouts.current[lastJsonMessage.id]);\n\t\t\tif ('error' in lastJsonMessage) {\n\t\t\t\tinFlightRequests.current[lastJsonMessage.id](new Error(lastJsonMessage.error.message), null);\n\t\t\t} else {\n\t\t\t\tinFlightRequests.current[lastJsonMessage.id](null, lastJsonMessage.result);\n\t\t\t}\n\t\t\tdelete inFlightRequestTimeouts.current[lastJsonMessage.id];\n\t\t\tdelete inFlightRequests.current[lastJsonMessage.id];\n\t\t}\n\t}, [lastJsonMessage]);\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tfor (const reqId in inFlightRequestTimeouts.current) {\n\t\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t\t\tdelete inFlightRequestTimeouts.current[reqId];\n\t\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t\t\tdelete inFlightRequests.current[reqId];\n\t\t\t}\n\t\t\tif (localSubscriptions.current.length > 0) {\n\t\t\t\tlocalSubscriptions.current.forEach((sub) => {\n\t\t\t\t\tdelete subscriptions[sub];\n\t\t\t\t});\n\t\t\t\tlocalSubscriptions.current = [];\n\t\t\t\tconst allSubscribedObjects = Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\t...Object.values(subscriptions).filter((v) => v != null),\n\t\t\t\t) as PrinterObjectsMoonrakerQueryParams;\n\t\t\t\tmoonrakerQuery('printer.objects.subscribe' as 'printer.objects.query', {\n\t\t\t\t\tobjects: Object.keys(allSubscribedObjects).length > 0 ? allSubscribedObjects : null,\n\t\t\t\t}).catch((e) => {\n\t\t\t\t\t// ignore\n\t\t\t\t});\n\t\t\t}\n\t\t\tonReadyCallbacks.current.forEach((cb) => cb.reject());\n\t\t\tonReadyCallbacks.current = [];\n\t\t};\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n\n\treturn {\n\t\tquery: moonrakerQuery,\n\t\tsaveItem,\n\t\tgetItem,\n\t\tsubscribeToObject,\n\t\tstatus: moonrakerStatus,\n\t\tlastMessage: lastJsonMessage,\n\t\tisReady: readyState === 1,\n\t};\n};\n\nexport const useNamespacedItemQuery = <\n\tN extends MoonrakerNamespaces,\n\tK extends MoonrakerNamespaceKeys<N>,\n\tV extends MoonrakerDBValue<N, K>,\n>(\n\tnamespace: N,\n\tkey: K,\n\toptions?: Omit<UseQueryOptions<V, unknown, V, N[]>, 'queryKey' | 'queryFn'>,\n) => {\n\tconst { getItem } = useMoonraker();\n\treturn useQuery({\n\t\t...options,\n\t\tqueryKey: [namespace, key],\n\t\tqueryFn: async () => {\n\t\t\treturn getItem(namespace, key) as Promise<V>;\n\t\t},\n\t});\n};\n\nexport const useMoonrakerQuery = <\n\tK extends MoonrakerQueryKeys = MoonrakerQueryKeys,\n\tP extends MoonrakerQueryParams<K> = MoonrakerQueryParams<K>,\n\tO extends Omit<\n\t\tUseQueryOptions<MoonrakerQueryResult<K>, unknown, MoonrakerQueryResult<K>, K[]>,\n\t\t'queryKey' | 'queryFn'\n\t> = Omit<UseQueryOptions<MoonrakerQueryResult<K>, unknown, MoonrakerQueryResult<K>, K[]>, 'queryKey' | 'queryFn'>,\n>(\n\t...args: P extends void ? [K, O?] : [K, P, O?]\n) => {\n\tconst { query } = useMoonraker();\n\tconst options = args.length === 3 ? (args[2] as O) : (args[1] as O);\n\tconst params = args.length === 3 ? args[1] : undefined;\n\tconst key = args[0];\n\tconst passed = (args.length === 3 ? [key, params] : [key]) as P extends void ? [K] : [K, P];\n\treturn useQuery({\n\t\t...(options ?? {}),\n\t\tqueryKey: [args[0]],\n\t\tqueryFn: async () => {\n\t\t\treturn query(...passed) as Promise<MoonrakerQueryResult<K>>;\n\t\t},\n\t});\n};\n\nexport const useMoonrakerMutation = <\n\tK extends MoonrakerMutationKeys = MoonrakerMutationKeys,\n\tP extends MoonrakerMutationParams<K> = MoonrakerMutationParams<K>,\n\tO extends Omit<UseMutationOptions<MoonrakerMutationResult<K>, unknown, P, K[]>, 'mutationKey' | 'mutationFn'> = Omit<\n\t\tUseMutationOptions<MoonrakerMutationResult<K>, unknown, P, K[]>,\n\t\t'mutationKey' | 'mutationFn'\n\t>,\n>(\n\t...args: [K, O?]\n) => {\n\tconst { query } = useMoonraker();\n\tconst options = args[1];\n\tconst key = args[0];\n\treturn useMutation({\n\t\t...options,\n\t\tmutationKey: [args[0]],\n\t\tmutationFn: async (params: P) => {\n\t\t\tconst passed = (params ? [key, params] : [key]) as P extends void ? [K] : [K, P];\n\t\t\treturn query(...passed) as Promise<MoonrakerMutationResult<K>>;\n\t\t},\n\t});\n};\n\nexport const usePrinterObjectQuery = <TArgs extends [PrinterObjectKeys, ...PrinterObjectKeys[]]>(...args: TArgs) => {\n\tconst { query } = useMoonraker();\n\treturn useQuery({\n\t\tqueryKey: args,\n\t\tqueryFn: async () => {\n\t\t\tconst objects = Object.fromEntries(args.map((key) => [key, null])) as PrinterObjectsMoonrakerQueryParams;\n\t\t\treturn (await query('printer.objects.query', { objects })).status as {\n\t\t\t\t[K in TArgs[number]]: PrinterObjectResult<K>;\n\t\t\t};\n\t\t},\n\t});\n};\n\nexport const usePrinterObjectSubscription = <\n\tTArgs extends [PrinterObjectKeys, ...PrinterObjectKeys[]],\n\tR extends object = { [K in TArgs[number]]: PrinterObjectResult<K> },\n>(\n\tselect: null | ((res: { [K in TArgs[number]]: PrinterObjectResult<K> }) => R),\n\t...args: TArgs\n) => {\n\tconst [state, setState] = useState<R | null>(null);\n\tconst stateRef = useRef(state);\n\tstateRef.current = state;\n\tconst selectRef = useRef(select);\n\tselectRef.current = select;\n\n\tconst _select = useCallback((res: { [K in TArgs[number]]: PrinterObjectResult<K> }) => {\n\t\tif (selectRef.current == null) {\n\t\t\treturn res as R;\n\t\t}\n\t\treturn selectRef.current?.(res);\n\t}, []);\n\n\tconst keys = useMemo(\n\t\t() => Object.fromEntries(args.map((key) => [key, null])) as PrinterObjectsMoonrakerQueryParams,\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t[JSON.stringify(args.sort())],\n\t);\n\n\tconst { subscribeToObject } = useMoonraker({\n\t\tonStatusUpdate: useCallback(\n\t\t\t(res: MoonrakerStatusUpdate) => {\n\t\t\t\tconst changed = {} as typeof res;\n\t\t\t\tfor (const key in keys) {\n\t\t\t\t\tif (res[key as keyof typeof res] != null) {\n\t\t\t\t\t\tchanged[key as keyof typeof res] = res[key as keyof typeof res];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst changeSelection = _select(changed);\n\t\t\t\tif (changeSelection == null || typeof changeSelection !== 'object') {\n\t\t\t\t\tthrow new Error('Invalid selection function, must return object, got ' + typeof changeSelection);\n\t\t\t\t}\n\t\t\t\tif (Object.keys(changed).length > 0 && deepEqual(changeSelection, stateRef.current) === false) {\n\t\t\t\t\tsetState((prev) => {\n\t\t\t\t\t\treturn merge(prev ?? {}, changeSelection) as R;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t[_select, keys],\n\t\t),\n\t});\n\n\tuseEffect(() => {\n\t\tconst subscription = subscribeToObject(...(Object.keys(keys) as TArgs));\n\t\tsubscription\n\t\t\t.then((sub) => {\n\t\t\t\tsetState(_select(sub.res));\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tif (e instanceof Error) {\n\t\t\t\t\tgetLogger().error(e);\n\t\t\t\t}\n\t\t\t});\n\t\treturn () => {\n\t\t\tsubscription\n\t\t\t\t.then((sub) => sub.unsuscribe())\n\t\t\t\t.catch((e) => {\n\t\t\t\t\tif (e instanceof Error) {\n\t\t\t\t\t\tgetLogger().error(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t};\n\t}, [_select, keys, subscribeToObject]);\n\n\treturn state;\n};\n\nexport const useNamespacedItemMutation = <\n\tN extends MoonrakerNamespaces,\n\tK extends MoonrakerNamespaceKeys<N>,\n\tV extends MoonrakerDBValue<N, K>,\n>(\n\tnamespace: N,\n\tkey: K,\n\toptions?: Omit<UseMutationOptions<MoonrakerDBItemResponse<V>, unknown, V>, 'mutationKey' | 'mutationFn'>,\n) => {\n\tconst { saveItem } = useMoonraker();\n\treturn useMutation<MoonrakerDBItemResponse<V>, unknown, V>({\n\t\t...options,\n\t\tmutationKey: [namespace, key],\n\t\tmutationFn: (value: V) => saveItem(namespace, key, value) as Promise<MoonrakerDBItemResponse<V>>,\n\t});\n};\n\nexport const useMoonrakerState = <\n\tN extends MoonrakerNamespaces,\n\tK extends MoonrakerNamespaceKeys<N>,\n\tV extends MoonrakerDBValue<N, K>,\n\tVal extends NonNullable<V> | null,\n>(\n\tnamespace: N,\n\tkey: K,\n\tinitialValue: Val = null as Val,\n) => {\n\tconst query = useNamespacedItemQuery(namespace, key, { initialData: initialValue });\n\tconst mutation = useNamespacedItemMutation<N, K, V>(namespace, key);\n\tconst mutate = useCallback(\n\t\tasync (value: V | ((prev: NonNullable<V> | Val) => NonNullable<V> | Val)) => {\n\t\t\tconst newValue =\n\t\t\t\ttypeof value === 'function' ? (value as (prev: NonNullable<V> | Val) => V)(query.data ?? initialValue) : value;\n\t\t\tawait mutation.mutateAsync(newValue, {\n\t\t\t\tonSuccess: () => {\n\t\t\t\t\t// Todo, implement optimistic updates\n\t\t\t\t\tquery.refetch();\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\t[initialValue, mutation, query],\n\t);\n\treturn [query.data ?? initialValue, mutate, query, mutation] as const;\n};\n","'use client';\nimport { createTRPCProxyClient, httpBatchLink } from '@trpc/client';\nimport { createTRPCNext } from '@trpc/next';\nimport type { AppRouter } from '@/server/routers/index';\nexport type {\n\tPrinterRouterLike,\n\tDropdownQuery,\n\tDropdownQueryKeys,\n\tDropdownQueryInput,\n\tDropdownQueryOutput,\n} from '@/server/routers/printer';\n\nexport function getBaseUrl() {\n\tif (typeof window !== 'undefined')\n\t\t// browser should use relative path\n\t\treturn '/configure';\n\tif (process.env.RENDER_INTERNAL_HOSTNAME)\n\t\t// reference for render.com\n\t\treturn `http://${process.env.RENDER_INTERNAL_HOSTNAME}:${process.env.PORT}/configure`;\n\t// assume localhost\n\treturn `http://127.0.0.1:${process.env.PORT ?? 3000}/configure`;\n}\nexport const trpc = createTRPCNext<AppRouter>({\n\tconfig() {\n\t\treturn {\n\t\t\tlinks: [\n\t\t\t\thttpBatchLink({\n\t\t\t\t\t/**\n\t\t\t\t\t * @link https://trpc.io/docs/ssr\n\t\t\t\t\t **/\n\t\t\t\t\turl: `${getBaseUrl()}/api/trpc`,\n\t\t\t\t\tmaxURLLength: 2083, // a suitable size\n\t\t\t\t}),\n\t\t\t],\n\t\t};\n\t},\n\toverrides: {\n\t\tuseMutation: {\n\t\t\t/**\n\t\t\t * This function is called whenever a `.useMutation` succeeds\n\t\t\t **/\n\t\t\tasync onSuccess(opts) {\n\t\t\t\t/**\n\t\t\t\t * @note that order here matters:\n\t\t\t\t * The order here allows route changes in `onSuccess` without\n\t\t\t\t * having a flash of content change whilst redirecting.\n\t\t\t\t **/\n\t\t\t\t// Calls the `onSuccess` defined in the `useQuery()`-options:\n\t\t\t\tawait opts.originalFn();\n\t\t\t\t// Invalidate all queries in the react-query cache:\n\t\t\t\tawait opts.queryClient.invalidateQueries();\n\t\t\t},\n\t\t},\n\t},\n\t/**\n\t * @link https://trpc.io/docs/ssr\n\t **/\n\tssr: false,\n});\nexport const proxyClient = createTRPCProxyClient<AppRouter>({\n\tlinks: [\n\t\thttpBatchLink({\n\t\t\t/**\n\t\t\t * @link https://trpc.io/docs/ssr\n\t\t\t **/\n\t\t\turl: `${getBaseUrl()}/api/trpc`,\n\t\t\tmaxURLLength: 2083, // a suitable size\n\t\t}),\n\t],\n});\n","import { z } from 'zod';\n\nexport const PinoLogLevel = z.enum(['trace', 'debug', 'info', 'warn', 'error', 'fatal']);\n\nexport const PinoLogEvent = z.object({\n\tts: z.number(),\n\tmessages: z.array(z.any()),\n\tbindings: z.array(z.record(z.string(), z.any())),\n\tlevel: z.object({\n\t\tlabel: PinoLogLevel,\n\t\tvalue: z.number(),\n\t}),\n});\n"],"names":["ChevronLeft","_createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__","Z","d","key","Minus","Promise","resolve","then","__webpack_require__","bind","send","level","logEvent","trpcClient","clientLog","mutate","PinoLogEvent","parse","logger","getLogger","pino","globalPinoOpts","browser","transmit","useDebounce","fn","delay","refreshTimeout","timeoutRef","useRef","argsRef","useEffect","current","clearTimeout","useCallback","args","undefined","setTimeout","JobCancelledError","Error","constructor","jobs","Map","_id","shaperDefaults","DEFAULT_DAMPING_RATIO","SHAPER_VIBRATION_REDUCTION","TEST_DAMPING_RATIOS","MAX_SHAPER_FREQ","WINDOW_T_SEC","MIN_FREQ","MAX_FREQ","TARGET_SMOOTHING","cancelJob","controller","get","id","signal","aborted","abort","delete","throwIfCancelled","getShaperSmoothing","shaper","accel","scv","halfAccel","A","T","invD","sumArray","n","length","ts","map","a","i","offset90","offset180","Math","max","sqrt","bisect","left","right","middle","findShaperMaxAccel","maxAccel","testAccel","estimateRemainingVibrations","testDampingRatio","freqBins","psd","vals","tidy","tensor1d","div","sum","omega","mul","PI","damping","omegaD","W","exp","outerProduct","sub","slice","size","S","sin","C","cos","stack","pow","res","vibrThreshold","remainingVibrations","allVibrations","array","range","start","stop","step","Array","from","value","index","fitShaper","jobId","shaperCfg","calibrationData","shaperFreqs","dampingRatio","maxSmoothing","testDampingRatios","maxFreq","onProgress","freqEnd","freqStart","min","minFreq","freqStep","slice1d","frequencies","freqBinsFiltered","findIndex","f","estimates","dispose","zeroArray","zeros","freqsOfInterest","all","initFunc","shaperVibrations","shaperVals","clone","dr","vibrations","oldShapervals","filter","Boolean","testFrequencies","progressMap","reportProgress","progress","set","totalProgress","values","postMessage","type","model","name","bestShaper","reverse","testFreq","shaperSmoothing","shaperScore","shaperValsArray","adaptedPsd","result","freq","vibrs","smoothing","score","color","reduce","selected","findBestShaper","shapers","INPUT_SHAPERS","setBackend","fittedShapers","forEach","s","total","fittedShaper","push","best","setWasmPaths","onmessage","e","command","data","abortController","AbortController","inputShaperCfg","shaperFreq","df","K","tD","a1","vTol","V2","X","a2","K2","SequenceDataChartType","animateYAxis","surface","sequenceData","yAxis","yAxes","getById","PSD_CHART_AXIS_AMPLITUDE_ID","autoRange","EAutoRange","Never","newMax","seq","visibleRange","animateVisibleRange","NumberRange","powerRange","growBy","easing","inOutCirc","setupChart","bandSeries","abs","rs","FastBandRenderableSeries","webAssemblyContext2D","dataSeries","XyyDataSeries","containsNaN","isSorted","xValues","yValues","y1Values","fill","shadableTWColors","fillY1","stroke","strokeY1","strokeThickness","yAxisId","rolloverModifierProps","tooltipColor","tooltipTitle","rolloverModifierProps1","animation","WaveAnimation","duration","ease","inOutQuad","renderableSeries","add","Series","FastLineRenderableSeries","FastMountainRenderableSeries","sequenceId","XyDataSeries","chartModifiers","RolloverModifier","showRolloverLine","showTooltip","CursorModifier","crosshairStroke","sky","crosshairStrokeThickness","showXLine","showYLine","tooltipLegendTemplate","getPSDTooltipLegendTemplate","tooltipLegendOffsetX","tooltipLegendOffsetY","axisLabelFill","zinc","axisLabelStroke","useBeltTensionState","sequencePair","setSequencePair","useState","peakPairingResults","setPeakPairingResults","mechanicalHealth","setMechanicalHealth","initBeltTensionChartAnnotations","peakPairingResult","seq1","seq2","pairedPeaks","pairs","unpairedPeaks1","unpairedPeaks2","yAnimOffset","annotations","flatMap","param","p1","p2","String","fromCharCode","x","y","amplitude","x2","y2","CustomAnnotation","xCoordinateMode","ECoordinateMode","DataValue","yCoordinateMode","x1","y1","opacity","verticalAnchorPoint","EVerticalAnchorPoint","Bottom","horizontalAnchorPoint","EHorizontalAnchorPoint","Center","svgString","concat","b","annotationAnimation1","GenericAnimation","to","outCubic","onAnimate","DoubleAnimator","interpolate","onCompleted","addAnimation","annotationAnimation2","p","Right","removeBeltTensionChartAnnotations","fromPairIndex","fromUnpairedIndex","promises","remove","j","updateBeltTensionChartAnnotations","foundPairs","foundUnpaired","useInputShapersState","setSequenceId","setShapers","recommendedShaper","setRecommendedShaper","initSeriesSubcomponents","originalSeries","asArray","find","axis","inOutCubic","fadeEffect","updateSeriesSubcomponents","newDs","addDeletable","enqueueAnimation","LineAnimation","useSeriesSubcomponentsChart","subcomponentSeries","setSubcomponentSeries","useInputShaperChart","enabled","currentInputShapers","currentRecommendedShaper","prevShapers","prevRecommendedShaper","initializeInputShapers","skip","toLocaleUpperCase","round","includes","strokeDashArray","PSD_CHART_AXIS_SHAPER_ID","showRollover","updateInputShapers","deepEqual","prevShaper","appendRange","count","isRunningAnimation","styles","warn","SciChartSurface","configure","wasmUrl","dataUrl","MacroRunChart","sequenceSeries","chart","props","isTransitioning","setIsTransitioning","isTransitioningRef","afterTransition","subComponentSeriesRef","prevSequenceData","transitionToChart","subcomponentData","nextSeq","prevCount","isXyyDataSeries","padFreq","padEstimates","unshift","runAnimation","BandAnimation","isXyDataSeries","MountainAnimation","prevNativeXValues","getNativeXValues","prevXValues","clear","jsx_runtime","jsx","SciChartReact","forwardProps","className","SkipBack","createLucideIcon","points","SkipForward","_extends","Object","assign","target","arguments","source","prototype","hasOwnProperty","call","apply","reservedModifierKeywords","mappedKeys","esc","ShiftLeft","ShiftRight","AltLeft","AltRight","MetaLeft","MetaRight","OSLeft","OSRight","ControlLeft","ControlRight","mapKey","trim","toLowerCase","replace","parseKeysHookInput","keys","splitKey","split","parseHotkey","hotkey","combinationKey","description","toLocaleLowerCase","k","modifiers","alt","ctrl","shift","meta","mod","singleCharKeys","document","addEventListener","pushToCurrentlyPressedKeys","code","removeFromCurrentlyPressedKeys","window","currentlyPressedKeys","Set","isReadonlyArray","isArray","hotkeyArray","has","isHotkeyEnabledOnTag","_ref","enabledOnTags","targetTagName","tagName","some","tag","isHotkeyMatchingKeyboardEvent","ignoreModifiers","pressedKeyUppercase","ctrlKey","metaKey","shiftKey","altKey","keyCode","pressedKey","every","BoundHotkeysProxyProvider","react","createContext","HotkeysContext","hotkeys","enabledScopes","toggleScope","enableScope","disableScope","stopPropagation","preventDefault","stopImmediatePropagation","useSafeLayoutEffect","useLayoutEffect","useHotkeys","callback","options","dependencies","ref","hasTriggeredRef","_options","_keys","join","_deps","memoisedCB","cbRef","memoisedOptions","isEqual","_useHotkeysContext","useContext","proxy","scopes","activeScopes","console","scope","listener","isKeyUp","_e$target","isKeyboardEventTriggeredByInput","enableOnFormTags","rootNode","getRootNode","Document","ShadowRoot","activeElement","contains","isContentEditable","enableOnContentEditable","_hotkey$keys","ignoreEventWhen","handleKeyDown","event","keydown","keyup","handleKeyUp","domNode","addHotkey","removeEventListener","removeHotkey","Slot","forwardRef","forwardedRef","children","slotProps","childrenArray","Children","toArray","slottable","isSlottable","newElement","newChildren","child","only","isValidElement","SlotClone","cloneElement","displayName","getter","mayWarn","childrenRef","getOwnPropertyDescriptor","element","isReactWarning","mergeProps","childProps","overrideProps","propName","slotPropValue","childPropValue","isHandler","test","composeRefs","refs","node","Slottable","Fragment","Primitive","NODES","primitive","Node","asChild","primitiveProps","Comp","Symbol","for","PROGRESS_NAME","createProgressContext","createProgressScope","createContextScope","scopeName","createContextScopeDeps","defaultContexts","createScope","scopeContexts","defaultContext","contexts","useMemo","rootComponentName","BaseContext","Provider","context","Context","consumerName","composeContextScopes","baseScope","scopeHooks","useScope","createScope2","overrideScopes","nextScopes","nextScopes2","scopeProps","currentScope","ProgressProvider","useProgressContext","Progress","propValue","__scopeProgress","valueProp","maxProp","getValueLabel","defaultGetValueLabel","progressProps","isValidMaxNumber","error","isValidValueNumber","valueLabel","isNumber","role","getProgressState","INDICATOR_NAME","ProgressIndicator","indicatorProps","maxValue","isNaN","React","cn","style","transform","setDisplayName","ProgressPrimitive","_jobId","InputShapers","recordings","currentRunId","isLoadingShapers","setIsLoadingShapers","shaperEstimationProgress","setShaperEstimationProgress","shaperWorker","currentJobId","isWorkerReady","setIsWorkerReady","recording","r","Worker","tu","URL","u","performance","mark","measure","info","prevShaperTime","shaperMeasure","startTime","end","newShaper","prev","terminate","jsxs","AnimatedContainer","containerClassName","Table","TableHeader","TableRow","TableHead","TableBody","twJoin","TableCell","strokeWidth","strokeDasharray","strokeLinecap","toFixed","sup","Spinner","noMargin","detectPeaks","detectionThreshold","seriesColor","movingAverage","XyMovingAverageFilter","avgValues","getNativeYValues","peaks","freqPerStep","vicinitySteps","ceil","vicinity","isFinite","peakIndex","next","highestPeakIndex","_","indexOf","pairPeaks","peaks1","peaks2","distances","sort","medianDistance","calculatePercentile","iqr","threshold","minDistance","pair","distance","splice","padSignal","targetLength","BeltTensionComparison","initializedSurfaceId","surfaceId","setSurfaceId","prevPairingResult","updateSurfaceId","onInitialize","isInitialized","newPeakPairingResults","newMechanicalHealth","computeMechanicalHealth","signal1","signal2","maxLength","signal1Estimates","signal2Estimates","similarityFactor","pearsonCorrelation","numUnpairedPeaks","unpairedPeaks","numPairedPeaks","combinedUnpairedPeaks","psdHighestMax","mhi","DC_MAX_PEAKS","unpairedPeakPenalty","peak","label","mechanicalHealthLookupTable","mechanicalHealthIndicator","CardTitle","CardDescription","luxon","defaultLocale","userLocale","local","locale","MacroRun","runId","currentRun","setCurrentRun","macro","trpc","analysis","findMacro","useSuspenseQuery","getRunRecordings","macroId","keepPreviousData","inputShapersState","seriesSubcomponents","beltTensionState","previous","getNextAndPreviousRunRecordingIds","date","fromMillis","startTimeStamp","endTimeStamp","equals","toFormat","human","setLocale","toLocaleString","dateStyle","timeStyle","shiftTo","toHuman","unitDisplay","maximumSignificantDigits","title","sequence","sequences","rec","Mountain","chartInit","useChart","PSDChartNoSeriesDefinition","series","newPair","useTopMenu","Menu","MenubarMenu","MenubarTrigger","span","onClick","history","back","MenubarIcon","Icon","MenubarContent","disabled","Card","CardHeader","arr","meanArray","meanX","meanY","numerator","denominatorX","denominatorY","dx","dy","denominator","percentile","lower","floor","upper","height","setHeight","heightRef","isOverflowVisible","setIsOverflowVisible","isOverflowVisibleRef","containerRef","useResizeObserver","entry","contentRect","onComplete","onStart","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","motion","twMerge","onAnimationComplete","onAnimationStart","animate","transition","badgeColorOptions","z","union","literal","badgeTextColorStyle","cva","variants","rose","red","yellow","orange","green","lime","blue","indigo","purple","pink","brand","gray","plain","badgeBackgroundColorStyle","badgeBorderColorStyle","badgeStyle","sm","md","lg","defaultVariants","Badge","bannerStyle","Banner","aria-hidden","h3","buttonVariants","variant","danger","warning","primary","success","indeterminate","outline","true","default","icon","compoundVariants","class","Button","href","rel","dropdownItems","buttonClasses","Link","as","ChevronDownIcon","Transition","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","Items","Item","active","item","button","svg","xmlns","viewBox","circle","cx","cy","CardContent","CardFooter","Dialog","DialogPrimitive","DialogTrigger","DialogPortal","DialogOverlay","DialogContent","noClose","Cross2Icon","DialogHeader","DialogTitle","DialogDescription","table","thead","tbody","TableFooter","tfoot","tr","th","td","TableCaption","caption","timestamp","getHost","process","location","hostname","formatBytes","bytes","decimals","log","parseFloat","sizes","migrations","version","up","fetch","ok","json","message","entries","parsed","JSON","method","headers","body","stringify","namespace","encodeURIComponent","down","encoded","migratedValue","getCurrentVersion","setCurrentVersion","isMigrating","migrate","migrationsToRun","m","migration","isMigrated","migrateToLatest","currentVersion","latestVersion","REQ_ID","getWsURL","host","subscriptions","useMoonraker","inFlightRequests","inFlightRequestTimeouts","localSubscriptions","onReadyCallbacks","wsUrl","setWsUrl","containsSubscriptionUpdate","jsonMessage","params","objects","lastJsonMessage","sendJsonMessage","readyState","useWebSocket","moonrakerStatus","passThroughUpdateMethods","messageData","onMessage","onStatusUpdate","shouldReconnect","reconnectAttempts","Infinity","reconnectInterval","share","readyStateRef","setMoonrakerStatus","whenReady","reject","isReady","moonrakerQuery","err","timeout","jsonrpc","subscribeToObject","fromEntries","allSubscribedObjects","v","q","reqId","status","unsuscribe","saveItem","getItem","cb","catch","query","lastMessage","useNamespacedItemQuery","useQuery","queryKey","queryFn","useMoonrakerQuery","passed","useMoonrakerMutation","useMutation","mutationKey","mutationFn","usePrinterObjectQuery","usePrinterObjectSubscription","select","state","setState","stateRef","selectRef","_select","changed","changeSelection","merge","subscription","useNamespacedItemMutation","useMoonrakerState","initialValue","initialData","mutation","newValue","mutateAsync","onSuccess","refetch","getBaseUrl","createTRPCNext","config","links","httpBatchLink","url","maxURLLength","overrides","opts","originalFn","queryClient","invalidateQueries","ssr","proxyClient","createTRPCProxyClient","PinoLogLevel","enum","object","number","messages","any","bindings","record","string"],"sourceRoot":""}