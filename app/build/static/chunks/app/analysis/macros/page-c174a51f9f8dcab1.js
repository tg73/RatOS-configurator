(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5757],{21734:function(e,r,s){"use strict";s.d(r,{Z:function(){return n}});var a=s(24360);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},16803:function(e,r,s){Promise.resolve().then(s.bind(s,19399)),Promise.resolve().then(s.bind(s,56445))},19399:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return AnalysisMacrosTable}});var a=s(72612),n=s(23071),l=s(79978),o=s(90077),t=s(94809),i=s(64827),c=s(82157),d=s.n(c),u=s(79293),h=s(63562),m=s(39164),x=s(94787),p=s(98948);function DataTableRowActions(e){let{row:r,onUpdate:s}=e,[n,l]=(0,m.useState)(!1),c=u.SX.analysis.deleteMacro.useMutation();return(0,a.jsxs)("div",{className:"flex justify-end",children:[(0,a.jsxs)(i.h_,{children:[(0,a.jsx)(i.$F,{asChild:!0,children:(0,a.jsxs)(t.z,{variant:"plain",size:"sm",className:"flex data-[state=open]:bg-muted",children:[(0,a.jsx)(o.AjK,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,a.jsxs)(i.AW,{align:"end",className:"w-[160px]",children:[(0,a.jsx)(i.Xi,{asChild:!0,children:(0,a.jsx)(d(),{href:"/analysis/macros/".concat(r.original.id,"/recordings"),children:"View Recordings"})}),(0,a.jsx)(i.Xi,{asChild:!0,children:(0,a.jsx)(d(),{href:"/analysis/macros/".concat(r.original.id,"/edit"),children:"Edit"})}),(0,a.jsx)(i.VD,{}),(0,a.jsx)(i.Xi,{onClick:()=>l(!0),children:"Delete"})]})]}),(0,a.jsx)(h.aR,{open:n,children:(0,a.jsxs)(h._T,{children:[(0,a.jsxs)(h.fY,{children:[(0,a.jsx)(h.f$,{children:"Are you sure?"}),(0,a.jsx)(h.yT,{children:"This action cannot be undone. This will permanently delete this macro and all associated recordings."})]}),(0,a.jsxs)(h.xo,{children:[(0,a.jsx)(h.le,{onClick:()=>l(!1),children:"Cancel"}),(0,a.jsx)(h.OL,{variant:"danger",onClick:async()=>{l(!1);try{let e=await c.mutateAsync(r.original.id);if(null==e.result){(0,p.j)().error(r.original.id,"Failed to delete macro"),x.A.error("Failed to delete macro",{description:"An unknown error occurred and the macro seem to have disappeared from the database. This shouldn't happen. Please contact support."});return}x.A.success("Macro deleted!",{description:"The macro and ".concat(e.totalRecordingsRemoved," recording(s) were successfully deleted.")})}catch(e){(0,p.j)().error({id:r.original.id,error:e},"Failed to delete macro"),x.A.error("Failed to delete macro",{description:'\n											<div>\n												<p>An error occurred while delete the macro.</p>\n												<pre class="text-wrap mt-4 text-rose-400 font-medium whitespace-pre-wrap">'.concat(e instanceof Error?e.message:e instanceof String?e:"Unknown error","</pre>\n											</div>\n										")})}null==s||s()},children:"Continue"})]})]})})]})}var f=s(39634),g=s(16195),j=s(65523),v=s(8058),y=s(31517),b=s(21734);function MacroBulkActions(e){let{selection:r,onUpdate:s}=e,[n,l]=(0,m.useState)(!1),c=u.SX.analysis.deleteMacros.useMutation();return(0,a.jsxs)("div",{className:"flex justify-end",children:[(0,a.jsxs)(i.h_,{children:[(0,a.jsx)(i.$F,{asChild:!0,children:(0,a.jsxs)(t.z,{variant:"plain",size:"sm",className:"flex data-[state=open]:bg-muted",children:[(0,a.jsx)(o.AjK,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,a.jsx)(i.AW,{align:"end",className:"w-[160px]",children:(0,a.jsxs)(i.Xi,{onClick:()=>l(!0),disabled:0===r.rows.length,children:["Delete ",r.rows.length>0?r.rows.length:""," ",1===r.rows.length?"Macro":"Macros"]})})]}),(0,a.jsx)(h.aR,{open:n,children:(0,a.jsxs)(h._T,{children:[(0,a.jsxs)(h.fY,{children:[(0,a.jsx)(h.f$,{children:"Are you sure?"}),(0,a.jsx)(h.yT,{children:"This action cannot be undone. This will permanently delete the selected macros and all associated recordings."})]}),(0,a.jsxs)(h.xo,{children:[(0,a.jsx)(h.le,{onClick:()=>l(!1),children:"Cancel"}),(0,a.jsx)(h.OL,{variant:"danger",onClick:async()=>{l(!1);try{let e=await c.mutateAsync(r.rows.map(e=>e.original.id)),s=e.result.filter(e=>!e.success);s.length>0&&((0,p.j)().error(s,"Failed to delete one or more macros"),x.A.error("Failed to delete one or more macros",{description:"An unknown error occurred and some of the macros you marked for deletion seem to have disappeared from the database. This shouldn't happen. Please contact support."})),x.A.success("Macros deleted!",{description:"".concat(e.macrosRemoved," out of ").concat(e.result.length," macro(s) and ").concat(e.result.reduce((e,r)=>e+r.totalRecordingsRemoved,0)," recording(s) were successfully deleted.")})}catch(e){(0,p.j)().error({ids:r.rows.map(e=>e.original.id),error:e},"Failed to delete macros"),x.A.error("Failed to delete macros",{description:'\n											<div>\n												<p>An error occurred while deleting the macros.</p>\n												<pre class="text-wrap mt-4 text-rose-400 font-medium whitespace-pre-wrap">'.concat(e instanceof Error?e.message:e instanceof String?e:"Unknown error","</pre>\n											</div>\n										")})}null==s||s()},children:"Continue"})]})]})})]})}var w=s(26105);let k=[{id:"select",size:30,minSize:30,header:e=>{let{table:r}=e;return(0,a.jsx)(n.X,{checked:r.getIsAllPageRowsSelected()||r.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>r.toggleAllPageRowsSelected(!!e),"aria-label":"Select all"})},cell:e=>{let{row:r}=e;return(0,a.jsx)(n.X,{checked:r.getIsSelected(),onCheckedChange:e=>r.toggleSelected(!!e),"aria-label":"Select row"})},enableSorting:!1,enableHiding:!1},{id:"accelerometers",accessorKey:"sequences",size:200,header:e=>{let{column:r}=e;return(0,a.jsx)(l.p,{column:r,title:"Accelerometers"})},cell:e=>{let{row:r}=e,s=[];return r.original.sequences.map(e=>{var r;switch(null===(r=e.recording)||void 0===r?void 0:r.accelerometer){case"controlboard":s.push({label:"Control Board",color:"purple",icon:g.Z});break;case"rpi":s.push({label:"Host",color:"gray",icon:j.Z});break;case"toolboard_t0":s.push({label:"Tool Board T0",color:"sky",icon:v.Z});break;case"toolboard_t1":s.push({label:"Tool Board T1",color:"pink",icon:v.Z});break;case"beacon":s.push({label:"Beacon",color:"green",icon:v.Z})}}),s=s.filter((e,r,s)=>s.findIndex(r=>r.label===e.label)===r),(0,a.jsx)("div",{children:s.map(e=>(0,a.jsx)(f.Ct,{color:e.color,children:e.label},e.label))})},getUniqueValues:e=>e.sequences.map(e=>{var r;return null===(r=e.recording)||void 0===r?void 0:r.accelerometer}).filter((e,r,s)=>s.findIndex(r=>r===e)===r),getFacetedOptions:()=>[{label:"Control Board",value:"controlboard",icon:g.Z},{label:"Host",value:"rpi",icon:j.Z},{label:"Tool Board T0",value:"toolboard_t0",icon:v.Z},{label:"Tool Board T1",value:"toolboard_t1",icon:v.Z},{label:"Beacon",value:"beacon",icon:y.Z}],filterFn:(e,r,s)=>{let a=e.original.sequences.map(e=>{var r;return null===(r=e.recording)||void 0===r?void 0:r.accelerometer});return(Array.isArray(s)?s:[s]).some(e=>a.includes(e))}},{accessorKey:"name",size:1e3,header:e=>{let{column:r}=e;return(0,a.jsx)(l.p,{column:r,title:"Name"})},cell:e=>{let{row:r}=e;return(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)(d(),{href:"/analysis/macros/".concat(r.original.id,"/recordings"),className:"truncate font-medium hover:text-brand-400",children:r.getValue("name")})})},getUniqueValues:e=>[e.name],filterFn:(e,r,s)=>(Array.isArray(s)?s:[s]).some(r=>e.original.name.includes(r))},{accessorKey:"sequences",size:100,header:e=>{let{column:r}=e;return(0,a.jsx)(l.p,{column:r,title:"Sequences"})},cell:e=>{let{row:r}=e,s=r.original.sequences.filter(e=>{var r;return!(null===(r=e.recording)||void 0===r?void 0:r.capturePSD)}).length,n=r.original.sequences.filter(e=>{var r;return null===(r=e.recording)||void 0===r?void 0:r.capturePSD}).length;return(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[s>0&&(0,a.jsxs)(w.u,{children:[(0,a.jsx)(w.aJ,{children:(0,a.jsxs)(f.Ct,{className:"flex gap-1.5",color:"gray",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 text-foreground"})," ",s]})}),(0,a.jsxs)(w._v,{className:"max-w-48 whitespace-normal text-wrap",children:["There ",s>1?"are":"is"," ",s," unrecorded sequence",s>1?"s":""," in this macro."]})]}),n>0&&(0,a.jsxs)(w.u,{children:[(0,a.jsx)(w.aJ,{children:(0,a.jsxs)(f.Ct,{className:"flex gap-1.5",color:"gray",children:[(0,a.jsx)(o.jXb,{className:"h-4 w-4 scale-[250%] text-rose-400"})," ",n]})}),(0,a.jsxs)(w._v,{className:"max-w-48 whitespace-normal text-wrap",children:["There ",n>1?"are":"is"," ",n," recorded sequence",n>1?"s":""," ","in this macro."]})]})]})}},{id:"actions",size:16,minSize:16,maxSize:16,header:e=>{let{table:r}=e;return(0,a.jsx)(MacroBulkActions,{selection:r.getSelectedRowModel()})},cell:e=>{let{row:r}=e;return(0,a.jsx)(DataTableRowActions,{row:r})}}];var N=s(58486),A=s(10187),C=s(74755),T=s(24360);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let S=(0,T.Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var M=s(58818);function AnalysisMacrosTable(){var e,r;let s=A.S.analysis.getMacros.useQuery({});return(0,M.Ty)("Analysis",(0,m.useCallback)(e=>(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(e.MenubarMenu,{children:[(0,a.jsx)(e.MenubarTrigger,{className:"cursor-pointer",asChild:!0,children:(0,a.jsxs)(d(),{href:"/analysis",children:[(0,a.jsx)(e.MenubarIcon,{Icon:C.Z}),(0,a.jsx)("span",{className:"hidden lg:inline",children:"Back"})]})}),(0,a.jsx)(e.MenubarContent,{className:"hidden"})]})}),[])),(0,a.jsxs)("div",{className:"flex h-full flex-1 flex-col space-y-8 p-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Resonance analysis macros"}),(0,a.jsx)("p",{className:"text-base font-medium text-muted-foreground",children:"Here's a list of your macro's ready for analysis!"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)(t.z,{href:"/analysis/macros/new",variant:"primary",children:[(0,a.jsx)(S,{className:"size-4"}),(0,a.jsx)("span",{children:"New Macro"})]})})]}),(0,a.jsx)(N.w,{data:null!==(r=null===(e=s.data)||void 0===e?void 0:e.result)&&void 0!==r?r:[],columns:k})]})}},26105:function(e,r,s){"use strict";s.d(r,{_v:function(){return d},aJ:function(){return c},pn:function(){return t},u:function(){return i}});var a=s(72612),n=s(39164),l=s(2029),o=s(64929);let t=l.zt,i=l.fC,c=l.xz,d=n.forwardRef((e,r)=>{let{className:s,sideOffset:n=4,...t}=e;return(0,a.jsx)(l.VY,{ref:r,sideOffset:n,className:(0,o.cn)("z-50 overflow-hidden rounded-md border-border bg-background px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})});(0,o.h)(d,l.VY.displayName)}},function(e){e.O(0,[6545,9996,966,8965,5360,3790,453,2705,9754,3150,5591,6645,1778,1563,8367,7433,907,9146,2029,2842,4595,7652,6375,8888,3942,9321,8458,1744],function(){return e(e.s=16803)}),_N_E=e.O()}]);
//# sourceMappingURL=page-c174a51f9f8dcab1.js.map