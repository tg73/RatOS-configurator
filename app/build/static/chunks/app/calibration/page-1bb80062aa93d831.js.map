{"version":3,"file":"static/chunks/app/calibration/page-1bb80062aa93d831.js","mappings":"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","sources":["webpack://_N_E/?c556","webpack://_N_E/./app/_hooks/toolhead.ts","webpack://_N_E/./app/_hooks/webrtc.ts","webpack://_N_E/./app/calibration/vaoc-settings-dialog.tsx","webpack://_N_E/./app/calibration/helpers.ts","webpack://_N_E/./app/_hooks/resize.ts","webpack://_N_E/./app/calibration/hooks.ts","webpack://_N_E/./components/common/icons/exposure.tsx","webpack://_N_E/./app/calibration/focus-controls.tsx","webpack://_N_E/./components/common/toolbar.tsx","webpack://_N_E/./components/forms/slider.tsx","webpack://_N_E/./app/calibration/stream-settings-dialog.tsx","webpack://_N_E/./app/calibration/icons.tsx","webpack://_N_E/./app/calibration/toolbars.tsx","webpack://_N_E/./app/calibration/safety-visualization.tsx","webpack://_N_E/./app/calibration/framing.tsx","webpack://_N_E/./app/calibration/crosshair.tsx","webpack://_N_E/./app/calibration/vaoc.tsx","webpack://_N_E/./app/calibration/page.tsx","webpack://_N_E/./components/common/full-load-screen.tsx","webpack://_N_E/./components/ui/drawer.tsx","webpack://_N_E/./hooks/useMediaQuery.tsx","webpack://_N_E/./components/common/modal.tsx","webpack://_N_E/./components/common/no-ssr.tsx","webpack://_N_E/./components/common/scroll-container.tsx","webpack://_N_E/./components/forms/text-input.tsx","webpack://_N_E/./components/forms/toggle.tsx","webpack://_N_E/./components/ui/button.tsx","webpack://_N_E/./components/ui/input.tsx","webpack://_N_E/./components/warning-message.tsx","webpack://_N_E/./helpers/utils.ts","webpack://_N_E/./hooks/isClient.tsx","webpack://_N_E/./hooks/useChangeEffect.tsx","webpack://_N_E/<anon>"],"sourcesContent":["import(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/app/calibration/page.tsx\")","import { useCallback } from 'react';\nimport { useMoonrakerMutation } from '@/moonraker/hooks';\n\nexport const useGcodeCommand = () => {\n\tconst executeGcode = useMoonrakerMutation('printer.gcode.script');\n\n\treturn useCallback(async (command: TemplateStringsArray, ...args: (number | string)[]) => {\n\t\tconst result = [command[0]];\n\t\targs.forEach((arg, i) => {\n\t\t\tresult.push(arg.toString(), command[i + 1]);\n\t\t});\n\t\tconst gcode = result.join('') as GCode;\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.log(gcode);\n\t\tconst gcodeRes = await executeGcode.mutateAsync({ script: gcode });\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.log(gcodeRes);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { getLogger } from '@/app/_helpers/logger';\n\ninterface WebRTCConfig {\n\ticeServers?: RTCIceServer[];\n\tsdpSemantics: 'unified-plan';\n}\n\nexport function useWebRTC(url: string, onStreamStats?: (stats: RTCInboundRtpStreamStats) => void) {\n\tconst videoElRef = useRef<HTMLVideoElement>(null);\n\tconst audioElRef = useRef<HTMLVideoElement>(null);\n\tconst peerConnection = useRef<RTCPeerConnection | null>(null);\n\tconst urlRef = useRef<string>(url);\n\tconst isConnecting = useRef<boolean>(false);\n\tconst [connectionState, setConnectionState] = useState<RTCPeerConnectionState | null>(null);\n\tconst remotePCId = useRef<string | null>(null);\n\n\tconst onIceCandidate = useCallback((e: RTCPeerConnectionIceEvent) => {\n\t\tif (e.candidate) {\n\t\t\treturn fetch(urlRef.current, {\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\ttype: 'remote_candidate',\n\t\t\t\t\tid: remotePCId.current,\n\t\t\t\t\tcandidates: [e.candidate],\n\t\t\t\t}),\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t},\n\t\t\t\tmethod: 'POST',\n\t\t\t}).catch(function (error) {\n\t\t\t\twindow.console.error(error);\n\t\t\t});\n\t\t}\n\t}, []);\n\n\tconst connect = useCallback(async () => {\n\t\tif (peerConnection.current) {\n\t\t\tpeerConnection.current.close();\n\t\t\tpeerConnection.current = null;\n\t\t}\n\t\tisConnecting.current = true;\n\t\ttry {\n\t\t\tsetConnectionState('new');\n\t\t\tvar config: WebRTCConfig = {\n\t\t\t\tsdpSemantics: 'unified-plan',\n\t\t\t};\n\n\t\t\tif (document.getElementById('use-stun') && (document.getElementById('use-stun') as any).checked) {\n\t\t\t\tconfig.iceServers = [{ urls: ['stun:stun.l.google.com:19302'] }];\n\t\t\t}\n\n\t\t\tconst urlSearchParams = new URLSearchParams(url);\n\t\t\tconst params = Object.fromEntries(urlSearchParams.entries());\n\n\t\t\tconst response = await fetch(url, {\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\ttype: 'request',\n\t\t\t\t\tres: params.res,\n\t\t\t\t}),\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t},\n\t\t\t\tmethod: 'POST',\n\t\t\t});\n\t\t\tif (response.ok) {\n\t\t\t\tconst parsedResponse = (await response.json()) as {\n\t\t\t\t\tid: string;\n\t\t\t\t\tsdp: string;\n\t\t\t\t\ttype: RTCSdpType;\n\t\t\t\t\ticeServers?: RTCIceServer[];\n\t\t\t\t};\n\t\t\t\tif (parsedResponse.iceServers) {\n\t\t\t\t\tconfig.iceServers = parsedResponse.iceServers;\n\t\t\t\t}\n\t\t\t\tpeerConnection.current = new RTCPeerConnection(config);\n\t\t\t\tpeerConnection.current.addTransceiver('video', { direction: 'recvonly' });\n\t\t\t\t//peerConnection.current.addTransceiver('audio', {direction: 'recvonly'});\n\t\t\t\tpeerConnection.current.addEventListener('track', function (evt) {\n\t\t\t\t\tif (evt.track.kind == 'video') {\n\t\t\t\t\t\tif (videoElRef.current) {\n\t\t\t\t\t\t\tvideoElRef.current.srcObject = evt.streams[0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new Error('No video ref to set src on');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (audioElRef.current) audioElRef.current.srcObject = evt.streams[0];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpeerConnection.current.addEventListener('connectionstatechange', () => {\n\t\t\t\t\tconst conState = peerConnection.current?.connectionState;\n\t\t\t\t\tsetConnectionState(conState ?? null);\n\t\t\t\t});\n\n\t\t\t\tremotePCId.current = parsedResponse.id;\n\t\t\t\tawait peerConnection.current.setRemoteDescription(parsedResponse);\n\t\t\t\tconst answer = await peerConnection.current.createAnswer();\n\t\t\t\tawait peerConnection.current.setLocalDescription(answer);\n\t\t\t\tawait new Promise(function (resolve) {\n\t\t\t\t\tif (peerConnection.current == null) {\n\t\t\t\t\t\tthrow new Error('peerConnection.current is null');\n\t\t\t\t\t}\n\t\t\t\t\tif (peerConnection.current.iceGatheringState === 'complete') {\n\t\t\t\t\t\tresolve(null);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfunction checkState() {\n\t\t\t\t\t\t\tif (peerConnection.current == null) {\n\t\t\t\t\t\t\t\tthrow new Error('peerConnection.current is null');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (peerConnection.current.iceGatheringState === 'complete') {\n\t\t\t\t\t\t\t\tpeerConnection.current.removeEventListener('icegatheringstatechange', checkState);\n\t\t\t\t\t\t\t\tresolve(null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpeerConnection.current.addEventListener('icegatheringstatechange', checkState);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpeerConnection.current.addEventListener('icecandidate', onIceCandidate);\n\t\t\t\tvar offer = peerConnection.current.localDescription;\n\n\t\t\t\tif (offer == null) {\n\t\t\t\t\tthrow new Error('No offer from peerConnection');\n\t\t\t\t}\n\n\t\t\t\tawait fetch(url, {\n\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\ttype: offer.type,\n\t\t\t\t\t\tid: remotePCId.current,\n\t\t\t\t\t\tsdp: offer.sdp,\n\t\t\t\t\t}),\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t},\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsetConnectionState('failed');\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tgetLogger().error(e, \"Couldn't connect to WebRTC\");\n\t\t\tsetConnectionState('failed');\n\t\t} finally {\n\t\t\tisConnecting.current = false;\n\t\t}\n\t}, [onIceCandidate, url]);\n\n\t// Get stream stats\n\tuseEffect(() => {\n\t\tif (onStreamStats) {\n\t\t\tconst interval = setInterval(async () => {\n\t\t\t\tif (peerConnection.current) {\n\t\t\t\t\tconst stats = await peerConnection.current.getStats();\n\t\t\t\t\tstats.forEach((report) => {\n\t\t\t\t\t\tif (report.type === 'inbound-rtp' && report.kind === 'video') {\n\t\t\t\t\t\t\tconst data = report as RTCInboundRtpStreamStats;\n\t\t\t\t\t\t\tonStreamStats?.(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t\treturn () => clearInterval(interval);\n\t\t}\n\t}, [onStreamStats]);\n\n\tuseEffect(() => {\n\t\tif (url && isConnecting.current === false) {\n\t\t\tconnect();\n\t\t} else if (peerConnection.current && isConnecting.current === false) {\n\t\t\tpeerConnection.current.close();\n\t\t}\n\t}, [connect, url]);\n\n\tuseEffect(() => {\n\t\tif (['failed', 'disconnected'].includes(connectionState ?? '')) {\n\t\t\tconst reconnectTimeout = setTimeout(() => {\n\t\t\t\tconnect();\n\t\t\t}, 5000);\n\t\t\treturn () => clearTimeout(reconnectTimeout);\n\t\t}\n\t}, [connect, connectionState]);\n\n\treturn {\n\t\tvideoRef: videoElRef,\n\t\taudioRef: audioElRef,\n\t\tconnectionState,\n\t\tclose: useCallback(() => {\n\t\t\tpeerConnection.current?.close();\n\t\t}, []),\n\t};\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { TextInput } from '@/components/forms/text-input';\nimport { Toggle } from '@/components/forms/toggle';\nimport { useMoonrakerState } from '@/moonraker/hooks';\nimport { useDebounce } from '@/app/_hooks/debounce';\nimport { twMerge } from 'tailwind-merge';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { ScrollContainer } from '@/components/common/scroll-container';\n\nexport const initialCameraSettings = {\n\tpixelPrMm: 160,\n\touterNozzleDiameter: 1,\n\tflipVertical: false,\n\tflipHorizontal: false,\n};\n\nexport type VaocSettings = typeof initialCameraSettings;\n\ntype CameraSettingsProps = {\n\tclassName?: string;\n\tisVisible?: boolean;\n\tsettings: VaocSettings;\n\tsetSettings: (updater: VaocSettings | ((prev: VaocSettings) => VaocSettings)) => Promise<void>;\n\tisSettingsFetched: boolean;\n\ttoggle: (visible: boolean) => void;\n};\n\nexport const VaocSettingsDialog: React.FC<CameraSettingsProps> = (props) => {\n\tconst { settings, setSettings, isSettingsFetched } = props;\n\tconst hasLoaded = useRef(false);\n\tconst [pixelPrMm, setPixelPrMm] = useState<string | null>(isSettingsFetched ? settings.pixelPrMm.toFixed(2) : null);\n\tconst [outerNozzleDiameter, setOuterNozzleDiameter] = useState<string | null>(\n\t\tisSettingsFetched ? settings.outerNozzleDiameter.toFixed(2) : null,\n\t);\n\tconst debouncedSettings = useDebounce(setSettings, 200);\n\n\tuseEffect(() => {\n\t\tif (isSettingsFetched && hasLoaded.current === false) {\n\t\t\tsetPixelPrMm(settings?.pixelPrMm.toFixed(2) ?? initialCameraSettings.pixelPrMm.toFixed(2));\n\t\t\tsetOuterNozzleDiameter(\n\t\t\t\tsettings?.outerNozzleDiameter.toFixed(2) ?? initialCameraSettings.outerNozzleDiameter.toFixed(2),\n\t\t\t);\n\t\t\thasLoaded.current = true;\n\t\t}\n\t}, [settings, isSettingsFetched]);\n\n\tconst onChangePixelPrMm = (value: string) => {\n\t\tconst parsed = parseFloat(value);\n\t\tsetPixelPrMm(value);\n\t\tif (isNaN(parsed)) {\n\t\t\treturn;\n\t\t}\n\t\tdebouncedSettings((s) => ({ ...(s ?? {}), pixelPrMm: parsed }));\n\t};\n\n\tconst onChangeOuterNozzleDiameter = (value: string) => {\n\t\tconst parsed = parseFloat(value);\n\t\tsetOuterNozzleDiameter(value);\n\t\tif (isNaN(parsed)) {\n\t\t\treturn;\n\t\t}\n\t\tdebouncedSettings((s) => ({ ...(s ?? {}), outerNozzleDiameter: parsed }));\n\t};\n\n\treturn (\n\t\t<ScrollContainer\n\t\t\tclassName={twMerge(\n\t\t\t\t'absolute left-5 top-1/2 max-h-[50%] w-80 -translate-y-1/2 scale-100 overflow-y-auto rounded-md border-y border-r border-zinc-800 bg-zinc-100 p-5 shadow-lg transition-all dark:bg-zinc-900/70',\n\t\t\t\tprops.isVisible ? 'translate-x-0 opacity-100' : 'pointer-events-none -translate-x-8 opacity-0',\n\t\t\t\tprops.className,\n\t\t\t)}\n\t\t\tonWheel={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t}}\n\t\t>\n\t\t\t<h3 className=\"flex flex-1 items-center justify-between text-base font-medium leading-7 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t<span>Camera Settings</span>\n\t\t\t\t<XMarkIcon className=\"h-5 w-5 cursor-pointer\" onClick={() => props.toggle(!props.isVisible)} />\n\t\t\t</h3>\n\t\t\t<div className=\"mt-4 grid grid-cols-1 gap-4 border-t border-zinc-100 pt-4 dark:border-zinc-800\">\n\t\t\t\t<TextInput\n\t\t\t\t\tlabel=\"Pixel per mm\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tvalue={pixelPrMm ?? ''}\n\t\t\t\t\tplaceholder={isSettingsFetched ? undefined : 'Loading...'}\n\t\t\t\t\tonChange={onChangePixelPrMm}\n\t\t\t\t\terror={isNaN(parseFloat(pixelPrMm ?? '')) ? 'Not a valid number' : undefined}\n\t\t\t\t/>\n\t\t\t\t<TextInput\n\t\t\t\t\tlabel=\"Outer Nozzle Diameter\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tstep={0.1}\n\t\t\t\t\tvalue={outerNozzleDiameter ?? ''}\n\t\t\t\t\tplaceholder={isSettingsFetched ? undefined : 'Loading...'}\n\t\t\t\t\tonChange={onChangeOuterNozzleDiameter}\n\t\t\t\t\terror={isNaN(parseFloat(outerNozzleDiameter ?? '')) ? 'Not a valid number' : undefined}\n\t\t\t\t/>\n\t\t\t\t<Toggle\n\t\t\t\t\tlabel=\"Flip vertical\"\n\t\t\t\t\tonChange={(value) => setSettings({ ...(settings ?? initialCameraSettings), flipVertical: value ?? false })}\n\t\t\t\t\tdescription=\"Whether to flip the camera vertically\"\n\t\t\t\t\tvalue={settings?.flipVertical ?? initialCameraSettings.flipVertical}\n\t\t\t\t/>\n\t\t\t\t<Toggle\n\t\t\t\t\tlabel=\"Flip horizontal\"\n\t\t\t\t\tonChange={(value) => setSettings({ ...(settings ?? initialCameraSettings), flipHorizontal: value ?? false })}\n\t\t\t\t\tdescription=\"Whether to flip the camera horizontally\"\n\t\t\t\t\tvalue={settings?.flipHorizontal ?? initialCameraSettings.flipHorizontal}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</ScrollContainer>\n\t);\n};\n","export type CameraOption = {\n\tkey: string;\n\tvalue?: number | boolean;\n} & ({ min: number; max: number; float?: boolean } | { toggle?: true });\n\nexport const parseOptions = (options: string) => {\n\tconst ints = options.matchAll(/- available option:\\s(\\w+)\\s.+(\\[-?\\d+\\.\\.\\d+\\])/g);\n\tlet result: CameraOption[] = [];\n\tfor (const match of ints) {\n\t\tconst [min, max] = match[2]\n\t\t\t.slice(1, -1)\n\t\t\t.split('..')\n\t\t\t.map((n) => parseInt(n, 10));\n\t\tconst existing = result.find((o) => o.key === match[1]);\n\t\tif (existing && 'max' in existing && existing.max && existing.max <= max) {\n\t\t\tcontinue;\n\t\t}\n\t\tresult.push({\n\t\t\tkey: match[1],\n\t\t\tmin,\n\t\t\tmax: ['redbalance', 'bluebalance', 'greenbalance'].includes(match[1]) ? 2000 : max,\n\t\t});\n\t}\n\tconst floats = options.matchAll(/- available option:\\s(\\w+)\\s.+(\\[-?\\d+\\.\\d+\\.\\.\\d+\\.\\d+\\])/g);\n\tfor (const match of floats) {\n\t\tconst [min, max] = match[2]\n\t\t\t.slice(1, -1)\n\t\t\t.split('..')\n\t\t\t.map((n) => parseFloat(n));\n\t\tconst existing = result.find((o) => o.key === match[1]);\n\t\tif (existing && 'max' in existing && existing.max && existing.max <= max) {\n\t\t\tcontinue;\n\t\t}\n\t\tresult.push({\n\t\t\tkey: match[1],\n\t\t\tfloat: true,\n\t\t\tmin,\n\t\t\tmax: ['redbalance', 'bluebalance', 'greenbalance'].includes(match[1]) ? 2000 : max,\n\t\t});\n\t}\n\tconst bools = options.matchAll(/- available option:\\s(\\w+)\\s.+(\\[false\\.\\.true\\])/g);\n\tfor (const match of bools) {\n\t\tresult.push({\n\t\t\tkey: match[1],\n\t\t\ttoggle: true,\n\t\t});\n\t}\n\treturn result;\n};\n","import { useEffect, useState } from 'react';\n\nexport const useWindowSize = () => {\n\tconst [windowSize, setWindowSize] = useState({\n\t\twidth: typeof window === 'undefined' ? 0 : window.innerWidth,\n\t\theight: typeof window === 'undefined' ? 0 : window.innerHeight,\n\t});\n\n\tuseEffect(() => {\n\t\tconst handleResize = () => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tsetWindowSize({\n\t\t\t\t\twidth: typeof window === 'undefined' ? 0 : window.innerWidth,\n\t\t\t\t\theight: typeof window === 'undefined' ? 0 : window.innerHeight,\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\twindow.addEventListener('resize', handleResize);\n\t\treturn () => window.removeEventListener('resize', handleResize);\n\t}, []);\n\n\treturn windowSize;\n};\n","'use client';\nimport React, { useState, useCallback, useEffect, useRef, useMemo } from 'react';\nimport useLocalStorage from 'react-use-localstorage';\nimport { CameraOption, parseOptions } from '@/app/calibration/helpers';\nimport {\n\tuseMoonrakerQuery,\n\tuseMoonrakerState,\n\tusePrinterObjectQuery,\n\tusePrinterObjectSubscription,\n} from '@/moonraker/hooks';\nimport { merge } from 'ts-deepmerge';\nimport { getHost } from '@/helpers/util';\nimport { useCallbackRef } from 'use-callback-ref';\nimport { MoonrakerDB } from '@/moonraker/types';\nimport { useWindowSize } from '@/app/_hooks/resize';\nimport { useChangeEffect, useDelayedChangeEffect } from '@/hooks/useChangeEffect';\nimport { useGesture } from '@use-gesture/react';\nimport { useGcodeCommand } from '@/app/_hooks/toolhead';\nimport { VaocSettings } from '@/app/calibration/vaoc-settings-dialog';\nimport useResizeObserver from '@react-hook/resize-observer';\nimport screenfull from 'screenfull';\nimport { getLogger } from '@/app/_helpers/logger';\n\nconst getCameraUrl = () => {\n\tconst host = getHost();\n\tif (host == null || host.trim() == '') {\n\t\treturn '/webcam';\n\t}\n\treturn `http://${host}/webcam`;\n};\n\nexport const useUIState = () => {\n\tif (typeof window === 'undefined') {\n\t\tthrow new Error(\"Can't use useUIState on the server\");\n\t}\n\t// Container and frame sizing\n\tconst [containerAspectRatio, setContainerAspectRatio] = useState<number>(0.1);\n\tconst windowSize = useWindowSize();\n\tconst containerRef = useCallbackRef<HTMLDivElement | null>(null, (newRef, oldRef) => {\n\t\tif (newRef != null) {\n\t\t\tsetContainerAspectRatio(newRef.getBoundingClientRect().width / newRef.getBoundingClientRect().height);\n\t\t}\n\t});\n\tconst rootRef = useRef<HTMLDivElement | null>(null);\n\n\tuseResizeObserver(containerRef, (entry) => {\n\t\tsetContainerAspectRatio(entry.contentRect.width / entry.contentRect.height);\n\t});\n\n\tuseEffect(() => {\n\t\tif (containerRef.current != null) {\n\t\t\tsetContainerAspectRatio(\n\t\t\t\tcontainerRef.current?.getBoundingClientRect().width / containerRef.current?.getBoundingClientRect().height ??\n\t\t\t\t\twindowSize.width / windowSize.height,\n\t\t\t);\n\t\t}\n\t}, [windowSize, containerRef]);\n\n\tconst [isFullscreened, setIsFullscreened] = useState(false);\n\n\tconst toggleFullscreen = useCallback(\n\t\tasync (value?: boolean) => {\n\t\t\tif (screenfull.isEnabled && rootRef.current) {\n\t\t\t\tif (value != null) {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tawait screenfull.request(rootRef.current);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tawait screenfull.exit();\n\t\t\t\t\t}\n\t\t\t\t\tsetIsFullscreened(value);\n\t\t\t\t}\n\t\t\t\tif (screenfull.isFullscreen || value === false) {\n\t\t\t\t\tawait screenfull.exit();\n\t\t\t\t\tsetIsFullscreened(false);\n\t\t\t\t}\n\t\t\t\tif (!screenfull.isFullscreen || value === true) {\n\t\t\t\t\tawait screenfull.request(rootRef.current);\n\t\t\t\t\tsetIsFullscreened(true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[rootRef],\n\t);\n\n\tuseEffect(() => {\n\t\tif (screenfull.isEnabled) {\n\t\t\tconst onChange = () => {\n\t\t\t\tsetIsFullscreened(screenfull.isFullscreen);\n\t\t\t};\n\t\t\tscreenfull.on('change', onChange);\n\t\t\treturn () => {\n\t\t\t\tscreenfull.off('change', onChange);\n\t\t\t};\n\t\t}\n\t}, []);\n\n\t// UI toggles\n\tconst [canMove, setCanMove] = useState(true);\n\tconst [isLockingCoordinates, setIsLockingCoordinates] = useState(false);\n\tconst [_zoom, _setZoom] = useLocalStorage('VAOC_UI_STATE_ZOOM', '1.00');\n\tconst zoomRef = useRef(parseFloat(_zoom));\n\tzoomRef.current = parseFloat(_zoom);\n\tconst zoom = parseFloat(_zoom);\n\tconst setZoom = useCallback(\n\t\t(updater: (prev: number) => number) => {\n\t\t\tconst newZoom = updater(zoomRef.current);\n\t\t\tzoomRef.current = newZoom;\n\t\t\t_setZoom(newZoom.toFixed(2));\n\t\t},\n\t\t[_setZoom],\n\t);\n\treturn {\n\t\tcontainerAspectRatio,\n\t\tsetContainerAspectRatio,\n\t\tcanMove,\n\t\tsetCanMove,\n\t\trootRef,\n\t\tisLockingCoordinates,\n\t\tsetIsLockingCoordinates,\n\t\tzoom,\n\t\tsetZoom,\n\t\tcontainerRef,\n\t\twindowSize,\n\t\tisFullscreened,\n\t\ttoggleFullscreen,\n\t};\n};\n\ntype SpatialMappingProps = {\n\tvideoRef: React.RefObject<HTMLVideoElement>;\n\tcontainerRef: React.RefObject<HTMLDivElement>;\n\tzoom: number;\n\twindowSize: { width: number; height: number };\n\tsettings: VaocSettings;\n};\n\nexport const useSpatialMapping = (props: SpatialMappingProps) => {\n\tconst { videoRef, containerRef, zoom, windowSize, settings } = props;\n\tconst [containerSize, setContainerSize] = useState<[number, number]>([0, 0]);\n\tconst scale = useCallback(\n\t\t(val: number) => {\n\t\t\tconst vidWidth = videoRef.current?.videoWidth ?? 1;\n\t\t\tconst frameWidth = containerSize[0];\n\t\t\tconst videoScale = frameWidth > 0 && vidWidth > 0 ? frameWidth / vidWidth : 1;\n\t\t\treturn val * zoom * videoScale;\n\t\t},\n\t\t[videoRef, containerSize, zoom],\n\t);\n\n\tconst invert = useCallback(\n\t\t(val: number) => {\n\t\t\tconst vidWidth = videoRef.current?.videoWidth ?? 1;\n\t\t\tconst frameWidth = containerSize[0];\n\t\t\tconst videoScale = frameWidth > 0 && vidWidth > 0 ? frameWidth / vidWidth : 1;\n\t\t\treturn val / zoom / videoScale;\n\t\t},\n\t\t[containerSize, videoRef, zoom],\n\t);\n\n\tconst toScreen = useCallback(\n\t\t(val: number) => {\n\t\t\t(() => windowSize)(); // Mark used so we still get linting.\n\t\t\treturn scale(val) * (settings?.pixelPrMm ?? 0);\n\t\t},\n\t\t[scale, settings?.pixelPrMm, windowSize],\n\t);\n\n\tconst toMillimeters = useCallback(\n\t\t(val: number) => {\n\t\t\treturn invert(val) / (settings?.pixelPrMm ?? 0);\n\t\t},\n\t\t[invert, settings?.pixelPrMm],\n\t);\n\n\tuseResizeObserver(containerRef, (entry) => {\n\t\tif (entry.contentRect.width > 0 && entry.contentRect.height > 0) {\n\t\t\tsetContainerSize([entry.contentRect.width, entry.contentRect.height]);\n\t\t} else {\n\t\t\tconst rect = containerRef.current?.getBoundingClientRect();\n\t\t\tif (rect) {\n\t\t\t\tsetContainerSize([rect?.width, rect?.height]);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn {\n\t\ttoScreen,\n\t\ttoMillimeters,\n\t\tcontainerSize,\n\t};\n};\n\nexport const usePrinterState = () => {};\n\ntype GesturesProps = {\n\tgestureRef: React.RefObject<HTMLElement>;\n\tzoom: number;\n\tsetZoom: ReactCallback<(updater: (prev: number) => number) => void>;\n\tisConnected: boolean;\n\tcanMove: boolean;\n\ttoScreen: (val: number) => number;\n\ttoMillimeters: (val: number) => number;\n};\n\nexport const useGestures = (props: GesturesProps) => {\n\tconst { gestureRef, setZoom, isConnected, canMove, toScreen, toMillimeters, zoom } = props;\n\tconst [dragOffset, setDragOffset] = useState<[number, number] | null>(null);\n\tconst [dragOutside, setDragOutside] = useState<{ x: false | number; y: false | number }>({ x: false, y: false });\n\tconst G = useGcodeCommand();\n\n\tuseGesture(\n\t\t{\n\t\t\tonDrag: (state) => {\n\t\t\t\tif (state.dragging) {\n\t\t\t\t\tsetDragOffset([state.offset[0], state.offset[1]]);\n\t\t\t\t\tsetDragOutside({ x: state._movementBound[0], y: state._movementBound[1] });\n\t\t\t\t} else {\n\t\t\t\t\tconst x = toMillimeters(dragOffset?.[0] ?? 0);\n\t\t\t\t\tconst y = toMillimeters(dragOffset?.[1] ?? 0) * -1;\n\t\t\t\t\tG`_VAOC_MOVE X=${x} Y=${y}`;\n\t\t\t\t\tsetDragOffset(null);\n\t\t\t\t\tsetDragOutside({ x: false, y: false });\n\t\t\t\t}\n\t\t\t},\n\t\t\tonPinch: (state) => {\n\t\t\t\tsetZoom((z) => Math.max(Math.min(z * state.offset[0], 10), 1));\n\t\t\t},\n\t\t\tonWheel: (state) => {\n\t\t\t\tif (state.delta[1] == 0 || state.wheeling == false || state.intentional == false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (state.delta[1] < 0) {\n\t\t\t\t\tsetZoom((z) => Math.max(z * 0.85, 1));\n\t\t\t\t} else {\n\t\t\t\t\tsetZoom((z) => Math.min(z * 1.15, 10));\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttarget: gestureRef,\n\t\t\tenabled: isConnected,\n\t\t\tdrag: {\n\t\t\t\tenabled: canMove,\n\t\t\t\tfrom: () => [0, 0],\n\t\t\t\tbounds: {\n\t\t\t\t\tleft: -toScreen(1),\n\t\t\t\t\tright: toScreen(1),\n\t\t\t\t\ttop: -toScreen(1),\n\t\t\t\t\tbottom: toScreen(1),\n\t\t\t\t},\n\t\t\t\trubberband: true,\n\t\t\t},\n\t\t\twheel: { axis: 'y', rubberband: false },\n\t\t\tpinch: {\n\t\t\t\tscaleBounds: { min: 1, max: 10 },\n\t\t\t\tpinchOnWheel: false,\n\t\t\t\trubberband: true,\n\t\t\t},\n\t\t},\n\t);\n\n\treturn {\n\t\tscaledDragOffset: {\n\t\t\tx: dragOffset == null ? 0 : dragOffset[0] / zoom,\n\t\t\ty: dragOffset == null ? 0 : dragOffset[1] / zoom,\n\t\t},\n\t\tdragOffset: {\n\t\t\tx: dragOffset == null ? 0 : dragOffset[0],\n\t\t\ty: dragOffset == null ? 0 : dragOffset[1],\n\t\t},\n\t\tisDragging: dragOffset != null,\n\t\tdragOutside,\n\t};\n};\n\nexport type CrossHairStateProps = {\n\tisLockingCoordinates: boolean;\n\tsnapshotDuration?: number;\n\tsettings: VaocSettings;\n\tisConnected: boolean;\n\ttoScreen: (val: number) => number;\n\tcontainerSize: [number, number];\n};\nconst SNAPSHOT_DURATION = 200;\n\nexport const useCrossHairState = (props: CrossHairStateProps) => {\n\tconst { toScreen, settings, containerSize } = props;\n\tconst SnapshotEffectDuration = props.snapshotDuration ?? SNAPSHOT_DURATION;\n\tconst configFile = usePrinterObjectQuery('configfile');\n\tconst t0 = usePrinterObjectSubscription((res) => {\n\t\treturn { active: res['gcode_macro T0'].active };\n\t}, 'gcode_macro T0');\n\tconst t1 = usePrinterObjectSubscription((res) => {\n\t\treturn { active: res['gcode_macro T1'].active };\n\t}, 'gcode_macro T1');\n\tconst tool = t0?.active ? 0 : t1?.active ? 1 : 0;\n\tconst [isLockingCoordinates] = useChangeEffect([props.isLockingCoordinates], SnapshotEffectDuration, true);\n\tconst [delayedIsLockingCoordinates] = useDelayedChangeEffect(\n\t\t[props.isLockingCoordinates],\n\t\tSnapshotEffectDuration - 10,\n\t\t10,\n\t\ttrue,\n\t);\n\tconst nozzleDiameter = (configFile.data?.configfile.settings[tool === 0 ? 'extruder' : 'extruder1'] as any)\n\t\t?.nozzle_diameter;\n\tconst nozzleRadius = useMemo(() => toScreen((nozzleDiameter ?? 0.4) / 2), [nozzleDiameter, toScreen]);\n\tconst { outerNozzleDiameter } = settings;\n\tconst canRender = props.isConnected && outerNozzleDiameter != null && nozzleDiameter != null;\n\tconst outerNozzleRadius = useMemo(\n\t\t() => (isLockingCoordinates ? nozzleRadius : toScreen(outerNozzleDiameter ? outerNozzleDiameter / 2 : 1)),\n\t\t[toScreen, isLockingCoordinates, nozzleRadius, outerNozzleDiameter],\n\t);\n\tconst outerNozzleRadiusPercentWidth = useMemo(\n\t\t() => (!props.isConnected ? 0 : (outerNozzleRadius / containerSize[0]) * 100),\n\t\t[props.isConnected, outerNozzleRadius, containerSize],\n\t);\n\tconst outerNozzleRadiusPercentHeight = useMemo(\n\t\t() => (!props.isConnected ? 0 : (outerNozzleRadius / containerSize[1]) * 100),\n\t\t[props.isConnected, outerNozzleRadius, containerSize],\n\t);\n\tconst crosshairStrokeWidth = useMemo(() => toScreen(0.01), [toScreen]);\n\n\treturn {\n\t\tcanRender,\n\t\tnozzleRadius: isNaN(nozzleRadius) ? 0 : nozzleRadius,\n\t\touterNozzleRadius: isNaN(outerNozzleRadius) ? 0 : outerNozzleRadius,\n\t\touterNozzleRadiusPercentWidth: isNaN(outerNozzleRadiusPercentWidth) ? 0 : outerNozzleRadiusPercentWidth,\n\t\touterNozzleRadiusPercentHeight: isNaN(outerNozzleRadiusPercentHeight) ? 0 : outerNozzleRadiusPercentHeight,\n\t\tcrosshairStrokeWidth: isNaN(crosshairStrokeWidth) ? 0 : crosshairStrokeWidth,\n\t\tdelayedIsLockingCoordinates,\n\t};\n};\n\nexport const useVideoState = () => {\n\t// Video state\n\tconst [url, setUrl] = useState(getCameraUrl());\n\tuseEffect(() => {\n\t\tif (url !== getCameraUrl()) setUrl(getCameraUrl());\n\t}, [url]);\n\tconst [fps, setFps] = useState<number | null>(null);\n\tconst [aspectRatio, setAspectRatio] = useState<number | null>(null);\n\tconst onStreamStats = useCallback((stats: RTCInboundRtpStreamStats) => {\n\t\tif (stats.framesPerSecond) {\n\t\t\tsetFps(stats.framesPerSecond);\n\t\t}\n\t\tif (stats.frameHeight && stats.frameWidth) {\n\t\t\tsetAspectRatio(stats.frameWidth / stats.frameHeight);\n\t\t}\n\t}, []);\n\n\treturn {\n\t\turl,\n\t\tsetUrl,\n\t\tfps,\n\t\taspectRatio,\n\t\tonStreamStats,\n\t};\n};\n\ntype VaocSettingsProps = {\n\turl: string;\n\tisConnected?: boolean;\n};\n\nexport const useVaocSettings = ({ url, isConnected }: VaocSettingsProps) => {\n\t// Camera state\n\tconst [settings, saveSettings] = useMoonrakerState('RatOS', 'camera-settings');\n\treturn { settings, saveSettings };\n};\n\ntype StreamSettingsProps = {\n\turl: string;\n\tisConnected?: boolean;\n\tsettings: MoonrakerDB['RatOS']['camera-stream-settings'] | null;\n\tsaveSettings: (settings: MoonrakerDB['RatOS']['camera-stream-settings']) => Promise<void>;\n\tisInitialLoading: boolean;\n\tisFetched: boolean;\n};\n\nexport const useStreamSettings = ({\n\turl,\n\tisConnected,\n\tsettings,\n\tsaveSettings,\n\tisInitialLoading,\n\tisFetched,\n}: StreamSettingsProps) => {\n\tconst [options, setOptions] = useState<CameraOption[]>([]);\n\tconst settingsRef = useRef(settings);\n\tsettingsRef.current = settings;\n\n\tconst mergedOptions = useMemo(() => {\n\t\treturn options.map((opt) => {\n\t\t\topt.value = settingsRef.current?.[opt.key]?.value ?? opt.value;\n\t\t\tif ('max' in opt && opt.key === 'ExposureTime') {\n\t\t\t\t// Limit exposure time to max 1/15th of a second.\n\t\t\t\topt.min = 0;\n\t\t\t\topt.max = 60000;\n\t\t\t}\n\t\t\treturn opt;\n\t\t});\n\t}, [options]);\n\n\t// 👍, return options with values from `settings` when available else whatever default.\n\t// todo, update settings keys when options change (delete old ones, add new ones).\n\n\tconst compression = useCallback(\n\t\tasync (val: NumbersBefore<101>) => {\n\t\t\tconst res = await fetch(`${url}/option?compressionquality=${val}`);\n\t\t\tsetOptions(parseOptions(await res.text()));\n\t\t},\n\t\t[url],\n\t);\n\n\tconst setOption = useCallback(\n\t\tasync (key: string, value: number | boolean) => {\n\t\t\tconst opt = options.find((o) => o.key === key);\n\t\t\tif (opt == null) {\n\t\t\t\tthrow new Error(`Invalid option ${key}`);\n\t\t\t}\n\t\t\tif (opt && 'toggle' in opt && typeof value !== 'boolean') {\n\t\t\t\tthrow new Error(`Expect a boolean value for ${key}, got ${value}`);\n\t\t\t}\n\t\t\tif (opt && 'max' in opt && (typeof value !== 'number' || opt.min > value || opt.max < value)) {\n\t\t\t\tthrow new Error(`Value ${value} is out of range for ${key}`);\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tconst intVal = typeof value === 'boolean' ? (value ? 1 : 0) : value;\n\t\t\t\tconst res = await fetch(`${url}/option?${key}=${intVal.toString()}`);\n\t\t\t\tif (res.ok && isInitialLoading === false) {\n\t\t\t\t\tgetLogger().info(\n\t\t\t\t\t\t'saving',\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tsettingsRef.current,\n\t\t\t\t\t\tmerge(settingsRef.current ?? {}, { [key]: { value } }),\n\t\t\t\t\t);\n\t\t\t\t\tawait saveSettings(merge(settingsRef.current ?? {}, { [key]: { value } }));\n\t\t\t\t}\n\t\t\t\treturn res.ok;\n\t\t\t} catch (e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t[options, url, isInitialLoading, saveSettings],\n\t);\n\n\tuseEffect(() => {\n\t\tif (isConnected) {\n\t\t\tcompression(100);\n\t\t}\n\t\tif (isConnected && isFetched && settingsRef.current != null) {\n\t\t\tfor (const opt in settingsRef.current) {\n\t\t\t\tconst val = settingsRef.current[opt]?.value;\n\n\t\t\t\tconst intVal = typeof val === 'boolean' ? (val ? 1 : 0) : val;\n\t\t\t\tif (intVal != null) {\n\t\t\t\t\tfetch(`${url}/option?${opt}=${intVal.toString()}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [isFetched, url, isConnected, compression]);\n\n\treturn {\n\t\toptions: mergedOptions,\n\t\tsetOption,\n\t};\n};\n","import React from 'react';\n\nexport const ExposureIcon = (props: { className?: string }) => (\n\t<svg viewBox=\"0 0 512 512\" xmlns=\"http://www.w3.org/2000/svg\" className={props.className}>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M456,40H56A16,16,0,0,0,40,56V456a16,16,0,0,0,16,16H456a16,16,0,0,0,16-16V56A16,16,0,0,0,456,40ZM72,72H417.373L72,417.373ZM440,440H94.627L440,94.627Z\"\n\t\t/>\n\t\t<polygon\n\t\t\tfill=\"currentColor\"\n\t\t\tpoints=\"336 368 336 408 368 408 368 368 408 368 408 336 368 336 368 296 336 296 336 336 296 336 296 368 336 368\"\n\t\t/>\n\t\t<rect width=\"112\" height=\"32\" x=\"112\" y=\"136\" fill=\"currentColor\" />\n\t</svg>\n);\n","import React from 'react';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport {\n\tChevronDoubleDownIcon,\n\tChevronDoubleUpIcon,\n\tChevronDownIcon,\n\tChevronUpIcon,\n} from '@heroicons/react/24/outline';\nimport { useGcodeCommand } from '@/app/_hooks/toolhead';\nimport { usePrinterObjectSubscription } from '@/moonraker/hooks';\nimport { ChevronDown, ChevronUp, ChevronsDown, ChevronsUp, MoveVertical } from 'lucide-react';\n\nexport const initialCameraSettings = {\n\tpixelPrMm: 160,\n\touterNozzleDiameter: 1,\n\tflipVertical: false,\n\tflipHorizontal: false,\n};\n\nexport type CameraSettings = typeof initialCameraSettings;\n\ntype CameraSettingsProps = {\n\tclassName?: string;\n\tisVisible?: boolean;\n\ttoggle: (visible: boolean) => void;\n};\n\nexport const FocusControls: React.FC<CameraSettingsProps> = (props) => {\n\tconst G = useGcodeCommand();\n\tconst livePosition = usePrinterObjectSubscription((res) => {\n\t\treturn {\n\t\t\tz: res.motion_report.live_position?.[2],\n\t\t};\n\t}, 'motion_report');\n\treturn (\n\t\t<div\n\t\t\tclassName={twMerge(\n\t\t\t\t'scroll absolute left-0 right-0 transform-gpu overflow-y-auto rounded-md border-y border-r border-zinc-800 bg-zinc-100 font-mono shadow-lg transition-all dark:bg-zinc-900/70',\n\t\t\t\tprops.isVisible ? ' -translate-y-full opacity-100' : 'pointer-events-none  -translate-y-[95%]  opacity-0',\n\t\t\t\tprops.className,\n\t\t\t)}\n\t\t\tonWheel={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t}}\n\t\t>\n\t\t\t<ol className=\"flex flex-col divide-y divide-zinc-200 dark:divide-zinc-800\">\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z1`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"relative inline h-5 w-5 flex-shrink-0\">\n\t\t\t\t\t\t\t\t<ChevronsUp className=\"absolute top-0.5 h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t<ChevronsUp className=\"absolute -top-1 h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span className=\"inline\">+1.00</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z0.5`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronsUp className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">+0.50</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z0.1`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronUp className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">+0.10</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z0.05`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronUp className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">+0.05</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z0.01`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronUp className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">+0.01</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 cursor-default items-center justify-center space-x-2 whitespace-nowrap bg-brand-500 px-5 py-3 text-sm font-medium text-zinc-900',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"inline h-5 w-5 flex-shrink-0 font-sans text-base font-semibold leading-[18px]\">Z</span>{' '}\n\t\t\t\t\t\t\t<span className=\"inline\">\n\t\t\t\t\t\t\t\t{(livePosition?.z ?? 0) >= 0 && '+'}\n\t\t\t\t\t\t\t\t{livePosition?.z?.toFixed(2) ?? '??'}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z-0.01`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronDown className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">-0.01</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z-0.05`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronDown className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">-0.05</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z-0.1`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronDown className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">-0.10</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z-0.5`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ChevronsDown className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t<span className=\"inline\">-0.50</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li className={twJoin('flex')}>\n\t\t\t\t\t<div className={twJoin('flex flex-1 items-center justify-center text-center')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => G`G91\\nG0 Z-1.0`}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t\t'flex flex-1 items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"relative inline h-5 w-5 flex-shrink-0\">\n\t\t\t\t\t\t\t\t<ChevronsDown className=\"absolute bottom-0.5 h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t<ChevronsDown className=\"absolute -bottom-1 h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span className=\"inline\">-1.00</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t</ol>\n\t\t</div>\n\t);\n};\n","import { useAutoAnimate } from '@formkit/auto-animate/react';\nimport React, { useCallback } from 'react';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport { Spinner } from '@/components/common/spinner';\nimport { useDebounce } from '@/app/_hooks/debounce';\nimport { LucideProps } from 'lucide-react';\n\ntype Icon = React.FC<LucideProps>;\n\nexport type ToolbarButton = {\n\tid: string;\n\ttitle: string;\n\tisLoading?: boolean;\n\ticon?: Icon;\n\tname?: NonNullable<React.ReactNode>;\n\tclassName?: string;\n\tonClick: (() => void) | (() => Promise<void>);\n\tsubButtonPosition?: 'before' | 'after';\n\tchildren?: React.ReactNode;\n\thidden?: boolean;\n\tisActive: boolean;\n} & ({ name: string } | { icon: Icon });\n\nexport type ToolbarButtonWithParent = ToolbarButton & { parent: string };\n\ntype ToolbarProps = {\n\tclassName?: string;\n\tbuttons: ToolbarButton[];\n\tsubButtons?: (ToolbarButton & { parent: string })[];\n};\n\nconst animationOptions = { duration: 150 };\n\nconst Button = (button: React.PropsWithChildren<ToolbarButton>) => {\n\tconst [animateRef] = useAutoAnimate();\n\tconst [isLoading, setIsLoading] = React.useState(false);\n\tconst _setIsLoading = useDebounce(setIsLoading, 200);\n\tconst _onClick = useCallback(async () => {\n\t\tif (button.onClick && !button.isLoading) {\n\t\t\t_setIsLoading(true);\n\t\t\tawait button.onClick();\n\t\t\t_setIsLoading(false);\n\t\t}\n\t}, [_setIsLoading, button]);\n\treturn (\n\t\t<li key={button.id} className={twJoin('relative flex')}>\n\t\t\t{button.subButtonPosition === 'before' && (\n\t\t\t\t<ol ref={animateRef} className=\"flex divide-x divide-zinc-200 dark:divide-zinc-800\">\n\t\t\t\t\t{button.children}\n\t\t\t\t</ol>\n\t\t\t)}\n\t\t\t<div className={twJoin('flex items-center', button.isActive && 'dark:bg-zinc-800')}>\n\t\t\t\t<button\n\t\t\t\t\tonClick={_onClick}\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\ttitle={button.title}\n\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t'flex items-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 transition-transform hover:text-black active:scale-95 dark:text-zinc-300 dark:hover:text-white',\n\t\t\t\t\t\tbutton.isActive ? 'hover:text-brand:600 text-brand-600 dark:text-brand-500 dark:hover:text-brand-500' : '',\n\t\t\t\t\t\tbutton.hidden ? 'hidden' : '',\n\t\t\t\t\t\tbutton.className,\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t{button.icon && (button.isLoading || isLoading) && (\n\t\t\t\t\t\t<Spinner noMargin={true} className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t)}\n\t\t\t\t\t{button.icon && !button.isLoading && (\n\t\t\t\t\t\t<button.icon className=\"inline h-5 w-5 flex-shrink-0\" aria-hidden=\"true\" />\n\t\t\t\t\t)}\n\t\t\t\t\t{button.name && <span className=\"inline\">{button.name}</span>}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t{button.subButtonPosition != null && button.subButtonPosition !== 'before' && (\n\t\t\t\t<ol ref={animateRef} className=\"flex divide-x divide-zinc-200 dark:divide-zinc-800\">\n\t\t\t\t\t{button.children}\n\t\t\t\t</ol>\n\t\t\t)}\n\t\t\t{button.subButtonPosition == null && button.children && button.children}\n\t\t</li>\n\t);\n};\n\nexport default function Toolbar(props: ToolbarProps) {\n\tconst [animateRef] = useAutoAnimate(animationOptions);\n\treturn (\n\t\t<nav\n\t\t\tclassName={twMerge(\n\t\t\t\t'flex select-none overflow-hidden rounded-md border border-zinc-200 bg-white shadow dark:border-zinc-800 dark:bg-zinc-900/80',\n\t\t\t\tprops.className,\n\t\t\t)}\n\t\t\taria-label=\"Breadcrumb\"\n\t\t>\n\t\t\t<ol role=\"list\" className=\"flex divide-x divide-zinc-200 dark:divide-zinc-800\" ref={animateRef}>\n\t\t\t\t{props.buttons.map((button) => {\n\t\t\t\t\tconst subButtons = props.subButtons?.filter((b) => b.parent === button.id);\n\t\t\t\t\treturn button.hidden ? null : (\n\t\t\t\t\t\t<Button {...button} key={button.id}>\n\t\t\t\t\t\t\t{subButtons != null && subButtons.length > 0 && button.isActive\n\t\t\t\t\t\t\t\t? subButtons.map((subButton) => {\n\t\t\t\t\t\t\t\t\t\treturn subButton.hidden ? null : <Button {...subButton} key={subButton.id} />;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t: button.children}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</ol>\n\t\t</nav>\n\t);\n}\n","import { useState, useCallback } from 'react';\nimport { useDebounce } from '@/app/_hooks/debounce';\n\ntype SliderProps = {\n\tmin: number;\n\tstep?: number | 'any';\n\tmax: number;\n\tisBoolean?: boolean;\n\tonChange?: (val: number) => void;\n\tinitialValue?: number;\n};\nexport const Slider: React.FC<SliderProps> = ({ onChange, min, max, initialValue, step, isBoolean }) => {\n\tconst [value, setValue] = useState(initialValue ?? min);\n\tconst _onChange = useDebounce(\n\t\tuseCallback(\n\t\t\t(val: number) => {\n\t\t\t\tonChange?.(val);\n\t\t\t},\n\t\t\t[onChange],\n\t\t),\n\t\t100,\n\t);\n\tconst onInput = useCallback(\n\t\t(e: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tconst val = step ? parseFloat(e.target.value) : parseInt(e.target.value, 10);\n\t\t\tsetValue(val);\n\t\t\t_onChange(val);\n\t\t},\n\t\t[_onChange, step],\n\t);\n\treturn (\n\t\t<div className=\"relative mb-6\">\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tvalue={value}\n\t\t\t\tonChange={onInput}\n\t\t\t\tmin={min}\n\t\t\t\tmax={max}\n\t\t\t\tstep={step ?? 1}\n\t\t\t\tclassName=\"h-2 w-full cursor-pointer appearance-none rounded-lg bg-zinc-200 dark:bg-zinc-700\"\n\t\t\t/>\n\t\t\t<span className=\"absolute -bottom-6 start-0 text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t{isBoolean ? 'Off' : `Min (${min})`}\n\t\t\t</span>\n\t\t\t{!isBoolean && (\n\t\t\t\t<span className=\"absolute -bottom-6 start-1/3 -translate-x-1/2 text-sm text-zinc-500 dark:text-zinc-400 rtl:translate-x-1/2\">\n\t\t\t\t\t{(max / 3).toFixed(2)}\n\t\t\t\t</span>\n\t\t\t)}\n\t\t\t{!isBoolean && (\n\t\t\t\t<span className=\"absolute -bottom-6 start-2/3 -translate-x-1/2 text-sm text-zinc-500 dark:text-zinc-400 rtl:translate-x-1/2\">\n\t\t\t\t\t{((max / 3) * 2).toFixed(2)}\n\t\t\t\t</span>\n\t\t\t)}\n\t\t\t<span className=\"absolute -bottom-6 end-0 text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t{isBoolean ? 'On' : `Max (${max})`}\n\t\t\t</span>\n\t\t</div>\n\t);\n};\n","import React from 'react';\nimport { Slider } from '@/components/forms/slider';\nimport { useMoonrakerState } from '@/moonraker/hooks';\nimport { useStreamSettings } from '@/app/calibration/hooks';\nimport { useAutoAnimate } from '@formkit/auto-animate/react';\nimport { twJoin } from 'tailwind-merge';\nimport { ScrollContainer } from '@/components/common/scroll-container';\nimport { motion } from 'framer-motion';\n\ntype StreamSettingsDialogProps = {\n\turl: string;\n\tisConnected: boolean;\n\tisExposureVisible: boolean;\n\tisColorVisible: boolean;\n\tisAdvancedVisible: boolean;\n\tclassName?: string;\n};\n\nexport const StreamSettingsDialog: React.FC<StreamSettingsDialogProps> = (props) => {\n\tconst { url, isConnected, isAdvancedVisible, isColorVisible, isExposureVisible } = props;\n\tconst [streamSettings, saveStreamSettings, streamSettingsQuery] = useMoonrakerState(\n\t\t'RatOS',\n\t\t'camera-stream-settings',\n\t);\n\tconst { options, setOption } = useStreamSettings({\n\t\turl,\n\t\tisConnected,\n\t\tsettings: streamSettings,\n\t\tsaveSettings: saveStreamSettings,\n\t\tisInitialLoading: streamSettingsQuery.isInitialLoading,\n\t\tisFetched: streamSettingsQuery.isFetched,\n\t});\n\n\tconst [animate] = useAutoAnimate();\n\treturn (\n\t\t<ScrollContainer\n\t\t\tclassName={twJoin(\n\t\t\t\t'absolute bottom-24 left-1/4 right-1/4 max-h-[50%] overflow-y-scroll overscroll-contain rounded-md bg-zinc-900/70',\n\t\t\t\tprops.className,\n\t\t\t)}\n\t\t>\n\t\t\t<motion.div ref={animate}>\n\t\t\t\t{isExposureVisible &&\n\t\t\t\t\toptions\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t(o) =>\n\t\t\t\t\t\t\t\to.key.toLowerCase().includes('gain') ||\n\t\t\t\t\t\t\t\to.key.toLowerCase().includes('exposure') ||\n\t\t\t\t\t\t\t\to.key.startsWith('Ae') ||\n\t\t\t\t\t\t\t\to.key.toLowerCase().includes('brightness'),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.filter((o) => o.key !== 'ColourGains')\n\t\t\t\t\t\t.map((option) => (\n\t\t\t\t\t\t\t<div className=\"p-4\" key={option.key}>\n\t\t\t\t\t\t\t\t<label className=\"block text-center text-base font-semibold capitalize text-zinc-200\">\n\t\t\t\t\t\t\t\t\t{option.key}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<Slider\n\t\t\t\t\t\t\t\t\tisBoolean={'toggle' in option}\n\t\t\t\t\t\t\t\t\tmin={'toggle' in option ? 0 : 'min' in option ? option.min : 0}\n\t\t\t\t\t\t\t\t\tinitialValue={option.value === true ? 1 : option.value === false ? 0 : option.value}\n\t\t\t\t\t\t\t\t\tmax={'toggle' in option ? 1 : 'max' in option ? option.max : 0}\n\t\t\t\t\t\t\t\t\tstep={'float' in option && option.float ? 'any' : 1}\n\t\t\t\t\t\t\t\t\tonChange={(val) => setOption(option.key, 'toggle' in option ? !!val : val)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t{isColorVisible &&\n\t\t\t\t\toptions\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t(o) =>\n\t\t\t\t\t\t\t\to.key.toLowerCase().includes('saturation') ||\n\t\t\t\t\t\t\t\to.key.toLowerCase().includes('contrast') ||\n\t\t\t\t\t\t\t\to.key.startsWith('Awb'),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.map((option) => (\n\t\t\t\t\t\t\t<div className=\"p-4\" key={option.key}>\n\t\t\t\t\t\t\t\t<label className=\"block text-center text-base font-semibold capitalize text-zinc-200\">\n\t\t\t\t\t\t\t\t\t{option.key}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<Slider\n\t\t\t\t\t\t\t\t\tisBoolean={'toggle' in option}\n\t\t\t\t\t\t\t\t\tmin={'toggle' in option ? 0 : 'min' in option ? option.min : 0}\n\t\t\t\t\t\t\t\t\tinitialValue={option.value === true ? 1 : option.value === false ? 0 : option.value}\n\t\t\t\t\t\t\t\t\tmax={'toggle' in option ? 1 : 'max' in option ? option.max : 0}\n\t\t\t\t\t\t\t\t\tstep={'float' in option && option.float ? 'any' : 1}\n\t\t\t\t\t\t\t\t\tonChange={(val) => setOption(option.key, 'toggle' in option ? !!val : val)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t{isAdvancedVisible &&\n\t\t\t\t\toptions.map((option) => (\n\t\t\t\t\t\t<div className=\"p-4\" key={option.key}>\n\t\t\t\t\t\t\t<label className=\"block text-center text-base font-semibold capitalize text-zinc-200\">{option.key}</label>\n\t\t\t\t\t\t\t<Slider\n\t\t\t\t\t\t\t\tisBoolean={'toggle' in option}\n\t\t\t\t\t\t\t\tmin={'toggle' in option ? 0 : 'min' in option ? option.min : 0}\n\t\t\t\t\t\t\t\tinitialValue={option.value === true ? 1 : option.value === false ? 0 : option.value}\n\t\t\t\t\t\t\t\tmax={'toggle' in option ? 1 : 'max' in option ? option.max : 0}\n\t\t\t\t\t\t\t\tstep={'float' in option && option.float ? 'any' : 1}\n\t\t\t\t\t\t\t\tonChange={(val) => setOption(option.key, 'toggle' in option ? !!val : val)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t</motion.div>\n\t\t</ScrollContainer>\n\t);\n};\n","export const EnterFullscreenIcon = (props: React.SVGProps<SVGSVGElement>) => (\n\t<svg {...props} viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<path\n\t\t\td=\"M2 2.5C2 2.22386 2.22386 2 2.5 2H5.5C5.77614 2 6 2.22386 6 2.5C6 2.77614 5.77614 3 5.5 3H3V5.5C3 5.77614 2.77614 6 2.5 6C2.22386 6 2 5.77614 2 5.5V2.5ZM9 2.5C9 2.22386 9.22386 2 9.5 2H12.5C12.7761 2 13 2.22386 13 2.5V5.5C13 5.77614 12.7761 6 12.5 6C12.2239 6 12 5.77614 12 5.5V3H9.5C9.22386 3 9 2.77614 9 2.5ZM2.5 9C2.77614 9 3 9.22386 3 9.5V12H5.5C5.77614 12 6 12.2239 6 12.5C6 12.7761 5.77614 13 5.5 13H2.5C2.22386 13 2 12.7761 2 12.5V9.5C2 9.22386 2.22386 9 2.5 9ZM12.5 9C12.7761 9 13 9.22386 13 9.5V12.5C13 12.7761 12.7761 13 12.5 13H9.5C9.22386 13 9 12.7761 9 12.5C9 12.2239 9.22386 12 9.5 12H12V9.5C12 9.22386 12.2239 9 12.5 9Z\"\n\t\t\tfill=\"currentColor\"\n\t\t\tfillRule=\"evenodd\"\n\t\t\tclipRule=\"evenodd\"\n\t\t></path>\n\t</svg>\n);\n\nexport const ExitFullscreenIcon = (props: React.SVGProps<SVGSVGElement>) => (\n\t<svg {...props} viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<path\n\t\t\td=\"M5.5 2C5.77614 2 6 2.22386 6 2.5V5.5C6 5.77614 5.77614 6 5.5 6H2.5C2.22386 6 2 5.77614 2 5.5C2 5.22386 2.22386 5 2.5 5H5V2.5C5 2.22386 5.22386 2 5.5 2ZM9.5 2C9.77614 2 10 2.22386 10 2.5V5H12.5C12.7761 5 13 5.22386 13 5.5C13 5.77614 12.7761 6 12.5 6H9.5C9.22386 6 9 5.77614 9 5.5V2.5C9 2.22386 9.22386 2 9.5 2ZM2 9.5C2 9.22386 2.22386 9 2.5 9H5.5C5.77614 9 6 9.22386 6 9.5V12.5C6 12.7761 5.77614 13 5.5 13C5.22386 13 5 12.7761 5 12.5V10H2.5C2.22386 10 2 9.77614 2 9.5ZM9 9.5C9 9.22386 9.22386 9 9.5 9H12.5C12.7761 9 13 9.22386 13 9.5C13 9.77614 12.7761 10 12.5 10H10V12.5C10 12.7761 9.77614 13 9.5 13C9.22386 13 9 12.7761 9 12.5V9.5Z\"\n\t\t\tfill=\"currentColor\"\n\t\t\tfillRule=\"evenodd\"\n\t\t\tclipRule=\"evenodd\"\n\t\t></path>\n\t</svg>\n);\n","import React, { useCallback, useMemo, useState } from 'react';\nimport {\n\tCameraIcon,\n\tArrowsPointingOutIcon,\n\tLightBulbIcon,\n\tSwatchIcon,\n\tMapPinIcon,\n\tCogIcon,\n\tMagnifyingGlassIcon,\n\tViewfinderCircleIcon,\n\tBeakerIcon,\n\tArrowDownTrayIcon,\n} from '@heroicons/react/24/outline';\nimport { ExposureIcon } from '@/components/common/icons/exposure';\nimport { FocusControls } from '@/app/calibration/focus-controls';\nimport { PlayIcon, StopIcon } from '@heroicons/react/24/solid';\nimport Toolbar, { ToolbarButton, ToolbarButtonWithParent } from '@/components/common/toolbar';\nimport { usePrinterObjectSubscription } from '@/moonraker/hooks';\nimport { useGcodeCommand } from '@/app/_hooks/toolhead';\nimport { useChangeEffect } from '@/hooks/useChangeEffect';\nimport CountUp from 'react-countup';\nimport { VaocSettings, VaocSettingsDialog } from '@/app/calibration/vaoc-settings-dialog';\nimport { StreamSettingsDialog } from '@/app/calibration/stream-settings-dialog';\nimport { EnterFullscreenIcon, ExitFullscreenIcon } from '@/app/calibration/icons';\nimport {\n\tArrowDownToLine,\n\tCamera,\n\tCog,\n\tFlashlight,\n\tFlashlightOff,\n\tFocus,\n\tPlay,\n\tScanSearch,\n\tSquare,\n\tSunSnow,\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport { Modal } from '@/components/common/modal';\nimport { WarningMessage } from '@/components/warning-message';\n\ntype ToolbarsProps = {\n\tsetIsLockingCoordinates: React.Dispatch<React.SetStateAction<boolean>>;\n\tisLockingCoordinates: boolean;\n\tsetCanMove: React.Dispatch<React.SetStateAction<boolean>>;\n\tsetZoom: ReactCallback<(updater: (val: number) => number) => void>;\n\tcanMove: boolean;\n\tzoom: number;\n\tfps: number;\n\turl: string;\n\tisConnected: boolean;\n\tsettings: VaocSettings;\n\tsetSettings: (updater: VaocSettings | ((prev: VaocSettings) => VaocSettings)) => Promise<void>;\n\tisSettingsFetched: boolean;\n\ttoggleFullscreen: null | ((value?: boolean) => void);\n\tisFullscreened: boolean;\n};\n\nconst useToolbarState = (props: { zoom: number }) => {\n\tconst [isStartingVaoc, setIsStartingVaoc] = useState(false);\n\tconst [isSettingsVisible, setIsSettingsVisible] = useState(false);\n\tconst [isExposureVisible, setIsExposureVisible] = useState(false);\n\tconst [isColorVisible, setIsColorVisible] = useState(false);\n\tconst [isFocusVisible, setIsFocusVisible] = useState(false);\n\tconst [isAdvancedVisible, setIsAdvancedVisible] = useState(false);\n\tconst [light, setLight] = useState(false);\n\tconst [_isZoomExpanded, _setIsZoomExpanded] = useState(false);\n\tconst [isCameraControlsVisible, setIsCameraControlsVisible] = useState(false);\n\n\tconst [tempZoomExpand, clearTempZoomExpand] = useChangeEffect([props.zoom], 2000, true);\n\tconst isZoomExpanded = tempZoomExpand || _isZoomExpanded;\n\tconst toggleIsZoomExpanded = useCallback(() => {\n\t\t_setIsZoomExpanded((z) => !z);\n\t\tclearTempZoomExpand();\n\t}, [clearTempZoomExpand]);\n\n\tconst livePosition = usePrinterObjectSubscription((res) => {\n\t\treturn {\n\t\t\tx: res.motion_report.live_position?.[0],\n\t\t\ty: res.motion_report.live_position?.[1],\n\t\t\tz: res.motion_report.live_position?.[2],\n\t\t};\n\t}, 'motion_report');\n\n\tconst t0 = usePrinterObjectSubscription((res) => {\n\t\treturn { active: res['gcode_macro T0'].active };\n\t}, 'gcode_macro T0');\n\n\tconst t1 = usePrinterObjectSubscription((res) => {\n\t\treturn { active: res['gcode_macro T1'].active };\n\t}, 'gcode_macro T1');\n\n\tconst { isVaocStarted } = usePrinterObjectSubscription((res) => {\n\t\treturn { isVaocStarted: res['gcode_macro _VAOC'].is_started };\n\t}, 'gcode_macro _VAOC') ?? { isVaocStarted: false };\n\n\tconst { hasZOffsetProbe } = usePrinterObjectSubscription((res) => {\n\t\treturn { hasZOffsetProbe: res.configfile.settings.z_offset_probe != null };\n\t}, 'configfile') ?? { hasZOffsetProbe: false };\n\tconst isZOffsetProbeVisible = hasZOffsetProbe && isVaocStarted;\n\n\treturn {\n\t\tlivePosition,\n\t\ttool: t0?.active ? 'T0' : t1?.active ? 'T1' : null,\n\t\tisStartingVaoc,\n\t\tsetIsStartingVaoc,\n\t\tisSettingsVisible,\n\t\tsetIsSettingsVisible,\n\t\tisExposureVisible,\n\t\tsetIsExposureVisible,\n\t\tisColorVisible,\n\t\tsetIsColorVisible,\n\t\tisFocusVisible,\n\t\tsetIsFocusVisible,\n\t\tisAdvancedVisible,\n\t\tsetIsAdvancedVisible,\n\t\tlight,\n\t\tsetLight,\n\t\tisVaocStarted,\n\t\tisZoomExpanded,\n\t\ttoggleIsZoomExpanded,\n\t\thasZOffsetProbe,\n\t\tisZOffsetProbeVisible,\n\t\tisCameraControlsVisible,\n\t\tsetIsCameraControlsVisible,\n\t};\n};\n\nexport const Toolbars: React.FC<ToolbarsProps> = (props) => {\n\tconst {\n\t\tcanMove,\n\t\tisLockingCoordinates,\n\t\tsetIsLockingCoordinates,\n\t\tzoom,\n\t\tsetZoom,\n\t\tfps,\n\t\turl,\n\t\tisConnected,\n\t\tsetSettings,\n\t\tsettings,\n\t\tisSettingsFetched,\n\t\tisFullscreened,\n\t} = props;\n\tconst {\n\t\ttool,\n\t\tisStartingVaoc,\n\t\tsetIsStartingVaoc,\n\t\tisSettingsVisible,\n\t\tsetIsSettingsVisible,\n\t\tisExposureVisible,\n\t\tsetIsExposureVisible,\n\t\tisColorVisible,\n\t\tsetIsColorVisible,\n\t\tisFocusVisible,\n\t\tsetIsFocusVisible,\n\t\tisAdvancedVisible,\n\t\tsetIsAdvancedVisible,\n\t\tlight,\n\t\tsetLight,\n\t\tisVaocStarted,\n\t\tisZoomExpanded,\n\t\ttoggleIsZoomExpanded,\n\t\tisZOffsetProbeVisible,\n\t\tisCameraControlsVisible,\n\t\tsetIsCameraControlsVisible,\n\t} = useToolbarState({ zoom });\n\tconst G = useGcodeCommand();\n\tconst handleCommandError = useCallback(\n\t\tasync (\n\t\t\tfn: () => Promise<void>,\n\t\t\topts?: {\n\t\t\t\tsuccess?: () => Promise<void>;\n\t\t\t\terror?: () => Promise<void>;\n\t\t\t\talways?: () => Promise<void>;\n\t\t\t\ttitle?: string;\n\t\t\t\tfallbackDescription?: string;\n\t\t\t},\n\t\t) => {\n\t\t\ttry {\n\t\t\t\tconst res = await fn();\n\t\t\t\tif (opts?.success) {\n\t\t\t\t\tawait opts?.success?.();\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t} catch (e) {\n\t\t\t\tlet message = opts?.fallbackDescription ?? 'Unknown error occured. Please try again.';\n\t\t\t\tif (e instanceof Error) {\n\t\t\t\t\tmessage = e.message;\n\t\t\t\t}\n\t\t\t\ttoast.error(opts?.title ?? `Couldn't execute VAOC command`, {\n\t\t\t\t\tdescription: `\n\t\t\t\t<div>\n\t\t\t\t\t<pre class=\"text-wrap mt-4 text-rose-400 font-medium whitespace-pre-wrap\">${message}</pre>\n\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\t});\n\t\t\t\tif (opts?.error) {\n\t\t\t\t\tawait opts?.error?.();\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tif (opts?.always) {\n\t\t\t\t\tawait opts?.always();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[],\n\t);\n\tconst [isLoadingTool] = useChangeEffect([isLockingCoordinates], 200, true);\n\tconst [isCalibratingExpansion, setIsCalibratingExpansion] = useState(false);\n\tconst [showCleanNozzleConfirmation, setShowCleanNozzleConfirmation] = useState(false);\n\n\tconst topLeftControls: ToolbarButton[] = [\n\t\t{\n\t\t\ticon: isVaocStarted ? Square : Play,\n\t\t\tid: 'start/stop',\n\t\t\tname: isVaocStarted ? undefined : 'Start Calibration',\n\t\t\ttitle: isVaocStarted ? 'Stop calibration' : 'Start calibration',\n\t\t\tonClick: async () => {\n\t\t\t\tif (isStartingVaoc) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (isVaocStarted && isFullscreened) {\n\t\t\t\t\tprops.toggleFullscreen?.(false);\n\t\t\t\t}\n\t\t\t\tsetIsStartingVaoc(true);\n\t\t\t\tconst wasStarted = isVaocStarted;\n\t\t\t\tif (wasStarted) {\n\t\t\t\t\tsetIsLockingCoordinates(true);\n\t\t\t\t\tawait handleCommandError(() => G`_VAOC_SET_TOOL`, {\n\t\t\t\t\t\talways: async () => {\n\t\t\t\t\t\t\tsetIsLockingCoordinates(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\thandleCommandError(() => (isVaocStarted ? G`_VAOC_END` : G`_VAOC_START`), {\n\t\t\t\t\talways: async () => {\n\t\t\t\t\t\tsetIsStartingVaoc(false);\n\t\t\t\t\t},\n\t\t\t\t\ttitle: `Couldn't ${wasStarted ? 'stop' : 'start'} VAOC`,\n\t\t\t\t\tfallbackDescription: `Unknown error occured while ${wasStarted ? 'stopping' : 'starting'} VAOC. Please try again.`,\n\t\t\t\t});\n\t\t\t},\n\t\t\tisActive: isVaocStarted,\n\t\t},\n\t\t{\n\t\t\tname: 'T0',\n\t\t\tid: 't0',\n\t\t\thidden: !isVaocStarted,\n\t\t\ttitle: 'Switch to tool 0 (T0)',\n\t\t\tonClick: async () => {\n\t\t\t\tsetIsLockingCoordinates(true);\n\t\t\t\tawait handleCommandError(() => G`_VAOC_SET_TOOL`, {\n\t\t\t\t\talways: async () => {\n\t\t\t\t\t\tsetIsLockingCoordinates(false);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tawait handleCommandError(() => G`_VAOC_LOAD_TOOL T=0`);\n\t\t\t},\n\t\t\tisActive: tool === 'T0',\n\t\t},\n\t\t{\n\t\t\tname: 'T1',\n\t\t\tid: 't1',\n\t\t\thidden: !isVaocStarted,\n\t\t\ttitle: 'Switch to tool 1 (T1)',\n\t\t\tonClick: async () => {\n\t\t\t\tsetIsLockingCoordinates(true);\n\t\t\t\tawait handleCommandError(() => G`_VAOC_SET_TOOL`, {\n\t\t\t\t\talways: async () => {\n\t\t\t\t\t\tsetIsLockingCoordinates(false);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tawait handleCommandError(() => G`_VAOC_LOAD_TOOL T=1`);\n\t\t\t},\n\t\t\tisActive: tool === 'T1',\n\t\t},\n\t];\n\tconst topRightControls: ToolbarButton[] = [\n\t\t{\n\t\t\ticon: ScanSearch,\n\t\t\tid: 'zoom',\n\t\t\ttitle: `${isZoomExpanded ? 'Hide' : 'Show'} zoom controls`,\n\t\t\tsubButtonPosition: 'before',\n\t\t\tclassName: 'font-mono',\n\t\t\tname:\n\t\t\t\tzoom >= 10 ? (\n\t\t\t\t\t'MAX!'\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<CountUp preserveValue={true} start={0} end={Math.round(zoom * 100)} duration={0.15} />%\n\t\t\t\t\t</>\n\t\t\t\t),\n\t\t\tonClick: () => {\n\t\t\t\ttoggleIsZoomExpanded();\n\t\t\t},\n\t\t\tisActive: isZoomExpanded,\n\t\t},\n\t\t{\n\t\t\ticon: light ? FlashlightOff : Flashlight,\n\t\t\tid: 'light',\n\t\t\ttitle: `${light ? 'Turn off' : 'Turn on'} the LEDs`,\n\t\t\tonClick: async () => {\n\t\t\t\tconst newVal = !light;\n\t\t\t\tawait handleCommandError(() => G`_VAOC_SWITCH_LED STATE=${newVal ? 1 : 0}`, {\n\t\t\t\t\tsuccess: async () => {\n\t\t\t\t\t\tsetLight(newVal);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\tisActive: light,\n\t\t},\n\t\t{\n\t\t\ticon: isFullscreened ? ExitFullscreenIcon : EnterFullscreenIcon,\n\t\t\tid: 'fullscreen',\n\t\t\ttitle: `${isFullscreened ? 'Exit' : 'Enter'} fullscreen mode`,\n\t\t\tonClick: () => {\n\t\t\t\tif (props.toggleFullscreen) {\n\t\t\t\t\tprops.toggleFullscreen();\n\t\t\t\t}\n\t\t\t},\n\t\t\tisActive: isFullscreened,\n\t\t},\n\t];\n\tconst zoomControls: ToolbarButtonWithParent[] = [\n\t\t{\n\t\t\tname: '1X',\n\t\t\tid: '1x',\n\t\t\tparent: 'zoom',\n\t\t\ttitle: `Set zoom to 1X (100%)`,\n\t\t\tclassName: 'font-mono',\n\t\t\tonClick: () => {\n\t\t\t\tsetZoom(() => 1);\n\t\t\t},\n\t\t\tisActive: false,\n\t\t},\n\t\t{\n\t\t\tname: '2X',\n\t\t\tid: '2x',\n\t\t\tparent: 'zoom',\n\t\t\ttitle: `Set zoom to 2X (200%)`,\n\t\t\tclassName: 'font-mono',\n\t\t\tonClick: () => {\n\t\t\t\tsetZoom(() => 2);\n\t\t\t},\n\t\t\tisActive: false,\n\t\t},\n\t\t{\n\t\t\tname: '4X',\n\t\t\tid: '4x',\n\t\t\tparent: 'zoom',\n\t\t\ttitle: `Set zoom to 4X (400%)`,\n\t\t\tclassName: 'font-mono',\n\t\t\tonClick: () => {\n\t\t\t\tsetZoom(() => 4);\n\t\t\t},\n\t\t\tisActive: false,\n\t\t},\n\t];\n\tconst bottomLeftControls = useMemo(\n\t\t() =>\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tname: 'Settings',\n\t\t\t\t\ticon: Cog,\n\t\t\t\t\tid: 'settings',\n\t\t\t\t\ttitle: 'Show camera settings dialog',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tsetIsSettingsVisible((vis) => !vis);\n\t\t\t\t\t},\n\t\t\t\t\tisActive: isSettingsVisible,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'Calibrate Thermal Expansion',\n\t\t\t\t\ticon: SunSnow,\n\t\t\t\t\thidden: !isVaocStarted,\n\t\t\t\t\tisLoading: showCleanNozzleConfirmation || isCalibratingExpansion,\n\t\t\t\t\tid: 'calibrate-thermal-expansion',\n\t\t\t\t\ttitle: `Calibrates the thermal expansion coefficient for both toolheads`,\n\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\tsetShowCleanNozzleConfirmation(true);\n\t\t\t\t\t},\n\t\t\t\t\tisActive: canMove,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'Calibrate Z-offsets',\n\t\t\t\t\ticon: ArrowDownToLine,\n\t\t\t\t\ttitle: 'Probe the z endstop to set the Z offset for both hotends',\n\t\t\t\t\tid: 'z-probe',\n\t\t\t\t\thidden: !isZOffsetProbeVisible,\n\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\tawait handleCommandError(() => G`_VAOC_CALIBRATE_Z_OFFSET`);\n\t\t\t\t\t},\n\t\t\t\t\tisActive: false,\n\t\t\t\t},\n\t\t\t] satisfies ToolbarButton[],\n\t\t[\n\t\t\tisSettingsVisible,\n\t\t\tisVaocStarted,\n\t\t\tshowCleanNozzleConfirmation,\n\t\t\tisCalibratingExpansion,\n\t\t\tcanMove,\n\t\t\tisZOffsetProbeVisible,\n\t\t\tsetIsSettingsVisible,\n\t\t\thandleCommandError,\n\t\t\tG,\n\t\t],\n\t);\n\tconst cameraControls = useMemo(() => {\n\t\tconst controls: ToolbarButton[] = [\n\t\t\t{\n\t\t\t\ticon: Camera,\n\t\t\t\tname: (\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{fps == null ? (\n\t\t\t\t\t\t\t'Loading...'\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t<CountUp start={0} preserveValue={true} duration={1} end={fps} /> FPS\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</span>\n\t\t\t\t),\n\t\t\t\tclassName: 'font-mono',\n\t\t\t\tid: 'settings',\n\t\t\t\tsubButtonPosition: 'before',\n\t\t\t\ttitle: `${isCameraControlsVisible ? 'Hide' : 'Show'} camera controls`,\n\t\t\t\tonClick: () => {\n\t\t\t\t\tif (isCameraControlsVisible) {\n\t\t\t\t\t\tsetIsFocusVisible(false);\n\t\t\t\t\t\tsetIsExposureVisible(false);\n\t\t\t\t\t\tsetIsColorVisible(false);\n\t\t\t\t\t\tsetIsAdvancedVisible(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetIsFocusVisible(false);\n\t\t\t\t\t}\n\t\t\t\t\tsetIsCameraControlsVisible((vis) => !vis);\n\t\t\t\t},\n\t\t\t\tisActive: isCameraControlsVisible,\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: Focus,\n\t\t\t\tid: 'focus',\n\t\t\t\thidden: false,\n\t\t\t\tname: 'Z Focus',\n\t\t\t\ttitle: `${isFocusVisible ? 'Hide' : 'Show'} focus controls`,\n\t\t\t\tchildren: <FocusControls isVisible={isFocusVisible} toggle={setIsFocusVisible} />,\n\t\t\t\tonClick: () => {\n\t\t\t\t\tsetIsFocusVisible((vis) => !vis);\n\t\t\t\t\tsetIsCameraControlsVisible(false);\n\t\t\t\t\tsetIsExposureVisible(false);\n\t\t\t\t\tsetIsColorVisible(false);\n\t\t\t\t\tsetIsAdvancedVisible(false);\n\t\t\t\t},\n\t\t\t\tisActive: isFocusVisible,\n\t\t\t},\n\t\t];\n\t\treturn controls;\n\t}, [\n\t\tfps,\n\t\tisCameraControlsVisible,\n\t\tisFocusVisible,\n\t\tsetIsAdvancedVisible,\n\t\tsetIsCameraControlsVisible,\n\t\tsetIsColorVisible,\n\t\tsetIsExposureVisible,\n\t\tsetIsFocusVisible,\n\t]);\n\tconst cameraControlsSubButtons = useMemo(() => {\n\t\tconst controls: ToolbarButtonWithParent[] = [\n\t\t\t{\n\t\t\t\ticon: ExposureIcon as any,\n\t\t\t\tid: 'exposure',\n\t\t\t\tparent: 'settings',\n\t\t\t\thidden: isColorVisible || isAdvancedVisible || isFocusVisible,\n\t\t\t\ttitle: `${isExposureVisible ? 'Hide' : 'Show'} exposure controls`,\n\t\t\t\tname: 'Exposure',\n\t\t\t\tonClick: () => {\n\t\t\t\t\tsetIsExposureVisible((vis) => !vis);\n\t\t\t\t\tsetIsColorVisible(false);\n\t\t\t\t\tsetIsAdvancedVisible(false);\n\t\t\t\t\tsetIsFocusVisible(false);\n\t\t\t\t},\n\t\t\t\tisActive: isExposureVisible,\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: SwatchIcon,\n\t\t\t\tid: 'color',\n\t\t\t\tparent: 'settings',\n\t\t\t\ttitle: `${isColorVisible ? 'Hide' : 'Show'} color controls`,\n\t\t\t\thidden: isExposureVisible || isAdvancedVisible || isFocusVisible,\n\t\t\t\tname: 'Color',\n\t\t\t\tonClick: () => {\n\t\t\t\t\tsetIsColorVisible((vis) => !vis);\n\t\t\t\t\tsetIsExposureVisible(false);\n\t\t\t\t\tsetIsAdvancedVisible(false);\n\t\t\t\t\tsetIsFocusVisible(false);\n\t\t\t\t},\n\t\t\t\tisActive: isColorVisible,\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: BeakerIcon,\n\t\t\t\tid: 'advanced-camera-controls',\n\t\t\t\tparent: 'settings',\n\t\t\t\ttitle: `${isAdvancedVisible ? 'Hide' : 'Show'} advanced camera controls`,\n\t\t\t\tname: 'Advanced',\n\t\t\t\thidden: isExposureVisible || isColorVisible || isFocusVisible,\n\t\t\t\tonClick: () => {\n\t\t\t\t\tsetIsAdvancedVisible((vis) => !vis);\n\t\t\t\t\tsetIsExposureVisible(false);\n\t\t\t\t\tsetIsColorVisible(false);\n\t\t\t\t\tsetIsFocusVisible(false);\n\t\t\t\t},\n\t\t\t\tisActive: isAdvancedVisible,\n\t\t\t},\n\t\t];\n\t\treturn controls.reverse();\n\t}, [\n\t\tisColorVisible,\n\t\tisAdvancedVisible,\n\t\tisExposureVisible,\n\t\tisFocusVisible,\n\t\tsetIsFocusVisible,\n\t\tsetIsExposureVisible,\n\t\tsetIsColorVisible,\n\t\tsetIsAdvancedVisible,\n\t]);\n\n\tconst confirmCleanNozzleModal = showCleanNozzleConfirmation ? (\n\t\t<Modal\n\t\t\ttitle=\"Make sure nozzles are clean\"\n\t\t\tbody=\"Clean nozzles and empty meltzones are important for accuracy\"\n\t\t\tcontent={\n\t\t\t\t<WarningMessage title=\"Important for accuracy\">\n\t\t\t\t\tBefore proceeding, make sure that the nozzle is clean on both toolheads and that no filament is left in the\n\t\t\t\t\tmeltzone. Oozing filament or dirty nozzles will cause inaccurate results.\n\t\t\t\t</WarningMessage>\n\t\t\t}\n\t\t\tbuttonLabel=\"They're clean, i promise!\"\n\t\t\tdismissText=\"Abort\"\n\t\t\tonClick={async () => {\n\t\t\t\tsetIsCalibratingExpansion(true);\n\t\t\t\tawait handleCommandError(() => G`_VAOC_CALIBRATE_TEMP_OFFSET`, {\n\t\t\t\t\ttitle: `Failed thermal expansion calibration`,\n\t\t\t\t\tfallbackDescription: `Unknown error occured while calibrating thermal expansion. Please try again.`,\n\t\t\t\t\talways: async () => {\n\t\t\t\t\t\tsetIsCalibratingExpansion(false);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}}\n\t\t\tonClose={() => {\n\t\t\t\tsetTimeout(() => setShowCleanNozzleConfirmation(false), 200);\n\t\t\t}}\n\t\t/>\n\t) : null;\n\n\treturn (\n\t\t<>\n\t\t\t<Toolbar className=\"pointer-events-auto absolute left-5 top-5\" buttons={topLeftControls} />\n\t\t\t<Toolbar\n\t\t\t\tclassName=\"pointer-events-auto absolute bottom-5 right-5 overflow-visible\"\n\t\t\t\tbuttons={cameraControls}\n\t\t\t\tsubButtons={cameraControlsSubButtons}\n\t\t\t/>\n\t\t\t<Toolbar\n\t\t\t\tclassName=\"pointer-events-auto absolute right-5 top-5\"\n\t\t\t\tbuttons={topRightControls}\n\t\t\t\tsubButtons={zoomControls}\n\t\t\t/>\n\t\t\t<Toolbar className=\"pointer-events-auto absolute bottom-5 left-5\" buttons={bottomLeftControls} />\n\t\t\t<VaocSettingsDialog\n\t\t\t\tclassName=\"pointer-events-auto\"\n\t\t\t\tisVisible={isSettingsVisible}\n\t\t\t\ttoggle={setIsSettingsVisible}\n\t\t\t\tsettings={settings}\n\t\t\t\tisSettingsFetched={isSettingsFetched}\n\t\t\t\tsetSettings={setSettings}\n\t\t\t/>\n\t\t\t<StreamSettingsDialog\n\t\t\t\tclassName=\"pointer-events-auto\"\n\t\t\t\t{...{ url, isConnected, isExposureVisible, isColorVisible, isAdvancedVisible }}\n\t\t\t/>\n\t\t\t{confirmCleanNozzleModal}\n\t\t</>\n\t);\n};\n","import { twJoin } from 'tailwind-merge';\nimport { useGestures } from '@/app/calibration/hooks';\n\nexport const SafetyVisualization: React.FC<{ gestureState: ReturnType<typeof useGestures> }> = ({ gestureState }) => (\n\t<>\n\t\t<div\n\t\t\tclassName={twJoin(\n\t\t\t\t'absolute inset-0',\n\t\t\t\tgestureState.dragOutside.x && gestureState.dragOutside.x > 0\n\t\t\t\t\t? 'left-0 right-2/3 bg-gradient-to-r from-red-500/70 to-red-500/0'\n\t\t\t\t\t: 'left-2/3 right-0 bg-gradient-to-l from-red-500/70 to-red-500/0',\n\t\t\t)}\n\t\t\tstyle={{\n\t\t\t\topacity: gestureState.dragOutside.x\n\t\t\t\t\t? Math.abs(gestureState.dragOutside.x - gestureState.dragOffset.x) / 200\n\t\t\t\t\t: 0,\n\t\t\t\ttransform: `translateX(${gestureState.scaledDragOffset.x}px) translateY(${gestureState.scaledDragOffset.y}px)`,\n\t\t\t}}\n\t\t/>\n\t\t<div\n\t\t\tclassName={twJoin(\n\t\t\t\t'absolute inset-0',\n\t\t\t\tgestureState.dragOutside.y && gestureState.dragOutside.y > 0\n\t\t\t\t\t? 'bottom-2/3 top-0 bg-gradient-to-b from-red-500/70 to-red-500/0'\n\t\t\t\t\t: 'bottom-0 top-2/3 bg-gradient-to-t from-red-500/70 to-red-500/0',\n\t\t\t)}\n\t\t\tstyle={{\n\t\t\t\topacity: gestureState.dragOutside.y\n\t\t\t\t\t? Math.abs(gestureState.dragOutside.y - gestureState.dragOffset.y) / 200\n\t\t\t\t\t: 0,\n\t\t\t\ttransform: `translateX(${gestureState.scaledDragOffset.x}px) translateY(${gestureState.scaledDragOffset.y}px)`,\n\t\t\t}}\n\t\t/>\n\t</>\n);\n","import { twJoin } from 'tailwind-merge';\n\nexport const FillViewport = (props: React.PropsWithChildren<{ className?: string }>) => (\n\t<div className={twJoin('pointer-events-none absolute inset-0 flex items-center justify-center', props.className)}>\n\t\t{props.children}\n\t</div>\n);\n\ntype FillVideoFrameProps = {\n\tclassName?: string;\n\tvideoAspectRatio: number;\n\tcontainerAspectRatio: number;\n\tzoom: number;\n};\n\nexport const FillVideoFrame = (props: React.PropsWithChildren<FillVideoFrameProps>) => (\n\t<div\n\t\tclassName={twJoin('pointer-events-none absolute inset-0 top-1/2 -translate-y-1/2 transition-all', props.className)}\n\t\tstyle={\n\t\t\tprops.videoAspectRatio\n\t\t\t\t? { aspectRatio: Math.max(props.videoAspectRatio / props.zoom, props.containerAspectRatio) }\n\t\t\t\t: {}\n\t\t}\n\t>\n\t\t{props.children}\n\t</div>\n);\n","import { twJoin } from 'tailwind-merge';\nimport { FillViewport } from '@/app/calibration/framing';\nimport { CrossHairStateProps, useCrossHairState } from '@/app/calibration/hooks';\n\nexport const CrossHair: React.FC<CrossHairStateProps & { isConnected: boolean }> = (props) => {\n\tconst {\n\t\tcanRender,\n\t\touterNozzleRadius,\n\t\tnozzleRadius,\n\t\touterNozzleRadiusPercentWidth,\n\t\touterNozzleRadiusPercentHeight,\n\t\tcrosshairStrokeWidth,\n\t\tdelayedIsLockingCoordinates,\n\t} = useCrossHairState(props);\n\treturn (\n\t\t<FillViewport>\n\t\t\t<svg width=\"100%\" height=\"100%\">\n\t\t\t\t<g className={twJoin(props.isConnected && outerNozzleRadius > 0 ? 'opacity-100' : 'opacity-0')}>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tx=\"50%\"\n\t\t\t\t\t\ty={!canRender ? '50%' : `${50 - outerNozzleRadiusPercentHeight}%`}\n\t\t\t\t\t\theight={!canRender ? 0 : `${outerNozzleRadiusPercentHeight * 2}%`}\n\t\t\t\t\t\twidth={!canRender ? 0 : crosshairStrokeWidth}\n\t\t\t\t\t\tshapeRendering=\"geometricPrecision\"\n\t\t\t\t\t\tclassName=\"fill-brand-500 transition-all ease-in-out\"\n\t\t\t\t\t\tstyle={{ transform: `translateX(-${crosshairStrokeWidth / 2})` }}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tx={!canRender ? '50%' : `${50 - outerNozzleRadiusPercentWidth}%`}\n\t\t\t\t\t\ty=\"50%\"\n\t\t\t\t\t\twidth={!canRender ? 0 : `${outerNozzleRadiusPercentWidth * 2}%`}\n\t\t\t\t\t\theight={!canRender ? 0 : crosshairStrokeWidth}\n\t\t\t\t\t\tshapeRendering=\"geometricPrecision\"\n\t\t\t\t\t\tclassName=\"fill-brand-500 transition-all ease-in-out\"\n\t\t\t\t\t\tstyle={{ transform: `translateY(-${crosshairStrokeWidth / 2})` }}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t\t<circle\n\t\t\t\t\tcx=\"50%\"\n\t\t\t\t\tcy=\"50%\"\n\t\t\t\t\tr={!canRender ? 0 : delayedIsLockingCoordinates ? outerNozzleRadius : outerNozzleRadius * 1.5}\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t'ease-out',\n\t\t\t\t\t\tdelayedIsLockingCoordinates ? 'fill-brand-300' : 'fill-brand-300/0 transition-all duration-700',\n\t\t\t\t\t)}\n\t\t\t\t\tshapeRendering=\"geometricPrecision\"\n\t\t\t\t\tstrokeWidth={0}\n\t\t\t\t/>\n\t\t\t\t<circle\n\t\t\t\t\tcx=\"50%\"\n\t\t\t\t\tcy=\"50%\"\n\t\t\t\t\tr={!canRender ? 0 : nozzleRadius}\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t'stroke-brand-500 transition-all ease-in-out',\n\t\t\t\t\t\tprops.isConnected && outerNozzleRadius > 0 ? 'opacity-100' : 'opacity-0',\n\t\t\t\t\t)}\n\t\t\t\t\tshapeRendering=\"geometricPrecision\"\n\t\t\t\t\tstrokeWidth={crosshairStrokeWidth}\n\t\t\t\t/>\n\t\t\t\t<circle\n\t\t\t\t\tcx=\"50%\"\n\t\t\t\t\tcy=\"50%\"\n\t\t\t\t\tr={!canRender ? 0 : outerNozzleRadius}\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t'stroke-brand-500 transition-all ease-in-out',\n\t\t\t\t\t\tprops.isConnected && outerNozzleRadius > 0 ? 'opacity-100' : 'opacity-0',\n\t\t\t\t\t)}\n\t\t\t\t\tshapeRendering=\"geometricPrecision\"\n\t\t\t\t\tstrokeWidth={crosshairStrokeWidth}\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t</FillViewport>\n\t);\n};\n","'use client';\n\nimport { useWebRTC } from '@/app/_hooks/webrtc';\nimport React, { useCallback, useEffect } from 'react';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport { initialCameraSettings } from '@/app/calibration/vaoc-settings-dialog';\nimport { useMoonrakerState, usePrinterObjectSubscription } from '@/moonraker/hooks';\nimport { Spinner } from '@/components/common/spinner';\nimport { useGestures, useSpatialMapping, useUIState, useVideoState } from '@/app/calibration/hooks';\nimport { Toolbars } from '@/app/calibration/toolbars';\nimport { SafetyVisualization } from '@/app/calibration/safety-visualization';\nimport { CrossHair } from '@/app/calibration/crosshair';\nimport { FillVideoFrame, FillViewport } from '@/app/calibration/framing';\nimport screenfull from 'screenfull';\n\nexport const VAOC = () => {\n\tconst videoState = useVideoState();\n\tconst { videoRef, connectionState } = useWebRTC(videoState.url + '/webrtc', videoState.onStreamStats);\n\tconst isConnected = connectionState === 'connected';\n\n\tconst [settings, setSettings, settingsQuery] = useMoonrakerState('RatOS', 'camera-settings', initialCameraSettings);\n\tconst uiState = useUIState();\n\tconst spatialMapping = useSpatialMapping({\n\t\tsettings,\n\t\tcontainerRef: uiState.containerRef,\n\t\tvideoRef,\n\t\twindowSize: uiState.windowSize,\n\t\tzoom: uiState.zoom,\n\t});\n\tconst gestureState = useGestures({\n\t\tsetZoom: uiState.setZoom,\n\t\tcanMove: uiState.canMove,\n\t\tgestureRef: videoRef,\n\t\tisConnected,\n\t\ttoMillimeters: spatialMapping.toMillimeters,\n\t\ttoScreen: spatialMapping.toScreen,\n\t\tzoom: uiState.zoom,\n\t});\n\n\tconst videoScaleX = uiState.zoom * (settings?.flipHorizontal ? -1 : 1);\n\tconst videoScaleY = uiState.zoom * (settings?.flipVertical ? -1 : 1);\n\tconst videoTranslationX = gestureState.scaledDragOffset.x * (settings?.flipHorizontal ? -1 : 1);\n\tconst videoTranslationY = gestureState.scaledDragOffset.y * (settings?.flipVertical ? -1 : 1);\n\n\treturn (\n\t\t<div\n\t\t\tclassName={twJoin(\n\t\t\t\tuiState.isFullscreened ? 'h-full' : 'h-[calc(100vh_-_64px)]',\n\t\t\t\t'flex w-full select-none items-center',\n\t\t\t)}\n\t\t\tref={uiState.rootRef}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"relative mx-auto flex h-full max-h-full min-h-[50vh] min-w-[50vw] max-w-fit items-center overflow-hidden object-contain shadow-lg\"\n\t\t\t\tref={uiState.containerRef}\n\t\t\t>\n\t\t\t\t<video\n\t\t\t\t\tref={videoRef}\n\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t'h-full max-h-full w-full min-w-full max-w-full transform-gpu touch-none',\n\t\t\t\t\t\tuiState.canMove && 'cursor-move',\n\t\t\t\t\t\t!gestureState.isDragging && 'transition-transform ease-in-out',\n\t\t\t\t\t)}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttransform: `scale3d(${videoScaleX}, ${videoScaleY}, 1) translate3d(${videoTranslationX}px, ${videoTranslationY}px, 0)`,\n\t\t\t\t\t}}\n\t\t\t\t\tautoPlay\n\t\t\t\t\tmuted\n\t\t\t\t\tplaysInline\n\t\t\t\t/>\n\t\t\t\t<FillVideoFrame\n\t\t\t\t\tvideoAspectRatio={videoState.aspectRatio ?? 0}\n\t\t\t\t\tcontainerAspectRatio={uiState.containerAspectRatio}\n\t\t\t\t\tzoom={uiState.zoom}\n\t\t\t\t>\n\t\t\t\t\t<SafetyVisualization gestureState={gestureState} />\n\t\t\t\t</FillVideoFrame>\n\t\t\t\t<CrossHair\n\t\t\t\t\tisConnected={isConnected && videoState.aspectRatio != null}\n\t\t\t\t\tisLockingCoordinates={uiState.isLockingCoordinates}\n\t\t\t\t\tsettings={settings}\n\t\t\t\t\ttoScreen={spatialMapping.toScreen}\n\t\t\t\t\tcontainerSize={spatialMapping.containerSize}\n\t\t\t\t/>\n\t\t\t\t<FillViewport>\n\t\t\t\t\t<h3\n\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t'absolute inset-0 flex items-center justify-center text-xl font-semibold text-rose-500 transition-all dark:text-rose-500',\n\t\t\t\t\t\t\tconnectionState === 'failed' ? 'animate-pulse opacity-100' : 'opacity-0',\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"flex aspect-square h-[30svh] w-[30svh] items-center justify-center\">\n\t\t\t\t\t\t\tWebcam stream not found\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</h3>\n\t\t\t\t\t<Spinner\n\t\t\t\t\t\tnoMargin={true}\n\t\t\t\t\t\tstrokeWidth={1}\n\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t'h-[40svh] w-[40svh] animate-spin text-inherit transition-all',\n\t\t\t\t\t\t\t'text-lime-500 dark:text-lime-500',\n\t\t\t\t\t\t\t(connectionState === 'connected' || connectionState === 'failed') &&\n\t\t\t\t\t\t\t\tvideoState.aspectRatio != null &&\n\t\t\t\t\t\t\t\t'opacity-0',\n\t\t\t\t\t\t\tconnectionState === 'failed' && 'text-rose-500 dark:text-rose-500',\n\t\t\t\t\t\t\tconnectionState === 'connecting' && 'text-brand-500 dark:text-brand-500',\n\t\t\t\t\t\t\tconnectionState === 'closed' && 'text-yellow-500 dark:text-yellow-500',\n\t\t\t\t\t\t\tconnectionState === 'disconnected' && 'text-amber-500 dark:text-amber-500',\n\t\t\t\t\t\t\tconnectionState === 'new' && 'text-sky-500 dark:text-sky-500',\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t</FillViewport>\n\t\t\t\t<FillVideoFrame\n\t\t\t\t\tvideoAspectRatio={videoState.aspectRatio ?? 0}\n\t\t\t\t\tcontainerAspectRatio={uiState.containerAspectRatio}\n\t\t\t\t\tzoom={uiState.zoom}\n\t\t\t\t\tclassName={twJoin(videoState.aspectRatio != null ? 'opacity-100' : 'opacity-0')}\n\t\t\t\t>\n\t\t\t\t\t<Toolbars\n\t\t\t\t\t\tzoom={uiState.zoom}\n\t\t\t\t\t\ttoggleFullscreen={screenfull.isEnabled ? uiState.toggleFullscreen : null}\n\t\t\t\t\t\tisFullscreened={uiState.isFullscreened}\n\t\t\t\t\t\tsetZoom={uiState.setZoom}\n\t\t\t\t\t\tsetIsLockingCoordinates={uiState.setIsLockingCoordinates}\n\t\t\t\t\t\tsetCanMove={uiState.setCanMove}\n\t\t\t\t\t\tcanMove={uiState.canMove}\n\t\t\t\t\t\tfps={videoState.fps ?? 0}\n\t\t\t\t\t\tisConnected={isConnected}\n\t\t\t\t\t\tisLockingCoordinates={uiState.isLockingCoordinates}\n\t\t\t\t\t\turl={videoState.url}\n\t\t\t\t\t\tsetSettings={setSettings}\n\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\tisSettingsFetched={settingsQuery.isFetched}\n\t\t\t\t\t/>\n\t\t\t\t</FillVideoFrame>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","'use client';\n\nimport { FullLoadScreen } from '@/components/common/full-load-screen';\nimport { NoSSR } from '@/components/common/no-ssr';\nimport React from 'react';\nimport { VAOC } from '@/app/calibration/vaoc';\nimport { Spinner } from '@/components/common/spinner';\n\nexport default function Page() {\n\tconst fallback = (\n\t\t<div className=\"absolute inset-0 flex h-[calc(100vh_-_64px)] items-center justify-center\">\n\t\t\t<Spinner\n\t\t\t\tclassName=\"h-[40svh] w-[40svh] animate-spin transition-all dark:text-lime-400\"\n\t\t\t\tnoMargin={true}\n\t\t\t\tstrokeWidth={1}\n\t\t\t/>\n\t\t</div>\n\t);\n\treturn (\n\t\t<div className=\"flex h-full w-full items-center @container\">\n\t\t\t<React.Suspense fallback={fallback}>\n\t\t\t\t<NoSSR fallback={fallback}>\n\t\t\t\t\t<VAOC />\n\t\t\t\t</NoSSR>\n\t\t\t</React.Suspense>\n\t\t</div>\n\t);\n}\n","import { Spinner } from '@/components/common/spinner';\nimport { twJoin } from 'tailwind-merge';\n\nexport const FullLoadScreen = (props: { className?: string }) => {\n\treturn (\n\t\t<div className={twJoin('flex h-full w-full flex-1 items-center justify-center', props.className)}>\n\t\t\t<Spinner className=\"h-8 w-8\" />\n\t\t</div>\n\t);\n};\n","'use client';\n\nimport * as React from 'react';\nimport { Drawer as DrawerPrimitive } from 'vaul';\n\nimport { cn, setDisplayName } from '@/helpers/utils';\n\nconst Drawer = ({ shouldScaleBackground = true, ...props }: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n\t<DrawerPrimitive.Root shouldScaleBackground={shouldScaleBackground} {...props} />\n);\nDrawer.displayName = 'Drawer';\n\nconst DrawerTrigger = DrawerPrimitive.Trigger;\n\nconst DrawerPortal = DrawerPrimitive.Portal;\n\nconst DrawerClose = DrawerPrimitive.Close;\n\nconst DrawerOverlay = React.forwardRef<\n\tReact.ElementRef<typeof DrawerPrimitive.Overlay>,\n\tReact.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n\t<DrawerPrimitive.Overlay ref={ref} className={cn('fixed inset-0 z-50 bg-black/80', className)} {...props} />\n));\nsetDisplayName(DrawerOverlay, DrawerPrimitive.Overlay.displayName);\n\nconst DrawerContent = React.forwardRef<\n\tReact.ElementRef<typeof DrawerPrimitive.Content>,\n\tReact.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n\t<DrawerPortal>\n\t\t<DrawerOverlay />\n\t\t<DrawerPrimitive.Content\n\t\t\tref={ref}\n\t\t\tclassName={cn(\n\t\t\t\t'fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background outline-none focus:outline-none focus:ring-0 focus:ring-offset-0',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\t{...props}\n\t\t>\n\t\t\t<div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n\t\t\t{children}\n\t\t</DrawerPrimitive.Content>\n\t</DrawerPortal>\n));\nsetDisplayName(DrawerContent, 'DrawerContent');\n\nconst DrawerHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n\t<div className={cn('grid gap-1.5 p-4 text-center sm:text-left', className)} {...props} />\n);\nDrawerHeader.displayName = 'DrawerHeader';\n\nconst DrawerFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n\t<div className={cn('mt-auto flex flex-col gap-2 p-4', className)} {...props} />\n);\nDrawerFooter.displayName = 'DrawerFooter';\n\nconst DrawerTitle = React.forwardRef<\n\tReact.ElementRef<typeof DrawerPrimitive.Title>,\n\tReact.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n\t<DrawerPrimitive.Title\n\t\tref={ref}\n\t\tclassName={cn('text-lg font-semibold leading-none tracking-tight', className)}\n\t\t{...props}\n\t/>\n));\nsetDisplayName(DrawerTitle, DrawerPrimitive.Title.displayName);\n\nconst DrawerDescription = React.forwardRef<\n\tReact.ElementRef<typeof DrawerPrimitive.Description>,\n\tReact.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n\t<DrawerPrimitive.Description ref={ref} className={cn('text-sm text-muted-foreground', className)} {...props} />\n));\nsetDisplayName(DrawerDescription, DrawerPrimitive.Description.displayName);\n\nexport {\n\tDrawer,\n\tDrawerPortal,\n\tDrawerOverlay,\n\tDrawerTrigger,\n\tDrawerClose,\n\tDrawerContent,\n\tDrawerHeader,\n\tDrawerFooter,\n\tDrawerTitle,\n\tDrawerDescription,\n};\n","'use client';\nimport { useEffect, useState } from 'react';\n\nexport function useMediaQuery(query: string): boolean {\n\tconst mediaQueryList = typeof window !== 'undefined' ? window.matchMedia(query) : null;\n\tconst [matches, setMatches] = useState(mediaQueryList?.matches ?? false);\n\n\tuseEffect(() => {\n\t\tif (mediaQueryList == null) {\n\t\t\treturn;\n\t\t}\n\t\tconst handleChange = (event: MediaQueryListEvent) => {\n\t\t\tsetMatches(event.matches);\n\t\t};\n\n\t\tmediaQueryList.addEventListener('change', handleChange);\n\n\t\treturn () => {\n\t\t\tmediaQueryList.removeEventListener('change', handleChange);\n\t\t};\n\t}, [mediaQueryList]);\n\n\treturn matches;\n}\n","'use client';\n/* This example requires Tailwind CSS v2.0+ */\nimport React, { Fragment, ReactElement, useCallback, useState } from 'react';\n\nimport { Button } from '@/components/ui/button';\nimport {\n\tDialog,\n\tDialogContent,\n\tDialogDescription,\n\tDialogHeader,\n\tDialogTitle,\n\tDialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n\tDrawer,\n\tDrawerClose,\n\tDrawerContent,\n\tDrawerDescription,\n\tDrawerFooter,\n\tDrawerHeader,\n\tDrawerTitle,\n\tDrawerTrigger,\n} from '@/components/ui/drawer';\nimport { useMediaQuery } from '@/hooks/useMediaQuery';\nimport { Spinner } from '@/components/common/spinner';\nimport { Check, Cross } from 'lucide-react';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport { toast } from 'sonner';\nimport { ButtonProps, ButtonVariantProps } from '@/components/common/button';\nimport { AnimatedContainer } from '@/components/common/animated-container';\n\nexport interface ModalProps extends React.PropsWithChildren {\n\ttitle: string;\n\ttitleActions?: React.ReactNode;\n\tbody: string;\n\twide?: boolean | 'screen';\n\tisLoading?: boolean;\n\tcontent?: React.ReactNode;\n\tsuccess?: boolean;\n\tbuttonLabel?: string;\n\tbuttonVariant?: ButtonVariantProps['variant'];\n\tnoClose?: boolean;\n\tsecondButtonLabel?: string;\n\tdismissText?: string;\n\tdismissVariant?: ButtonVariantProps['variant'];\n\tsecondButtonVariant?: ButtonVariantProps['variant'];\n\tonClick?: () => any | Promise<any>;\n\tonClickSecondButton?: () => any | Promise<any>;\n\tonClose?: () => void;\n\tonClosed?: () => void;\n\tbuttons?: ReactElement<ButtonProps<string>>[];\n}\n\nexport interface ModalButtonProps<T extends string> {\n\tbutton: ReactElement<ButtonProps<T>>;\n\thide: () => void;\n}\n\nexport const ModalButton = <T extends string>(props: ModalButtonProps<T>) => {\n\tconst [isCompletingClick, setIsCompletingClick] = useState<1 | 2 | false>(false);\n\tconst { hide } = props;\n\tconst { onClick, children } = props.button.props;\n\tconst onButtonClick = useCallback(async () => {\n\t\tconst clickRes = onClick?.() as any | Promise<any>;\n\t\tif (clickRes instanceof Promise) {\n\t\t\tsetIsCompletingClick(1);\n\t\t\ttry {\n\t\t\t\tawait clickRes;\n\t\t\t\thide();\n\t\t\t} catch (e) {\n\t\t\t\tif (e instanceof Error) {\n\t\t\t\t\ttoast.error(e.message);\n\t\t\t\t}\n\t\t\t\tthrow e;\n\t\t\t} finally {\n\t\t\t\tsetIsCompletingClick(false);\n\t\t\t}\n\t\t} else {\n\t\t\thide();\n\t\t}\n\t}, [onClick, hide]);\n\treturn React.cloneElement(props.button, {\n\t\tonClick: onButtonClick,\n\t\tstyle: { direction: 'ltr' },\n\t\tchildren: (\n\t\t\t<>\n\t\t\t\t{children}\n\t\t\t\t{isCompletingClick === 1 && <Spinner className=\"inline-block\" noMargin={true} />}\n\t\t\t</>\n\t\t),\n\t});\n};\n\nexport function Modal(props: ModalProps) {\n\tconst { onClick, onClose: _onClose, onClosed, onClickSecondButton } = props;\n\tconst [open, setOpen] = useState(props.children == null);\n\tconst hide = useCallback(() => {\n\t\t_onClose?.();\n\t\tsetOpen(false);\n\t\tif (onClosed) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tonClosed();\n\t\t\t}, 250);\n\t\t}\n\t}, [onClosed, _onClose]);\n\n\tconst show = useCallback(() => {\n\t\tsetOpen(true);\n\t}, []);\n\n\tconst success = props.isLoading ? (\n\t\t<div className=\"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-700\">\n\t\t\t<Spinner className=\"h-6 w-6\" noMargin={true} aria-hidden=\"true\" />\n\t\t</div>\n\t) : props.success === true ? (\n\t\t<div className=\"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-lime-100 dark:bg-lime-700\">\n\t\t\t<Check className=\"h-6 w-6 text-lime-600 dark:text-lime-100\" aria-hidden=\"true\" />\n\t\t</div>\n\t) : props.success === false ? (\n\t\t<div className=\"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-rose-100 dark:bg-rose-700\">\n\t\t\t<Cross className=\"h-6 w-6 text-rose-600 dark:text-rose-100\" aria-hidden=\"true\" />\n\t\t</div>\n\t) : null;\n\tconst isDesktop = useMediaQuery('(min-width: 768px)');\n\n\tconst buttons = props.buttons ?? [];\n\tif (props.buttonLabel && onClick) {\n\t\tbuttons.push(\n\t\t\t<Button variant={props.buttonVariant ?? 'info'} onClick={onClick}>\n\t\t\t\t{props.buttonLabel}\n\t\t\t</Button>,\n\t\t);\n\t}\n\tif (props.secondButtonLabel && onClickSecondButton) {\n\t\tbuttons.push(\n\t\t\t<Button variant={props.secondButtonVariant ?? 'indeterminate'} onClick={onClickSecondButton}>\n\t\t\t\t{props.secondButtonLabel}\n\t\t\t</Button>,\n\t\t);\n\t}\n\n\tif (isDesktop) {\n\t\treturn (\n\t\t\t<Dialog\n\t\t\t\topen={open}\n\t\t\t\tonOpenChange={(val) => {\n\t\t\t\t\tif (!val) {\n\t\t\t\t\t\thide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshow();\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{props.children && <DialogTrigger asChild>{props.children}</DialogTrigger>}\n\t\t\t\t<DialogContent\n\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\tprops.wide === 'screen' ? 'max-w-screen-2xl' : props.wide ? 'max-w-6xl' : 'max-w-[600px]',\n\t\t\t\t\t\t'flex max-h-[90vh] flex-col',\n\t\t\t\t\t)}\n\t\t\t\t\tnoClose={props.noClose}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"flex flex-grow-0 items-center gap-4\">\n\t\t\t\t\t\t{success}\n\t\t\t\t\t\t<DialogHeader className=\"flex-1\">\n\t\t\t\t\t\t\t<DialogTitle className=\"flex items-center\">\n\t\t\t\t\t\t\t\t<div className=\"flex-1\">{props.title}</div>\n\t\t\t\t\t\t\t\t{props.titleActions && <div className=\"shrink-0\">{props.titleActions}</div>}\n\t\t\t\t\t\t\t</DialogTitle>\n\t\t\t\t\t\t\t<DialogDescription>{props.body}</DialogDescription>\n\t\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t</div>\n\t\t\t\t\t<AnimatedContainer\n\t\t\t\t\t\tcontainerClassName=\"flex-1 flex\"\n\t\t\t\t\t\tclassName=\"scrollable -mr-4 grid flex-1 gap-2 overflow-hidden overflow-y-scroll pr-1.5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{props.content}\n\t\t\t\t\t</AnimatedContainer>\n\t\t\t\t\t<div\n\t\t\t\t\t\tstyle={{ direction: 'rtl' }}\n\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t'grid flex-grow-0 grid-flow-col justify-end gap-2',\n\t\t\t\t\t\t\tbuttons.length > 1 || props.wide === 'screen'\n\t\t\t\t\t\t\t\t? 'grid-cols-3 lg:grid-cols-4 xl:grid-cols-5'\n\t\t\t\t\t\t\t\t: buttons.length === 1\n\t\t\t\t\t\t\t\t\t? 'grid-cols-2'\n\t\t\t\t\t\t\t\t\t: 'grid-cols-1',\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Button variant={props.dismissVariant ?? 'outline'} onClick={hide} style={{ direction: 'revert' }}>\n\t\t\t\t\t\t\t{props.dismissText ?? 'Cancel'}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{buttons.map((button, i) => (\n\t\t\t\t\t\t\t<ModalButton button={button} key={i} hide={hide} />\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Drawer\n\t\t\topen={open}\n\t\t\tonOpenChange={(val) => {\n\t\t\t\tif (!val) {\n\t\t\t\t\thide();\n\t\t\t\t} else {\n\t\t\t\t\tshow();\n\t\t\t\t}\n\t\t\t}}\n\t\t>\n\t\t\t{props.children && <DrawerTrigger asChild>{props.children}</DrawerTrigger>}\n\t\t\t<DrawerContent className=\"flex max-h-[90vh] flex-col\">\n\t\t\t\t<DrawerHeader className=\"flex flex-grow-0 items-center gap-4 text-left\">\n\t\t\t\t\t{success}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<DrawerTitle>{props.title}</DrawerTitle>\n\t\t\t\t\t\t<DrawerDescription>{props.body}</DrawerDescription>\n\t\t\t\t\t</div>\n\t\t\t\t</DrawerHeader>\n\t\t\t\t{props.content && (\n\t\t\t\t\t<div className=\"scrollable col-span-2 -mr-4 grid flex-1 gap-2 overflow-hidden overflow-y-scroll px-4 pb-2\">\n\t\t\t\t\t\t{props.content}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<DrawerFooter className=\"flex-grow-0 pt-2\">\n\t\t\t\t\t{buttons.map((button, i) => (\n\t\t\t\t\t\t<ModalButton button={button} key={i} hide={hide} />\n\t\t\t\t\t))}\n\t\t\t\t\t<DrawerClose asChild>\n\t\t\t\t\t\t<Button variant={props.dismissVariant ?? 'outline'} onClick={hide}>\n\t\t\t\t\t\t\t{props.dismissText ?? 'Cancel'}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DrawerClose>\n\t\t\t\t</DrawerFooter>\n\t\t\t</DrawerContent>\n\t\t</Drawer>\n\t);\n}\n","'use client';\nimport { useIsClient } from '@/hooks/isClient';\nimport dynamic from 'next/dynamic';\nimport React, { lazy } from 'react';\nimport { FullLoadScreen } from '@/components/common/full-load-screen';\nexport const NoSSR = (props: React.PropsWithChildren<{ fallback?: React.ReactNode }>) => {\n\tconst isClient = useIsClient();\n\treturn isClient ? <DynamicImport>{props.children}</DynamicImport> : props.fallback ?? <FullLoadScreen />;\n};\nconst DynamicImport = lazy(() =>\n\tPromise.resolve({ default: (props: React.PropsWithChildren) => <>{props.children}</> }),\n);\n","import { twMerge } from 'tailwind-merge';\n\nexport const ScrollContainer = (props: JSX.IntrinsicElements['div']) => {\n\treturn <div {...props} className={twMerge('scrollable', props.className)} />;\n};\n","import { EyeIcon, EyeSlashIcon } from '@heroicons/react/24/outline';\nimport { ExclamationCircleIcon } from '@heroicons/react/24/solid';\nimport { Label } from '@radix-ui/react-label';\nimport objectHash from 'object-hash';\nimport React, { ChangeEvent, useCallback, useRef, useState } from 'react';\nimport { twJoin } from 'tailwind-merge';\nimport { Input } from '@/components/ui/input';\n\ninterface TextInputProps<T extends string | number>\n\textends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'onChange'> {\n\terror?: string;\n\tlabel: string;\n\thelp?: string;\n\tvalue?: T;\n\tonChange?: (val: T) => void;\n}\n\nexport const TextInput = <T extends string | number>(props: TextInputProps<T>) => {\n\tconst fieldId = useRef(objectHash(props));\n\tconst { onChange: _onChange } = props;\n\tconst [isPasswordVisible, setIsPasswordVisible] = useState(false);\n\n\tlet iconClass = twJoin('h-5 w-5', props.error ? 'text-red-500' : 'text-red-500');\n\n\tconst icon = props.error ? (\n\t\t<div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3\">\n\t\t\t<ExclamationCircleIcon className=\"h-5 w-5 text-red-500\" aria-hidden=\"true\" />\n\t\t</div>\n\t) : null;\n\n\tconst inputClass = twJoin(\n\t\tprops.error &&\n\t\t\t'border-red-300 text-red-900 placeholder-red-300 ring-red-500 dark:ring-red-500 dark:text-red-400 dark:placeholder-red-700',\n\t);\n\n\tconst error = props.error ? (\n\t\t<p className=\"mt-2 text-sm text-red-600 dark:text-red-400\" id={fieldId.current + '-error'}>\n\t\t\t{props.error}\n\t\t</p>\n\t) : null;\n\n\tconst help = props.help ? (\n\t\t<p className=\"mt-2 text-sm text-zinc-500\" id=\"email-description\">\n\t\t\t{props.help}\n\t\t</p>\n\t) : null;\n\n\tconst onChange = useCallback(\n\t\t(e: ChangeEvent<HTMLInputElement>) => {\n\t\t\t_onChange?.(props.type === 'number' ? (parseFloat(e.currentTarget.value) as T) : (e.currentTarget.value as T));\n\t\t},\n\t\t[_onChange, props.type],\n\t);\n\n\tconst togglePasswordVisibility = useCallback(() => {\n\t\tsetIsPasswordVisible((b) => !b);\n\t}, []);\n\n\tconst iconRight = icon != null ? 'right-6' : 'right-0';\n\tconst visibility =\n\t\tprops.type === 'password' ? (\n\t\t\t<div\n\t\t\t\tonClick={togglePasswordVisibility}\n\t\t\t\tclassName={`absolute inset-y-0 ${iconRight} flex cursor-pointer items-center pr-3`}\n\t\t\t>\n\t\t\t\t{isPasswordVisible ? (\n\t\t\t\t\t<EyeSlashIcon className=\"h-5 w-5 text-zinc-400\" />\n\t\t\t\t) : (\n\t\t\t\t\t<EyeIcon className=\"h-5 w-5 text-zinc-400\" />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t) : null;\n\n\treturn (\n\t\t<div>\n\t\t\t<Label className=\"block text-sm font-semibold leading-6 text-zinc-700 dark:text-zinc-300\">{props.label}</Label>\n\t\t\t<div className=\"relative rounded-md shadow-sm\">\n\t\t\t\t<Input\n\t\t\t\t\t{...props}\n\t\t\t\t\ttype={isPasswordVisible ? 'text' : props.type}\n\t\t\t\t\tclassName={inputClass}\n\t\t\t\t\tplaceholder={props.placeholder}\n\t\t\t\t\tdefaultValue={props.defaultValue}\n\t\t\t\t\tvalue={props.value}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t\tvariant={props.error ? 'error' : 'default'}\n\t\t\t\t\taria-invalid={!!props.error}\n\t\t\t\t\taria-describedby={props.error ? fieldId.current + '-error' : undefined}\n\t\t\t\t/>\n\t\t\t\t{icon}\n\t\t\t\t{visibility}\n\t\t\t</div>\n\t\t\t{error ?? help}\n\t\t</div>\n\t);\n};\n","import { Switch } from '@headlessui/react';\nimport React from 'react';\nimport { twJoin, twMerge } from 'tailwind-merge';\n\ninterface ToggleProps {\n\tlabel: string;\n\tonLabel?: string;\n\tdescription?: string;\n\tvalue: boolean;\n\tonChange: (value: boolean) => void;\n}\n\nexport const Toggle: React.FC<ToggleProps> = (props) => {\n\treturn (\n\t\t<Switch.Group as=\"div\" className=\"flex items-center justify-between gap-x-2\">\n\t\t\t<span className=\"flex flex-grow flex-col\">\n\t\t\t\t<Switch.Label\n\t\t\t\t\tas=\"span\"\n\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t'text-sm font-medium leading-6 text-zinc-700 dark:text-zinc-300',\n\t\t\t\t\t\tprops.onLabel && props.value && 'opacity-70',\n\t\t\t\t\t\tprops.onLabel && !props.value && 'text-brand-700 dark:text-brand-500',\n\t\t\t\t\t)}\n\t\t\t\t\tpassive\n\t\t\t\t>\n\t\t\t\t\t{props.label}\n\t\t\t\t</Switch.Label>\n\t\t\t\t{props.description && (\n\t\t\t\t\t<Switch.Description as=\"span\" className=\"text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t{props.description}\n\t\t\t\t\t</Switch.Description>\n\t\t\t\t)}\n\t\t\t</span>\n\t\t\t<Switch\n\t\t\t\tchecked={props.value}\n\t\t\t\tonChange={props.onChange}\n\t\t\t\tclassName={twJoin(\n\t\t\t\t\tprops.value && props.onLabel == null ? 'bg-brand-600' : 'bg-zinc-200 dark:bg-zinc-950/50',\n\t\t\t\t\t'relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-brand-400 focus:ring-offset-2 focus:ring-offset-zinc-900',\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<span\n\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\tprops.value ? 'translate-x-5' : 'translate-x-0',\n\t\t\t\t\t\t'pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow-md shadow-black/20 ring-0 transition duration-200 ease-in-out dark:border-t dark:border-zinc-600 dark:bg-zinc-700 dark:shadow-black/100 ',\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Switch>\n\t\t\t{props.onLabel && (\n\t\t\t\t<span className=\"flex flex-grow flex-col\">\n\t\t\t\t\t<Switch.Label\n\t\t\t\t\t\tas=\"span\"\n\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t'text-sm font-medium leading-6 text-zinc-700 dark:text-zinc-300',\n\t\t\t\t\t\t\tprops.onLabel && !props.value && 'opacity-70',\n\t\t\t\t\t\t\tprops.onLabel && props.value && 'text-brand-700 dark:text-brand-500',\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tpassive\n\t\t\t\t\t>\n\t\t\t\t\t\t{props.onLabel}\n\t\t\t\t\t</Switch.Label>\n\t\t\t\t</span>\n\t\t\t)}\n\t\t</Switch.Group>\n\t);\n};\n","import { Button, buttonVariants } from '@/components/common/button';\nimport { setDisplayName } from '@/helpers/utils';\n\nsetDisplayName(Button, 'Button');\n\nexport { Button, buttonVariants };\n","import * as React from 'react';\n\nimport { cn, setDisplayName } from '@/helpers/utils';\nimport { VariantProps, cva } from 'class-variance-authority';\nimport { twJoin } from 'tailwind-merge';\n\nconst InputVariants = cva(\n\ttwJoin(\n\t\t'flex w-full rounded-md border bg-transparent px-3 py-1.5 text-sm shadow-sm transition-colors',\n\t\t'file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground',\n\t\t'border-zinc-300 text-zinc-900 placeholder-zinc-300 ring-brand-600 dark:border-zinc-100/20 dark:text-zinc-100 dark:placeholder-zinc-100/30 dark:focus:ring-brand-400 ',\n\t\t'focus:ring-offset-zinc-900 block w-full rounded-md border text-left shadow-sm ring-inset ring-offset-zinc-900 transition-all focus:outline-none focus:ring-2 focus:ring-offset-2',\n\t\t'active:translate-y-px active:scale-[99%] active:outline-none active:ring-2 active:ring-offset-2',\n\t\t'disabled:cursor-not-allowed disabled:opacity-50',\n\t),\n\t{\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tplain: 'shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 dark:bg-transparent',\n\t\t\t\tdefault: 'dark:bg-zinc-800 bg-white',\n\t\t\t\terror:\n\t\t\t\t\t'border-red-300 text-red-900 placeholder-red-300 ring-red-500 dark:ring-red-500 dark:text-red-400 dark:placeholder-red-700',\n\t\t\t},\n\t\t},\n\t\tdefaultVariants: {\n\t\t\tvariant: 'plain',\n\t\t},\n\t},\n);\n\nexport interface InputProps extends React.InputHTMLAttributes<HTMLInputElement>, VariantProps<typeof InputVariants> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(({ className, type, ...props }, ref) => {\n\treturn <input type={type} className={cn(InputVariants(props), className)} ref={ref} {...props} />;\n});\nsetDisplayName(Input, 'Input');\n\nexport { Input };\n","import { ExclamationCircleIcon } from '@heroicons/react/24/solid';\nimport React from 'react';\nimport { Banner } from '@/components/common/banner';\n\ninterface WarningMessageProps extends React.PropsWithChildren {\n\ttitle?: string;\n\tclassName?: string;\n}\n\nexport const WarningMessage: React.FC<WarningMessageProps> = (props) => {\n\treturn (\n\t\t<Banner\n\t\t\tcolor=\"yellow\"\n\t\t\tIcon={ExclamationCircleIcon}\n\t\t\ttitle={props.title ? 'Warning: ' + props.title : 'Warning'}\n\t\t\tclassName={props.className}\n\t\t>\n\t\t\t{props.children}\n\t\t</Banner>\n\t);\n};\n","import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport function cn(...inputs: ClassValue[]) {\n\treturn twMerge(clsx(inputs));\n}\n\nexport function setDisplayName(Component: React.ComponentType<any>, name: string | undefined) {\n\t(Component as any).displayName = name;\n}\n","'use client';\nimport { useEffect, useState } from 'react';\n\nexport const useIsClient = () => {\n\tconst [isClient, setIsClient] = useState(false);\n\tuseEffect(() => {\n\t\tif (typeof window !== 'undefined') {\n\t\t\tsetIsClient(true);\n\t\t}\n\t}, []);\n\treturn isClient;\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\n\nexport const useChangeEffect = (deps: unknown[], clearAfter?: number, resetTimeoutOnChange: boolean = false) => {\n\tconst [hasChanged, setHasChanged] = useState(0);\n\tconst lastDeps = useRef([...deps]);\n\tuseEffect(() => {\n\t\tlet changed = false;\n\t\tlastDeps.current.forEach((dep, i) => {\n\t\t\tif (dep !== deps[i]) {\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\t\tif (changed) {\n\t\t\tsetHasChanged((hasChanged) => (resetTimeoutOnChange ? hasChanged + 1 : 1));\n\t\t}\n\t\tlastDeps.current = [...deps];\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [...deps]);\n\n\tconst clear = useCallback(() => {\n\t\tsetHasChanged(0);\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (clearAfter != null && hasChanged > 0) {\n\t\t\tconst timeout = setTimeout(() => {\n\t\t\t\tsetHasChanged(0);\n\t\t\t}, clearAfter);\n\t\t\treturn () => {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t};\n\t\t}\n\t\treturn;\n\t}, [clearAfter, hasChanged]);\n\n\treturn [hasChanged > 0, clear] as const;\n};\n\nexport const useDelayedChangeEffect = (\n\tdeps: unknown[],\n\tdelay: number,\n\tclearAfter?: number,\n\tresetTimeoutOnChange: boolean = false,\n) => {\n\tconst [changeCount, setChangeCount] = useState(0);\n\tconst lastDeps = useRef([...deps]);\n\tconst timeout = useRef<number | null>(null);\n\tuseEffect(() => {\n\t\tif (typeof window === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tlet changed = false;\n\t\tlastDeps.current.forEach((dep, i) => {\n\t\t\tif (dep !== deps[i]) {\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\t\tif (changed) {\n\t\t\tconst trigger = () => setChangeCount((hasChanged) => (resetTimeoutOnChange ? hasChanged + 1 : 1));\n\t\t\ttimeout.current = window.setTimeout(() => {\n\t\t\t\ttrigger();\n\t\t\t\ttimeout.current = null;\n\t\t\t}, delay);\n\t\t}\n\t\tlastDeps.current = [...deps];\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [...deps]);\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (timeout.current) {\n\t\t\t\tclearTimeout(timeout.current);\n\t\t\t}\n\t\t};\n\t}, []);\n\tconst [hasChanged, clear] = useChangeEffect([changeCount], clearAfter, resetTimeoutOnChange);\n\treturn [hasChanged, clear] as const;\n};\n"],"names":["Promise","resolve","then","__webpack_require__","bind","useGcodeCommand","executeGcode","useMoonrakerMutation","useCallback","command","args","result","forEach","arg","i","push","toString","gcode","join","console","log","gcodeRes","mutateAsync","script","initialCameraSettings","pixelPrMm","outerNozzleDiameter","flipVertical","flipHorizontal","VaocSettingsDialog","settings","setSettings","isSettingsFetched","props","hasLoaded","useRef","setPixelPrMm","useState","toFixed","setOuterNozzleDiameter","debouncedSettings","useDebounce","useEffect","current","jsx_runtime","jsxs","ScrollContainer","className","twMerge","isVisible","onWheel","e","stopPropagation","h3","jsx","span","XMarkIcon","onClick","toggle","div","TextInput","label","type","value","placeholder","undefined","onChange","parsed","parseFloat","isNaN","s","error","step","Toggle","description","parseOptions","ints","options","matchAll","match","min","max","slice","split","map","parseInt","n","existing","find","o","key","includes","floats","float","bools","useWindowSize","windowSize","setWindowSize","width","window","innerWidth","height","innerHeight","handleResize","requestAnimationFrame","addEventListener","removeEventListener","getCameraUrl","host","getHost","trim","concat","useUIState","containerAspectRatio","setContainerAspectRatio","containerRef","useCallbackRef","newRef","oldRef","getBoundingClientRect","rootRef","useResizeObserver","entry","contentRect","isFullscreened","setIsFullscreened","toggleFullscreen","screenfull","isEnabled","request","exit","isFullscreen","on","off","canMove","setCanMove","isLockingCoordinates","setIsLockingCoordinates","_zoom","_setZoom","useLocalStorage","zoomRef","zoom","setZoom","newZoom","updater","useSpatialMapping","videoRef","containerSize","setContainerSize","scale","vidWidth","videoWidth","frameWidth","val","invert","toScreen","toMillimeters","rect","useGestures","gestureRef","isConnected","dragOffset","setDragOffset","dragOutside","setDragOutside","x","y","G","useGesture","onDrag","state","dragging","offset","_movementBound","onPinch","Math","z","delta","wheeling","intentional","target","enabled","drag","from","bounds","left","right","top","bottom","rubberband","wheel","axis","pinch","scaleBounds","pinchOnWheel","scaledDragOffset","isDragging","useCrossHairState","_this","configFile","SnapshotEffectDuration","snapshotDuration","usePrinterObjectQuery","t0","usePrinterObjectSubscription","active","res","t1","tool","useChangeEffect","delayedIsLockingCoordinates","useDelayedChangeEffect","nozzleDiameter","data","configfile","nozzle_diameter","nozzleRadius","useMemo","canRender","outerNozzleRadius","outerNozzleRadiusPercentWidth","outerNozzleRadiusPercentHeight","crosshairStrokeWidth","useVideoState","url","setUrl","fps","setFps","aspectRatio","setAspectRatio","onStreamStats","stats","framesPerSecond","frameHeight","useStreamSettings","saveSettings","isInitialLoading","isFetched","param","setOptions","settingsRef","mergedOptions","opt","compression","fetch","text","setOption","intVal","ok","getLogger","info","merge","ExposureIcon","svg","viewBox","xmlns","path","fill","d","polygon","points","FocusControls","livePosition","motion_report","live_position","ol","li","twJoin","button","ChevronsUp","aria-hidden","ChevronUp","ChevronDown","ChevronsDown","animationOptions","duration","Button","animateRef","useAutoAnimate","isLoading","setIsLoading","React","_setIsLoading","_onClick","subButtonPosition","ref","children","isActive","title","hidden","icon","Spinner","noMargin","name","id","Toolbar","nav","aria-label","role","buttons","subButtons","filter","b","parent","react","createElement","length","subButton","Slider","initialValue","isBoolean","setValue","_onChange","onInput","input","StreamSettingsDialog","isAdvancedVisible","isColorVisible","isExposureVisible","streamSettings","saveStreamSettings","streamSettingsQuery","useMoonrakerState","animate","motion","toLowerCase","startsWith","option","EnterFullscreenIcon","fillRule","clipRule","ExitFullscreenIcon","useToolbarState","isStartingVaoc","setIsStartingVaoc","isSettingsVisible","setIsSettingsVisible","setIsExposureVisible","setIsColorVisible","isFocusVisible","setIsFocusVisible","setIsAdvancedVisible","light","setLight","_isZoomExpanded","_setIsZoomExpanded","isCameraControlsVisible","setIsCameraControlsVisible","tempZoomExpand","clearTempZoomExpand","toggleIsZoomExpanded","isVaocStarted","is_started","hasZOffsetProbe","z_offset_probe","isZoomExpanded","isZOffsetProbeVisible","Toolbars","handleCommandError","fn","opts","success","message","fallbackDescription","Error","toast","always","isLoadingTool","isCalibratingExpansion","setIsCalibratingExpansion","showCleanNozzleConfirmation","setShowCleanNozzleConfirmation","topLeftControls","Square","Play","wasStarted","topRightControls","ScanSearch","Fragment","CountUp","preserveValue","start","end","round","FlashlightOff","Flashlight","newVal","bottomLeftControls","Cog","vis","SunSnow","ArrowDownToLine","cameraControls","controls","Camera","Focus","cameraControlsSubButtons","SwatchIcon","BeakerIcon","reverse","confirmCleanNozzleModal","Modal","body","content","WarningMessage","buttonLabel","dismissText","onClose","setTimeout","SafetyVisualization","gestureState","style","opacity","abs","transform","FillViewport","FillVideoFrame","videoAspectRatio","CrossHair","g","shapeRendering","circle","cx","cy","r","strokeWidth","VAOC","videoState","connectionState","useWebRTC","videoElRef","audioElRef","peerConnection","urlRef","isConnecting","setConnectionState","remotePCId","onIceCandidate","candidate","JSON","stringify","candidates","headers","method","catch","connect","close","config","sdpSemantics","document","getElementById","checked","iceServers","urls","urlSearchParams","URLSearchParams","params","Object","fromEntries","entries","response","parsedResponse","json","RTCPeerConnection","addTransceiver","direction","evt","track","kind","srcObject","streams","conState","setRemoteDescription","answer","createAnswer","setLocalDescription","iceGatheringState","checkState","offer","localDescription","sdp","interval","setInterval","getStats","report","clearInterval","reconnectTimeout","clearTimeout","audioRef","settingsQuery","uiState","spatialMapping","videoScaleX","videoScaleY","videoTranslationX","videoTranslationY","video","autoPlay","muted","playsInline","Page","fallback","NoSSR","FullLoadScreen","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","Drawer","shouldScaleBackground","DrawerPrimitive","Root","displayName","DrawerTrigger","Trigger","DrawerPortal","Portal","DrawerClose","Close","DrawerOverlay","Overlay","cn","setDisplayName","DrawerContent","Content","DrawerHeader","DrawerFooter","DrawerTitle","Title","DrawerDescription","Description","ModalButton","isCompletingClick","setIsCompletingClick","hide","onButtonClick","clickRes","_onClose","onClosed","onClickSecondButton","open","setOpen","show","Check","Cross","isDesktop","useMediaQuery","query","mediaQueryList","matchMedia","matches","setMatches","handleChange","event","variant","buttonVariant","secondButtonLabel","secondButtonVariant","Dialog","onOpenChange","DialogTrigger","asChild","DialogContent","wide","noClose","DialogHeader","DialogTitle","titleActions","DialogDescription","AnimatedContainer","containerClassName","dismissVariant","isClient","useIsClient","DynamicImport","lazy","default","fieldId","objectHash","isPasswordVisible","setIsPasswordVisible","ExclamationCircleIcon","inputClass","p","help","currentTarget","togglePasswordVisibility","visibility","EyeSlashIcon","EyeIcon","Label","Input","defaultValue","aria-invalid","aria-describedby","Switch","Group","as","onLabel","passive","InputVariants","cva","variants","plain","defaultVariants","Banner","color","Icon","_len","arguments","inputs","_key","clsx","Component","setIsClient","deps","clearAfter","resetTimeoutOnChange","hasChanged","setHasChanged","lastDeps","changed","dep","clear","timeout","delay","changeCount","setChangeCount","trigger"],"sourceRoot":""}