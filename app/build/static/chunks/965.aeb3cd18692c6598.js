!function(){var e,t,r,n,i,a,o={647:function(){},55023:function(){},7637:function(){},95772:function(){},77922:function(){},3186:function(){},62494:function(){},69489:function(e,t,r){"use strict";r.d(t,{vy:function(){return l}});var n=r(32307),i=r(66066),a=r(55237),o=r(28967);let JobCancelledError=class JobCancelledError extends Error{constructor(){super("Job cancelled")}};let u=new Map,c=0,l={DEFAULT_DAMPING_RATIO:.1,SHAPER_VIBRATION_REDUCTION:20,TEST_DAMPING_RATIOS:[.075,.1,.15],MAX_SHAPER_FREQ:150,WINDOW_T_SEC:.5,MIN_FREQ:5,MAX_FREQ:200,TARGET_SMOOTHING:.12},cancelJob=e=>{let t=u.get(e);t&&!1===t.signal.aborted&&t.abort(),u.delete(e)},throwIfCancelled=e=>{if(e.aborted)throw new JobCancelledError};async function getShaperSmoothing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=.5*t,[i,a]=e,u=1/(0,o.P0)(i),c=a.length,l=(0,o.P0)(i.map((e,t)=>e*a[t]))*u,s=0,_=0;for(let e=0;e<c;e++)a[e]>=l&&(s+=i[e]*(r+n*(a[e]-l))*(a[e]-l)),_+=i[e]*n*(a[e]-l)**2;return Math.max(s*=u*Math.sqrt(2),_*=u)}async function bisect(e){let t=1,r=1;if(!await e(1e-9))return 0;for(;!await e(t);)r=t,t*=.5;if(r===t)for(;await e(r);)r*=2;for(;r-t>1e-8;){let n=(t+r)*.5;await e(n)?t=n:r=n}return t}async function findShaperMaxAccel(e,t){let r=await bisect(async r=>await getShaperSmoothing(e,r,t)<=l.TARGET_SMOOTHING);return r}async function estimateRemainingVibrations(e,t,r,i){let a=(0,n.lub)(()=>{let i=(0,n.RRF)(e[0]),a=(0,n.RRF)(e[1]),o=(0,n.hiC)(1,(0,n.Smz)(i)),u=(0,n.dC7)((0,n.dC7)(r,2),Math.PI),c=(0,n.dC7)(u,t),l=(0,n.dC7)(u,Math.sqrt(1-t**2)),s=(0,n.dC7)(i,(0,n.Qqt)((0,n.N2O)((0,n.dC7)(c,-1),(0,n.luU)((0,n.tPi)(a,a.size-1,1),a)))),_=(0,n.dC7)(s,(0,n.O$l)((0,n.N2O)(l,a))),f=(0,n.dC7)(s,(0,n.mCk)((0,n.N2O)(l,a)));return(0,n.dC7)((0,n._b3)((0,n.Smz)((0,n.knu)([(0,n.sQ3)((0,n.Smz)(_,1),2),(0,n.sQ3)((0,n.Smz)(f,1),2)]),0)),o)}),o=await (0,n.lub)(()=>{let e=(0,n.hiC)((0,n.Fp7)(i),l.SHAPER_VIBRATION_REDUCTION),t=(0,n.Smz)((0,n.Fp7)((0,n.luU)((0,n.dC7)(a,i),e),0)),r=(0,n.Smz)((0,n.Fp7)((0,n.luU)(i,e),0));return(0,n.hiC)(t,r)}).array();return[o,a]}let range=(e,t,r)=>Array.from({length:(t-e)/r+1},(t,n)=>e+n*r);async function fitShaper(e,t,r,i,a){var u,c,s;let _=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[null,null,null],f=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0,h=arguments.length>9?arguments[9]:void 0,m=arguments.length>10?arguments[10]:void 0;f=f||l.DEFAULT_DAMPING_RATIO,d=d||l.TEST_DAMPING_RATIOS;let w=null!==(u=_[1])&&void 0!==u?u:l.MAX_SHAPER_FREQ,b=Math.min(null!==(c=_[0])&&void 0!==c?c:r.minFreq,w-1e-7),g=null!==(s=_[2])&&void 0!==s?s:.2;throwIfCancelled(t),h=Math.max(h||l.MAX_FREQ,w);let v=(0,n.jZU)(i.frequencies,0,i.frequencies.length),y=(0,n.jZU)(v,0,i.frequencies.findIndex(e=>e>h)),T=(0,n.jZU)(i.estimates,0,v.size);v.dispose();let k=(0,n.lls)([T.size]),q=(await Promise.all(range(b,w,10).map(async e=>{if(r.minFreq>e)return null;let i=r.initFunc(e,f),a=0,o=k.clone();for(let e of d){let[r,u]=await estimateRemainingVibrations(i,e,y,T);throwIfCancelled(t);let c=o;o=(0,n.lub)(()=>(0,n.Fp7)((0,n.knu)([c,u]),0)),c.dispose(),r>a&&(a=r)}return a<.15?e:null}))).filter(Boolean);throwIfCancelled(t);let M=range(Math.min(...q),Math.max(...q),g),S=new Map,reportProgress=(t,n)=>{S.set(t,n);let i=(0,o.P0)(Array.from(S.values()))/M.length;postMessage({type:"fitShaperProgress",model:r.name,progress:i,jobId:e}),null==m||m(r.name,i)},C=(await Promise.all(M.reverse().map(async(e,i)=>{reportProgress(e,0),throwIfCancelled(t);let o=0,u=k.clone(),c=r.initFunc(e,f),l=await getShaperSmoothing(c,void 0,a);if(throwIfCancelled(t),p&&l>p)return null;for(let e of(reportProgress(i,1/3),d)){let[r,i]=await estimateRemainingVibrations(c,e,y,T);throwIfCancelled(t);let a=u;u=(0,n.lub)(()=>(0,n.Fp7)((0,n.knu)([a,i]),0)),a.dispose(),r>o&&(o=r)}reportProgress(i,2/3);let s=await findShaperMaxAccel(c,a);throwIfCancelled(t);let _=l*(Math.pow(o,1.5)+.2*o+.01),h=await u.array(),m=await (0,n.dC7)(T,u).array();reportProgress(i,1);let w={name:r.name,freq:e,vals:h,psd:m,vibrs:o,smoothing:l,score:_,color:r.color,maxAccel:s};return w}))).reduce((e,t)=>(null===t||(null==e||t.vibrs<1.1*e.vibrs&&t.score<e.score)&&(e=t),e),null);return y.dispose(),T.dispose(),k.dispose(),throwIfCancelled(t),postMessage({type:"fitShaper",result:C,jobId:e}),C}async function findBestShaper(e,t,r,i){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a.$l,c=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,_=arguments.length>8?arguments[8]:void 0,f=arguments.length>9?arguments[9]:void 0;await (0,n.CQI)("wasm"),throwIfCancelled(t);let p=[],d=new Map;u.forEach(e=>d.set(e.name,0)),postMessage({type:"findBestShaperProgress",progress:0,jobId:e});let reportProgress=(t,r)=>{d.set(t,r);let n=(0,o.P0)(Array.from(d.values()))/u.length;postMessage({type:"findBestShaperProgress",progress:n,jobId:e})};for(let n of u){let a=await fitShaper(e,t,n,r,i,c,l,s,_,f,reportProgress);a&&p.push(a)}throwIfCancelled(t);let h=p.reduce((e,t)=>((!e||t&&1.2*t.score<e.score||1.05*t.score<e.score&&1.1*t.smoothing<e.smoothing)&&(e=t),e));return{result:h,shapers:p}}(0,i._1)({"tfjs-backend-wasm.wasm":"/configure/tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm":"/configure/tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm":"/configure/tfjs-backend-wasm-threaded-simd.wasm"}),onmessage=async e=>{let t=e.data.type;switch(t){case"findBestShaper":let{calibrationData:r,scv:n,shaperFreqs:i,dampingRatio:o,maxSmoothing:l,testDampingRatios:s,maxFreq:_,id:f}=e.data,p=null!=f?f:c++,d=new AbortController;try{u.set(p,d);let e=await findBestShaper(p,d.signal,r,n,a.$l,i,o,l,s,_);postMessage({type:"findBestShaper",jobId:p,...e})}catch(e){e instanceof JobCancelledError&&(cancelJob(p),postMessage({type:"jobCancelled",id:p}))}break;case"cancelJob":cancelJob(e.data.id)}}},55237:function(e,t,r){"use strict";r.d(t,{$l:function(){return i}});var n=r(69489);function inputShaperCfg(e,t,r,n){return{name:e,initFunc:t,minFreq:r,color:n}}let i=[inputShaperCfg("zv",function(e,t){let r=Math.sqrt(1-t**2);return[[1,Math.exp(-t*Math.PI/r)],[0,.5*(1/(e*r))]]},21,"blue"),inputShaperCfg("mzv",function(e,t){let r=Math.sqrt(1-t**2),n=Math.exp(-.75*t*Math.PI/r),i=1/(e*r),a=1-1/Math.sqrt(2);return[[a,(Math.sqrt(2)-1)*n,a*n*n],[0,.375*i,.75*i]]},23,"rose"),inputShaperCfg("zvd",function(e,t){let r=Math.sqrt(1-t**2),n=Math.exp(-t*Math.PI/r),i=1/(e*r);return[[1,2*n,n**2],[0,.5*i,i]]},29,"lime"),inputShaperCfg("ei",function(e,t){let r=1/n.vy.SHAPER_VIBRATION_REDUCTION,i=Math.sqrt(1-t**2),a=Math.exp(-t*Math.PI/i),o=1/(e*i),u=.25*(1+r);return[[u,.5*(1-r)*a,u*a*a],[0,.5*o,o]]},29,"amber"),inputShaperCfg("2hump_ei",function(e,t){let r=1/n.vy.SHAPER_VIBRATION_REDUCTION,i=Math.sqrt(1-t**2),a=Math.exp(-t*Math.PI/i),o=1/(e*i),u=r**2,c=Math.pow(u*(Math.sqrt(1-u)+1),1/3),l=(3*c*c+2*c+3*u)/(16*c),s=(.5-l)*a;return[[l,s,s*a,l*a*a*a],[0,.5*o,o,1.5*o]]},39,"pink"),inputShaperCfg("3hump_ei",function(e,t){let r=1/n.vy.SHAPER_VIBRATION_REDUCTION,i=Math.sqrt(1-t**2),a=Math.exp(-t*Math.PI/i),o=1/(e*i),u=a*a,c=.0625*(1+3*r+2*Math.sqrt(2*(r+1)*r)),l=.25*(1-r)*a;return[[c,l,(.5*(1+r)-2*c)*u,l*u,c*u*u],[0,.5*o,o,1.5*o,2*o]]},48,"violet")]},28967:function(e,t,r){"use strict";r.d(t,{P0:function(){return sumArray}});let sumArray=e=>e.reduce((e,t)=>e+t,0)},28070:function(e){var t,r,n,i=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{r="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){r=defaultClearTimeout}}();var a=[],o=!1,u=-1;function cleanUpNextTick(){o&&n&&(o=!1,n.length?a=n.concat(a):u=-1,a.length&&drainQueue())}function drainQueue(){if(!o){var e=runTimeout(cleanUpNextTick);o=!0;for(var t=a.length;t;){for(n=a,a=[];++u<t;)n&&n[u].run();u=-1,t=a.length}n=null,o=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===defaultClearTimeout||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new Item(e,t)),1!==a.length||o||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=noop,i.addListener=noop,i.once=noop,i.off=noop,i.removeListener=noop,i.removeAllListeners=noop,i.emit=noop,i.prependListener=noop,i.prependOnceListener=noop,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},u={};function __webpack_require__(e){var t=u[e];if(void 0!==t)return t.exports;var r=u[e]={exports:{}},n=!0;try{o[e](r,r.exports,__webpack_require__),n=!1}finally{n&&delete u[e]}return r.exports}__webpack_require__.m=o,__webpack_require__.x=function(){var e=__webpack_require__.O(void 0,[8693,2307],function(){return __webpack_require__(69489)});return __webpack_require__.O(e)},e=[],__webpack_require__.O=function(t,r,n,i){if(r){i=i||0;for(var a=e.length;a>0&&e[a-1][2]>i;a--)e[a]=e[a-1];e[a]=[r,n,i];return}for(var o=1/0,a=0;a<e.length;a++){for(var r=e[a][0],n=e[a][1],i=e[a][2],u=!0,c=0;c<r.length;c++)o>=i&&Object.keys(__webpack_require__.O).every(function(e){return __webpack_require__.O[e](r[c])})?r.splice(c--,1):(u=!1,i<o&&(o=i));if(u){e.splice(a--,1);var l=n();void 0!==l&&(t=l)}}return t},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce(function(t,r){return __webpack_require__.f[r](e,t),t},[]))},__webpack_require__.u=function(e){return"static/chunks/"+e+"-"+({2307:"d1358a11fa0d0d1c",8693:"952e400a4dbea8cc"})[e]+".js"},__webpack_require__.miniCssF=function(e){},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.tt=function(){return void 0===t&&(t={createScriptURL:function(e){return e}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(t=trustedTypes.createPolicy("nextjs#bundler",t))),t},__webpack_require__.tu=function(e){return __webpack_require__.tt().createScriptURL(e)},__webpack_require__.p="/configure/_next/",r={965:1},__webpack_require__.f.i=function(e,t){r[e]||importScripts(__webpack_require__.tu(__webpack_require__.p+__webpack_require__.u(e)))},i=(n=self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push.bind(n),n.push=function(e){var t=e[0],n=e[1],a=e[2];for(var o in n)__webpack_require__.o(n,o)&&(__webpack_require__.m[o]=n[o]);for(a&&a(__webpack_require__);t.length;)r[t.pop()]=1;i(e)},a=__webpack_require__.x,__webpack_require__.x=function(){return Promise.all([__webpack_require__.e(8693),__webpack_require__.e(2307)]).then(a)},_N_E=__webpack_require__.x()}();
//# sourceMappingURL=965.aeb3cd18692c6598.js.map