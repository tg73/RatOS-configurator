{"version":3,"file":"static/chunks/9661.11be76f763f7a297.js","mappings":"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","sources":["webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.22.0_@tensorflow+tfjs-core@4.22.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|fs","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.22.0_@tensorflow+tfjs-core@4.22.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|os","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.22.0_@tensorflow+tfjs-core@4.22.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|path","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.22.0_@tensorflow+tfjs-core@4.22.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|perf_hooks","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-backend-wasm@4.22.0_@tensorflow+tfjs-core@4.22.0_encoding@0.1.13_/node_modules/@tensorflow/tfjs-backend-wasm/wasm-out|worker_threads","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-core@4.22.0_encoding@0.1.13/node_modules/@tensorflow/tfjs-core/dist/platforms|node-fetch","webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/@tensorflow+tfjs-core@4.22.0_encoding@0.1.13/node_modules/@tensorflow/tfjs-core/dist/platforms|util","webpack://_N_E/./app/analysis/_worker/input-shaper.ts","webpack://_N_E/./app/analysis/_worker/shapers.ts","webpack://_N_E/./app/analysis/math.ts","webpack://_N_E/./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js","webpack://_N_E/webpack/bootstrap","webpack://_N_E/webpack/runtime/chunk loaded","webpack://_N_E/webpack/runtime/compat get default export","webpack://_N_E/webpack/runtime/define property getters","webpack://_N_E/webpack/runtime/ensure chunk","webpack://_N_E/webpack/runtime/get javascript chunk filename","webpack://_N_E/webpack/runtime/get mini-css chunk filename","webpack://_N_E/webpack/runtime/global","webpack://_N_E/webpack/runtime/hasOwnProperty shorthand","webpack://_N_E/webpack/runtime/make namespace object","webpack://_N_E/webpack/runtime/trusted types policy","webpack://_N_E/webpack/runtime/trusted types script url","webpack://_N_E/webpack/runtime/publicPath","webpack://_N_E/webpack/runtime/importScripts chunk loading","webpack://_N_E/webpack/runtime/startup chunk dependencies","webpack://_N_E/webpack/before-startup","webpack://_N_E/webpack/startup","webpack://_N_E/webpack/after-startup","webpack://_N_E/<anon>"],"sourcesContent":["/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","'use client';\n/**\n * Adapted from Dmitry Butyugin <dmbutyugin@google.com> input shaper code in Klipper.\n * This file may be distributed under the terms of the GNU GPLv3 license.\n */\nimport {\n\tTensor1D,\n\tsum,\n\tmax,\n\tpow,\n\tdiv,\n\tsub,\n\tmul,\n\ttensor1d,\n\texp,\n\tsin,\n\tcos,\n\touterProduct,\n\tslice,\n\tzeros,\n\tstack,\n\tsqrt,\n\tslice1d,\n\ttidy,\n\tsetBackend,\n} from '@tensorflow/tfjs-core';\nimport { setWasmPaths } from '@tensorflow/tfjs-backend-wasm';\n\nimport type { TypedArrayPSD } from '@/app/analysis/periodogram';\nimport { INPUT_SHAPERS, InputShaperModel, Shaper, ShaperModels } from '@/app/analysis/_worker/shapers';\nimport { PSD } from '@/zods/analysis';\nimport { shadableTWColors } from '@/app/_helpers/colors';\nimport { sumArray } from '@/app/analysis/math';\n\nexport type InputShaperWorkerInput =\n\t| {\n\t\t\tid?: number;\n\t\t\ttype: 'findBestShaper';\n\t\t\tcalibrationData: TypedArrayPSD | PSD;\n\t\t\tscv: number;\n\t\t\tshaperFreqs?: [number | null, number | null, number | null];\n\t\t\tdampingRatio?: number;\n\t\t\tmaxSmoothing?: number;\n\t\t\ttestDampingRatios?: number[];\n\t\t\tmaxFreq?: number;\n\t  }\n\t| {\n\t\t\ttype: 'cancelJob';\n\t\t\tid: number;\n\t  };\n\nexport type InputShaperWorkerOutput =\n\t| {\n\t\t\ttype: 'findBestShaper';\n\t\t\tresult: ShaperCalibrationResult | null;\n\t\t\tjobId: number;\n\t\t\tshapers: (ShaperCalibrationResult | null)[];\n\t  }\n\t| {\n\t\t\ttype: 'fitShaper';\n\t\t\tjobId: number;\n\t\t\tresult: ShaperCalibrationResult | null;\n\t  }\n\t| {\n\t\t\ttype: 'jobCancelled';\n\t\t\tid: number;\n\t  }\n\t| {\n\t\t\ttype: 'fitShaperProgress';\n\t\t\tmodel: ShaperModels;\n\t\t\tjobId: number;\n\t\t\tprogress: number;\n\t  }\n\t| {\n\t\t\ttype: 'findBestShaperProgress';\n\t\t\tjobId: number;\n\t\t\tprogress: number;\n\t  };\ndeclare function postMessage(message: InputShaperWorkerOutput, targetOrigin: string, transfer?: Transferable[]): void;\ndeclare function postMessage(message: InputShaperWorkerOutput, options?: WindowPostMessageOptions): void;\n\nexport interface InputShaperWorker extends Worker {\n\tonmessage(this: Worker, ev: MessageEvent<InputShaperWorkerOutput>): any;\n\tpostMessage(message: InputShaperWorkerInput, transfer?: Transferable[]): void;\n\tpostMessage(message: InputShaperWorkerInput, options?: StructuredSerializeOptions): void;\n}\nclass JobCancelledError extends Error {\n\tconstructor() {\n\t\tsuper('Job cancelled');\n\t}\n}\n\nconst jobs = new Map<number, AbortController>();\nlet _id = 0;\n\nexport const shaperDefaults = {\n\tDEFAULT_DAMPING_RATIO: 0.1,\n\tSHAPER_VIBRATION_REDUCTION: 20,\n\tTEST_DAMPING_RATIOS: [0.075, 0.1, 0.15],\n\tMAX_SHAPER_FREQ: 150,\n\tWINDOW_T_SEC: 0.5,\n\tMIN_FREQ: 5,\n\tMAX_FREQ: 200,\n\t// Just some empirically chosen value which produces good projections\n\t// for max_accel without much smoothing\n\tTARGET_SMOOTHING: 0.12,\n};\n\nconst cancelJob = (id: number) => {\n\tconst controller = jobs.get(id);\n\tif (controller && controller.signal.aborted === false) {\n\t\tcontroller.abort();\n\t}\n\tjobs.delete(id);\n};\n\nconst throwIfCancelled = (signal: AbortSignal) => {\n\tif (signal.aborted) {\n\t\tthrow new JobCancelledError();\n\t}\n};\n\nasync function getShaperSmoothing(shaper: Shaper, accel: number = 5000, scv: number = 5): Promise<number> {\n\tconst halfAccel = accel * 0.5;\n\n\tconst [A, T] = shaper;\n\tconst invD = 1 / sumArray(A);\n\tconst n = T.length;\n\t// Calculate input shaper shift\n\tconst ts = sumArray(A.map((a, i) => a * T[i])) * invD;\n\n\t// Calculate offset for 90 and 180 degrees turn\n\tlet offset90 = 0;\n\tlet offset180 = 0;\n\tfor (let i = 0; i < n; i++) {\n\t\tif (T[i] >= ts) {\n\t\t\t// Calculate offset for one of the axes\n\t\t\toffset90 += A[i] * (scv + halfAccel * (T[i] - ts)) * (T[i] - ts);\n\t\t}\n\t\toffset180 += A[i] * halfAccel * (T[i] - ts) ** 2;\n\t}\n\toffset90 *= invD * Math.sqrt(2);\n\toffset180 *= invD;\n\treturn Math.max(offset90, offset180);\n}\n\nasync function bisect(fn: (x: number) => Promise<boolean>): Promise<number> {\n\tlet left = 1.0;\n\tlet right = 1.0;\n\tif (!(await fn(1e-9))) {\n\t\treturn 0.0;\n\t}\n\twhile (!(await fn(left))) {\n\t\tright = left;\n\t\tleft *= 0.5;\n\t}\n\tif (right === left) {\n\t\twhile (await fn(right)) {\n\t\t\tright *= 2.0;\n\t\t}\n\t}\n\twhile (right - left > 1e-8) {\n\t\tconst middle = (left + right) * 0.5;\n\t\tif (await fn(middle)) {\n\t\t\tleft = middle;\n\t\t} else {\n\t\t\tright = middle;\n\t\t}\n\t}\n\treturn left;\n}\n\nasync function findShaperMaxAccel(shaper: Shaper, scv: number): Promise<number> {\n\tconst maxAccel = await bisect(\n\t\tasync (testAccel: number) => (await getShaperSmoothing(shaper, testAccel, scv)) <= shaperDefaults.TARGET_SMOOTHING,\n\t);\n\treturn maxAccel;\n}\n\nfunction estimateShaper(shaper: Shaper, testDampingRatio: number, testFreqs: Tensor1D): Tensor1D {\n\treturn tidy(() => {\n\t\tconst A = tensor1d(shaper[0]);\n\t\tconst T = tensor1d(shaper[1]);\n\t\tconst invD = div(1, sum(A));\n\t\tconst omega = mul<Tensor1D>(mul<Tensor1D>(testFreqs, 2), Math.PI);\n\t\tconst damping = mul<Tensor1D>(omega, testDampingRatio);\n\t\tconst omegaD = mul<Tensor1D>(omega, Math.sqrt(1 - testDampingRatio ** 2));\n\t\tconst W = mul(A, exp(outerProduct(mul<Tensor1D>(damping, -1), sub<Tensor1D>(slice(T, T.size - 1, 1), T))));\n\t\tconst S = mul(W, sin(outerProduct(omegaD, T)));\n\t\tconst C = mul(W, cos(outerProduct(omegaD, T)));\n\t\treturn mul(sqrt(sum(stack([pow(sum(S, 1), 2), pow(sum(C, 1), 2)]), 0)), invD);\n\t});\n}\n\nasync function estimateRemainingVibrations(\n\tshaper: Shaper,\n\ttestDampingRatio: number,\n\tfreqBins: Tensor1D,\n\tpsd: Tensor1D,\n): Promise<[number, Tensor1D]> {\n\tconst vals = estimateShaper(shaper, testDampingRatio, freqBins);\n\tconst res = (await tidy(() => {\n\t\t// The input shaper can only reduce the amplitude of vibrations by\n\t\t// SHAPER_VIBRATION_REDUCTION times, so all vibrations below that\n\t\t// threshold can be ignored\n\t\tconst vibrThreshold = div(max(psd), shaperDefaults.SHAPER_VIBRATION_REDUCTION);\n\t\tconst remainingVibrations = sum(max(sub(mul(vals, psd), vibrThreshold), 0));\n\t\tconst allVibrations = sum(max(sub(psd, vibrThreshold), 0));\n\t\treturn div(remainingVibrations, allVibrations);\n\t}).array()) as number;\n\treturn [res, vals];\n}\n\nexport type ShaperCalibrationResult = {\n\tname: ShaperModels;\n\tcolor: keyof typeof shadableTWColors;\n\tfreq: number;\n\tvals: number[];\n\tpsd: number[];\n\tvibrs: number;\n\tsmoothing: number;\n\tscore: number;\n\tmaxAccel: number;\n};\n\nconst range = (start: number, stop: number, step: number) =>\n\tArray.from({ length: (stop - start) / step + 1 }, (value, index) => start + index * step);\n\nexport async function fitShaper(\n\tjobId: number,\n\tsignal: AbortSignal,\n\tshaperCfg: InputShaperModel,\n\tcalibrationData: TypedArrayPSD | PSD,\n\t/**\n\t * [start?, end?, step?]\n\t * @type {[number, number, number]}\n\t */\n\tscv: number,\n\tshaperFreqs: [number | null, number | null, number | null] = [null, null, null],\n\tdampingRatio?: number,\n\tmaxSmoothing?: number,\n\ttestDampingRatios?: number[],\n\tmaxFreq?: number,\n\tonProgress?: (model: ShaperModels, progress: number) => void,\n) {\n\tdampingRatio = dampingRatio || shaperDefaults.DEFAULT_DAMPING_RATIO;\n\ttestDampingRatios = testDampingRatios || shaperDefaults.TEST_DAMPING_RATIOS;\n\tconst freqEnd = shaperFreqs[1] ?? shaperDefaults.MAX_SHAPER_FREQ;\n\tconst freqStart = Math.min(shaperFreqs[0] ?? shaperCfg.minFreq, freqEnd - 1e-7);\n\tconst freqStep = shaperFreqs[2] ?? 0.2;\n\tthrowIfCancelled(signal);\n\n\tmaxFreq = Math.max(maxFreq || shaperDefaults.MAX_FREQ, freqEnd);\n\n\tconst freqBins = slice1d(calibrationData.frequencies, 0, calibrationData.frequencies.length);\n\tconst freqBinsFiltered = slice1d(\n\t\tfreqBins,\n\t\t0,\n\t\tcalibrationData.frequencies.findIndex((f) => f > maxFreq),\n\t);\n\tconst psd = slice1d(calibrationData.estimates, 0, freqBins.size);\n\tfreqBins.dispose();\n\tconst zeroArray = zeros([psd.size]);\n\t// Two pass approach, start in 10hz increments, then refine in `freqStep` increments\n\tconst freqsOfInterest = (\n\t\tawait Promise.all(\n\t\t\trange(freqStart, freqEnd, 10).map(async (f) => {\n\t\t\t\tif (shaperCfg.minFreq > f) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tconst shaper = shaperCfg.initFunc(f, dampingRatio);\n\t\t\t\tlet shaperVibrations = 0;\n\t\t\t\tlet shaperVals = zeroArray.clone();\n\t\t\t\tfor (const dr of testDampingRatios) {\n\t\t\t\t\tconst [vibrations, vals] = await estimateRemainingVibrations(shaper, dr, freqBinsFiltered, psd);\n\t\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\t\tconst oldShapervals = shaperVals;\n\t\t\t\t\tshaperVals = tidy(() => max<Tensor1D>(stack([oldShapervals, vals]), 0));\n\t\t\t\t\toldShapervals.dispose();\n\t\t\t\t\tif (vibrations > shaperVibrations) {\n\t\t\t\t\t\tshaperVibrations = vibrations;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (shaperVibrations < 0.15) {\n\t\t\t\t\treturn f;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}),\n\t\t)\n\t).filter(Boolean);\n\tthrowIfCancelled(signal);\n\tconst testFrequencies = range(Math.min(...freqsOfInterest), Math.max(...freqsOfInterest), freqStep);\n\tconst progressMap = new Map<number, number>();\n\tconst reportProgress = (index: number, progress: number) => {\n\t\tprogressMap.set(index, progress);\n\t\tconst totalProgress = sumArray(Array.from(progressMap.values())) / testFrequencies.length;\n\t\tpostMessage({ type: 'fitShaperProgress', model: shaperCfg.name, progress: totalProgress, jobId });\n\t\tonProgress?.(shaperCfg.name, totalProgress);\n\t};\n\tconst bestShaper: ShaperCalibrationResult | null = (\n\t\tawait Promise.all(\n\t\t\ttestFrequencies.reverse().map(async (testFreq, index) => {\n\t\t\t\treportProgress(testFreq, 0);\n\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\tlet shaperVibrations = 0;\n\t\t\t\tlet shaperVals = zeroArray.clone();\n\t\t\t\tconst shaper = shaperCfg.initFunc(testFreq, dampingRatio);\n\t\t\t\tconst shaperSmoothing = await getShaperSmoothing(shaper, undefined, scv);\n\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\tif (maxSmoothing && shaperSmoothing > maxSmoothing) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treportProgress(index, 1 / 3);\n\t\t\t\tfor (const dr of testDampingRatios) {\n\t\t\t\t\tconst [vibrations, vals] = await estimateRemainingVibrations(shaper, dr, freqBinsFiltered, psd);\n\t\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\t\tconst oldShapervals = shaperVals;\n\t\t\t\t\tshaperVals = tidy(() => max<Tensor1D>(stack([oldShapervals, vals]), 0));\n\t\t\t\t\toldShapervals.dispose();\n\t\t\t\t\tif (vibrations > shaperVibrations) {\n\t\t\t\t\t\tshaperVibrations = vibrations;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treportProgress(index, 2 / 3);\n\t\t\t\tconst maxAccel = await findShaperMaxAccel(shaper, scv);\n\t\t\t\tthrowIfCancelled(signal);\n\t\t\t\tconst shaperScore = shaperSmoothing * (Math.pow(shaperVibrations, 1.5) + shaperVibrations * 0.2 + 0.01);\n\t\t\t\tconst shaperValsArray = (await shaperVals.array()) as number[];\n\t\t\t\tconst adaptedPsd = (await mul(psd, shaperVals).array()) as number[];\n\t\t\t\treportProgress(index, 3 / 3);\n\t\t\t\tconst result = {\n\t\t\t\t\tname: shaperCfg.name,\n\t\t\t\t\tfreq: testFreq,\n\t\t\t\t\tvals: shaperValsArray,\n\t\t\t\t\tpsd: adaptedPsd,\n\t\t\t\t\tvibrs: shaperVibrations,\n\t\t\t\t\tsmoothing: shaperSmoothing,\n\t\t\t\t\tscore: shaperScore,\n\t\t\t\t\tcolor: shaperCfg.color,\n\t\t\t\t\tmaxAccel: maxAccel,\n\t\t\t\t} satisfies ShaperCalibrationResult;\n\t\t\t\treturn result;\n\t\t\t}),\n\t\t)\n\t).reduce(\n\t\t(selected, res) => {\n\t\t\tif (res === null) {\n\t\t\t\treturn selected;\n\t\t\t}\n\t\t\tif (selected == null || (res.vibrs < selected.vibrs * 1.1 && res.score < selected.score)) {\n\t\t\t\tselected = res;\n\t\t\t}\n\t\t\treturn selected;\n\t\t},\n\t\tnull as ShaperCalibrationResult | null,\n\t);\n\tfreqBinsFiltered.dispose();\n\tpsd.dispose();\n\tzeroArray.dispose();\n\n\tthrowIfCancelled(signal);\n\tpostMessage({ type: 'fitShaper', result: bestShaper, jobId });\n\n\treturn bestShaper;\n}\n\nsetWasmPaths({\n\t'tfjs-backend-wasm.wasm': '/configure/tfjs-backend-wasm.wasm',\n\t'tfjs-backend-wasm-simd.wasm': '/configure/tfjs-backend-wasm-simd.wasm',\n\t'tfjs-backend-wasm-threaded-simd.wasm': '/configure/tfjs-backend-wasm-threaded-simd.wasm',\n});\nexport async function findBestShaper(\n\tjobId: number,\n\tsignal: AbortSignal,\n\tcalibrationData: TypedArrayPSD | PSD,\n\tscv: number,\n\tshapers: InputShaperModel[] = INPUT_SHAPERS,\n\tshaperFreqs?: [number | null, number | null, number | null],\n\tdampingRatio?: number,\n\tmaxSmoothing?: number,\n\ttestDampingRatios?: number[],\n\tmaxFreq?: number,\n) {\n\tawait setBackend('wasm');\n\tthrowIfCancelled(signal);\n\tconst fittedShapers: ShaperCalibrationResult[] = [];\n\tconst totalProgress = new Map<ShaperModels, number>();\n\tshapers.forEach((s) => totalProgress.set(s.name, 0));\n\tpostMessage({ type: 'findBestShaperProgress', progress: 0, jobId });\n\tconst reportProgress = (model: ShaperModels, progress: number) => {\n\t\ttotalProgress.set(model, progress);\n\t\tconst total = sumArray(Array.from(totalProgress.values())) / shapers.length;\n\t\tpostMessage({ type: 'findBestShaperProgress', progress: total, jobId });\n\t};\n\tfor (const shaper of shapers) {\n\t\tconst fittedShaper = await fitShaper(\n\t\t\tjobId,\n\t\t\tsignal,\n\t\t\tshaper,\n\t\t\tcalibrationData,\n\t\t\tscv,\n\t\t\tshaperFreqs,\n\t\t\tdampingRatio,\n\t\t\tmaxSmoothing,\n\t\t\ttestDampingRatios,\n\t\t\tmaxFreq,\n\t\t\treportProgress,\n\t\t);\n\t\tif (fittedShaper) {\n\t\t\tfittedShapers.push(fittedShaper);\n\t\t}\n\t}\n\tthrowIfCancelled(signal);\n\tconst best = fittedShapers.reduce((best, shaper) => {\n\t\t// Either the shaper significantly improves the score (by 20%),\n\t\t// or it improves the score and smoothing (by 5% and 10% resp.)\n\t\tif (\n\t\t\t!best ||\n\t\t\t(shaper && shaper.score * 1.2 < best.score) ||\n\t\t\t(shaper.score * 1.05 < best.score && shaper.smoothing * 1.1 < best.smoothing)\n\t\t) {\n\t\t\tbest = shaper;\n\t\t}\n\t\treturn best;\n\t});\n\treturn {\n\t\tresult: best,\n\t\tshapers: fittedShapers,\n\t};\n}\n\nonmessage = async (e: MessageEvent<InputShaperWorkerInput>) => {\n\tconst command = e.data.type;\n\tswitch (command) {\n\t\tcase 'findBestShaper':\n\t\t\tconst { calibrationData, scv, shaperFreqs, dampingRatio, maxSmoothing, testDampingRatios, maxFreq, id } = e.data;\n\t\t\tconst jobId = id ?? _id++;\n\t\t\tconst abortController = new AbortController();\n\t\t\ttry {\n\t\t\t\tjobs.set(jobId, abortController);\n\t\t\t\tconst result = await findBestShaper(\n\t\t\t\t\tjobId,\n\t\t\t\t\tabortController.signal,\n\t\t\t\t\tcalibrationData,\n\t\t\t\t\tscv,\n\t\t\t\t\tINPUT_SHAPERS,\n\t\t\t\t\tshaperFreqs,\n\t\t\t\t\tdampingRatio,\n\t\t\t\t\tmaxSmoothing,\n\t\t\t\t\ttestDampingRatios,\n\t\t\t\t\tmaxFreq,\n\t\t\t\t);\n\t\t\t\tpostMessage({ type: 'findBestShaper', jobId, ...result } satisfies InputShaperWorkerOutput);\n\t\t\t} catch (e) {\n\t\t\t\tif (e instanceof JobCancelledError) {\n\t\t\t\t\tcancelJob(jobId);\n\t\t\t\t\tpostMessage({ type: 'jobCancelled', id: jobId } satisfies InputShaperWorkerOutput);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'cancelJob':\n\t\t\tcancelJob(e.data.id);\n\t\t\tbreak;\n\t}\n};\n","'use client';\n/**\n * Adapted from Dmitry Butyugin <dmbutyugin@google.com> input shaper code in Klipper.\n * This file may be distributed under the terms of the GNU GPLv3 license.\n */\nimport { shaperDefaults } from '@/app/analysis/_worker/input-shaper';\nimport { shadableTWColors } from '@/app/_helpers/colors';\n\nexport type Shaper = [number[], number[]];\n\nexport type ShaperModels = 'zv' | 'mzv' | 'zvd' | 'ei' | '2hump_ei' | '3hump_ei';\n\nexport type InputShaperModel = {\n\tminFreq: number;\n\tinitFunc: (shaperFrequency: number, dampingRatio: number) => Shaper;\n\tname: ShaperModels;\n\tcolor: keyof typeof shadableTWColors;\n};\n\nexport function inputShaperCfg(\n\tname: ShaperModels,\n\tinitFunc: (shaperFrequency: number, dampingRatio: number) => Shaper,\n\tminFreq: number,\n\tcolor: keyof typeof shadableTWColors,\n): InputShaperModel {\n\treturn { name, initFunc, minFreq, color };\n}\n\nexport function getNoneShaper(): Shaper {\n\treturn [[], []];\n}\n\nexport function getZvShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\tconst A = [1, K];\n\tconst T = [0, 0.5 * tD];\n\treturn [A, T];\n}\n\nexport function getZvdShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\tconst A = [1, 2 * K, K ** 2];\n\tconst T = [0, 0.5 * tD, tD];\n\treturn [A, T];\n}\n\nexport function getMzvShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-0.75 * dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst a1 = 1 - 1 / Math.sqrt(2);\n\tconst a2 = (Math.sqrt(2) - 1) * K;\n\tconst a3 = a1 * K * K;\n\n\tconst A = [a1, a2, a3];\n\tconst T = [0, 0.375 * tD, 0.75 * tD];\n\treturn [A, T];\n}\n\nexport function getEiShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst vTol = 1 / shaperDefaults.SHAPER_VIBRATION_REDUCTION; // vibration tolerance\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst a1 = 0.25 * (1 + vTol);\n\tconst a2 = 0.5 * (1 - vTol) * K;\n\tconst a3 = a1 * K * K;\n\n\tconst A = [a1, a2, a3];\n\tconst T = [0, 0.5 * tD, tD];\n\treturn [A, T];\n}\n\nexport function get2HumpEiShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst vTol = 1 / shaperDefaults.SHAPER_VIBRATION_REDUCTION; // vibration tolerance\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst V2 = vTol ** 2;\n\tconst X = Math.pow(V2 * (Math.sqrt(1 - V2) + 1), 1 / 3);\n\tconst a1 = (3 * X * X + 2 * X + 3 * V2) / (16 * X);\n\tconst a2 = (0.5 - a1) * K;\n\tconst a3 = a2 * K;\n\tconst a4 = a1 * K * K * K;\n\n\tconst A = [a1, a2, a3, a4];\n\tconst T = [0, 0.5 * tD, tD, 1.5 * tD];\n\treturn [A, T];\n}\n\nexport function get3HumpEiShaper(shaperFreq: number, dampingRatio: number): Shaper {\n\tconst vTol = 1 / shaperDefaults.SHAPER_VIBRATION_REDUCTION; // vibration tolerance\n\tconst df = Math.sqrt(1 - dampingRatio ** 2);\n\tconst K = Math.exp((-dampingRatio * Math.PI) / df);\n\tconst tD = 1 / (shaperFreq * df);\n\n\tconst K2 = K * K;\n\tconst a1 = 0.0625 * (1 + 3 * vTol + 2 * Math.sqrt(2 * (vTol + 1) * vTol));\n\tconst a2 = 0.25 * (1 - vTol) * K;\n\tconst a3 = (0.5 * (1 + vTol) - 2 * a1) * K2;\n\tconst a4 = a2 * K2;\n\tconst a5 = a1 * K2 * K2;\n\n\tconst A = [a1, a2, a3, a4, a5];\n\tconst T = [0, 0.5 * tD, tD, 1.5 * tD, 2 * tD];\n\treturn [A, T];\n}\n\nexport const INPUT_SHAPERS = [\n\tinputShaperCfg('zv', getZvShaper, 21, 'blue'),\n\tinputShaperCfg('mzv', getMzvShaper, 23, 'rose'),\n\tinputShaperCfg('zvd', getZvdShaper, 29, 'lime'),\n\tinputShaperCfg('ei', getEiShaper, 29, 'amber'),\n\tinputShaperCfg('2hump_ei', get2HumpEiShaper, 39, 'pink'),\n\tinputShaperCfg('3hump_ei', get3HumpEiShaper, 48, 'violet'),\n];\n","export const sumArray = (arr: number[]) => arr.reduce((a, b) => a + b, 0);\nexport const meanArray = (arr: number[]) => sumArray(arr) / arr.length;\nexport const maxArrayIndex = (arr: number[]) => arr.reduce((iMax, x, i, arr) => (x > arr[iMax] ? i : iMax), 0);\n\nexport function pearsonCorrelation(x: number[], y: number[]): number {\n\tif (x.length !== y.length) {\n\t\tthrow new Error('Input arrays must have the same length.');\n\t}\n\n\tconst n = x.length;\n\tconst meanX = meanArray(x);\n\tconst meanY = meanArray(y);\n\n\tlet numerator = 0;\n\tlet denominatorX = 0;\n\tlet denominatorY = 0;\n\n\tfor (let i = 0; i < n; i++) {\n\t\tconst dx = x[i] - meanX;\n\t\tconst dy = y[i] - meanY;\n\t\tnumerator += dx * dy;\n\t\tdenominatorX += dx * dx;\n\t\tdenominatorY += dy * dy;\n\t}\n\n\tconst denominator = Math.sqrt(denominatorX) * Math.sqrt(denominatorY);\n\tif (denominator === 0) {\n\t\treturn 0; // Avoid division by zero\n\t}\n\n\treturn numerator / denominator;\n}\n\nexport function calculatePercentile(arr: number[], percentile: number): number {\n\tarr.sort((a, b) => a - b);\n\tconst index = (percentile / 100) * (arr.length - 1);\n\tconst lower = Math.floor(index);\n\tconst upper = Math.ceil(index);\n\tif (lower === upper) {\n\t\treturn arr[lower];\n\t}\n\treturn arr[lower] + (arr[upper] - arr[lower]) * (index - lower);\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\tvar threw = true;\n\ttry {\n\t\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\t\tthrew = false;\n\t} finally {\n\t\tif(threw) delete __webpack_module_cache__[moduleId];\n\t}\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [2202,1284], function() { return __webpack_require__(69489); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/chunks/\" + chunkId + \"-\" + {\"1284\":\"e6c3abc4efcbd0dd\",\"2202\":\"70b8e79e76461e0a\"}[chunkId] + \".js\";\n};","// This function allow to reference all chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var policy;\n__webpack_require__.tt = function() {\n\t// Create Trusted Type policy if Trusted Types are available and the policy doesn't exist yet.\n\tif (policy === undefined) {\n\t\tpolicy = {\n\t\t\tcreateScriptURL: function(url) { return url; }\n\t\t};\n\t\tif (typeof trustedTypes !== \"undefined\" && trustedTypes.createPolicy) {\n\t\t\tpolicy = trustedTypes.createPolicy(\"nextjs#bundler\", policy);\n\t\t}\n\t}\n\treturn policy;\n};","__webpack_require__.tu = function(url) { return __webpack_require__.tt().createScriptURL(url); };","__webpack_require__.p = \"/configure/_next/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t9661: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.tu(__webpack_require__.p + __webpack_require__.u(chunkId)));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunk_N_E\"] = self[\"webpackChunk_N_E\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn Promise.all([\n\t\t__webpack_require__.e(2202),\n\t\t__webpack_require__.e(1284)\n\t]).then(next);\n};",null,"// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["deferred","policy","installedChunks","chunkLoadingGlobal","parentChunkLoadingFunction","next","JobCancelledError","Error","constructor","jobs","Map","_id","shaperDefaults","DEFAULT_DAMPING_RATIO","SHAPER_VIBRATION_REDUCTION","TEST_DAMPING_RATIOS","MAX_SHAPER_FREQ","WINDOW_T_SEC","MIN_FREQ","MAX_FREQ","TARGET_SMOOTHING","cancelJob","controller","get","id","signal","aborted","abort","delete","throwIfCancelled","getShaperSmoothing","shaper","accel","scv","halfAccel","A","T","invD","sumArray","n","length","ts","map","a","i","offset90","offset180","Math","max","sqrt","bisect","fn","left","right","middle","findShaperMaxAccel","maxAccel","testAccel","estimateRemainingVibrations","testDampingRatio","freqBins","psd","vals","tidy","tensor1d","div","sum","omega","mul","PI","damping","omegaD","W","exp","outerProduct","sub","slice","size","S","sin","C","cos","stack","pow","res","vibrThreshold","remainingVibrations","allVibrations","array","range","start","stop","step","Array","from","value","index","fitShaper","jobId","shaperCfg","calibrationData","shaperFreqs","dampingRatio","maxSmoothing","testDampingRatios","maxFreq","onProgress","freqEnd","freqStart","min","minFreq","freqStep","slice1d","frequencies","freqBinsFiltered","findIndex","f","estimates","dispose","zeroArray","zeros","freqsOfInterest","Promise","all","initFunc","shaperVibrations","shaperVals","clone","dr","vibrations","oldShapervals","filter","Boolean","testFrequencies","progressMap","reportProgress","progress","set","totalProgress","values","postMessage","type","model","name","bestShaper","reverse","testFreq","shaperSmoothing","undefined","shaperScore","shaperValsArray","adaptedPsd","result","freq","vibrs","smoothing","score","color","reduce","selected","findBestShaper","shapers","INPUT_SHAPERS","setBackend","fittedShapers","forEach","s","total","fittedShaper","push","best","setWasmPaths","onmessage","e","command","data","abortController","AbortController","inputShaperCfg","shaperFreq","df","K","tD","a1","vTol","V2","X","a2","K2","arr","b","cachedSetTimeout","cachedClearTimeout","currentQueue","process","module","exports","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","call","clearTimeout","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","runClearTimeout","marker","Item","noop","nextTick","args","arguments","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","threw","__webpack_modules__","m","x","__webpack_exports__","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","key","splice","r","getter","__esModule","d","definition","o","defineProperty","enumerable","chunkId","promises","u","miniCssF","g","globalThis","window","obj","prop","hasOwnProperty","Symbol","toStringTag","tt","createScriptURL","url","trustedTypes","createPolicy","tu","p","importScripts","self","bind","moreModules","runtime","pop","then"],"sourceRoot":""}