(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2601,4595,6375],{647:function(){},55023:function(){},7637:function(){},95772:function(){},77922:function(){},3186:function(){},62494:function(){},65660:function(){},74755:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(24360);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,n.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},28351:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(24360);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,n.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},79162:function(e,t,r){Promise.resolve().then(r.bind(r,54117)),Promise.resolve().then(r.bind(r,56445))},98948:function(e,t,r){"use strict";r.d(t,{j:function(){return getLogger}});var n=r(74958),a=r.n(n),o=r(75061),i=r(10187),l=r(31354);let send=async function(e,t){i.u.clientLog.mutate({level:e,logEvent:l.s.parse(t)})},s=null,getLogger=()=>null!=s?s:s=a()({...o.N,browser:{transmit:{send}}})},97060:function(e,t,r){"use strict";r.d(t,{N:function(){return useDebounce}});var n=r(39164);let useDebounce=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=(0,n.useRef)(),o=(0,n.useRef)([]);return(0,n.useEffect)(()=>()=>{a.current&&clearTimeout(a.current)},[]),(0,n.useCallback)(function(){for(var n=arguments.length,i=Array(n),l=0;l<n;l++)i[l]=arguments[l];if(o.current=i,a.current){if(!r)return;clearTimeout(a.current),a.current=void 0}a.current=setTimeout(()=>{e(...o.current),a.current=void 0},t)},[t,r,e])}},69489:function(e,t,r){"use strict";r.d(t,{vy:function(){return c}});var n=r(32307),a=r(66066),o=r(55237),i=r(28967);let JobCancelledError=class JobCancelledError extends Error{constructor(){super("Job cancelled")}};let l=new Map,s=0,c={DEFAULT_DAMPING_RATIO:.1,SHAPER_VIBRATION_REDUCTION:20,TEST_DAMPING_RATIOS:[.075,.1,.15],MAX_SHAPER_FREQ:150,WINDOW_T_SEC:.5,MIN_FREQ:5,MAX_FREQ:200,TARGET_SMOOTHING:.12},cancelJob=e=>{let t=l.get(e);t&&!1===t.signal.aborted&&t.abort(),l.delete(e)},throwIfCancelled=e=>{if(e.aborted)throw new JobCancelledError};async function getShaperSmoothing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=.5*t,[a,o]=e,l=1/(0,i.P0)(a),s=o.length,c=(0,i.P0)(a.map((e,t)=>e*o[t]))*l,u=0,d=0;for(let e=0;e<s;e++)o[e]>=c&&(u+=a[e]*(r+n*(o[e]-c))*(o[e]-c)),d+=a[e]*n*(o[e]-c)**2;return Math.max(u*=l*Math.sqrt(2),d*=l)}async function bisect(e){let t=1,r=1;if(!await e(1e-9))return 0;for(;!await e(t);)r=t,t*=.5;if(r===t)for(;await e(r);)r*=2;for(;r-t>1e-8;){let n=(t+r)*.5;await e(n)?t=n:r=n}return t}async function findShaperMaxAccel(e,t){let r=await bisect(async r=>await getShaperSmoothing(e,r,t)<=c.TARGET_SMOOTHING);return r}async function estimateRemainingVibrations(e,t,r,a){let o=(0,n.lub)(()=>{let a=(0,n.RRF)(e[0]),o=(0,n.RRF)(e[1]),i=(0,n.hiC)(1,(0,n.Smz)(a)),l=(0,n.dC7)((0,n.dC7)(r,2),Math.PI),s=(0,n.dC7)(l,t),c=(0,n.dC7)(l,Math.sqrt(1-t**2)),u=(0,n.dC7)(a,(0,n.Qqt)((0,n.N2O)((0,n.dC7)(s,-1),(0,n.luU)((0,n.tPi)(o,o.size-1,1),o)))),d=(0,n.dC7)(u,(0,n.O$l)((0,n.N2O)(c,o))),f=(0,n.dC7)(u,(0,n.mCk)((0,n.N2O)(c,o)));return(0,n.dC7)((0,n._b3)((0,n.Smz)((0,n.knu)([(0,n.sQ3)((0,n.Smz)(d,1),2),(0,n.sQ3)((0,n.Smz)(f,1),2)]),0)),i)}),i=await (0,n.lub)(()=>{let e=(0,n.hiC)((0,n.Fp7)(a),c.SHAPER_VIBRATION_REDUCTION),t=(0,n.Smz)((0,n.Fp7)((0,n.luU)((0,n.dC7)(o,a),e),0)),r=(0,n.Smz)((0,n.Fp7)((0,n.luU)(a,e),0));return(0,n.hiC)(t,r)}).array();return[i,o]}let range=(e,t,r)=>Array.from({length:(t-e)/r+1},(t,n)=>e+n*r);async function fitShaper(e,t,r,a,o){var l,s,u;let d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[null,null,null],f=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0,m=arguments.length>8?arguments[8]:void 0,h=arguments.length>9?arguments[9]:void 0,g=arguments.length>10?arguments[10]:void 0;f=f||c.DEFAULT_DAMPING_RATIO,m=m||c.TEST_DAMPING_RATIOS;let y=null!==(l=d[1])&&void 0!==l?l:c.MAX_SHAPER_FREQ,b=Math.min(null!==(s=d[0])&&void 0!==s?s:r.minFreq,y-1e-7),x=null!==(u=d[2])&&void 0!==u?u:.2;throwIfCancelled(t),h=Math.max(h||c.MAX_FREQ,y);let v=(0,n.jZU)(a.frequencies,0,a.frequencies.length),w=(0,n.jZU)(v,0,a.frequencies.findIndex(e=>e>h)),k=(0,n.jZU)(a.estimates,0,v.size);v.dispose();let S=(0,n.lls)([k.size]),C=(await Promise.all(range(b,y,10).map(async e=>{if(r.minFreq>e)return null;let a=r.initFunc(e,f),o=0,i=S.clone();for(let e of m){let[r,l]=await estimateRemainingVibrations(a,e,w,k);throwIfCancelled(t);let s=i;i=(0,n.lub)(()=>(0,n.Fp7)((0,n.knu)([s,l]),0)),s.dispose(),r>o&&(o=r)}return o<.15?e:null}))).filter(Boolean);throwIfCancelled(t);let N=range(Math.min(...C),Math.max(...C),x),j=new Map,reportProgress=(t,n)=>{j.set(t,n);let a=(0,i.P0)(Array.from(j.values()))/N.length;postMessage({type:"fitShaperProgress",model:r.name,progress:a,jobId:e}),null==g||g(r.name,a)},A=(await Promise.all(N.reverse().map(async(e,a)=>{reportProgress(e,0),throwIfCancelled(t);let i=0,l=S.clone(),s=r.initFunc(e,f),c=await getShaperSmoothing(s,void 0,o);if(throwIfCancelled(t),p&&c>p)return null;for(let e of(reportProgress(a,1/3),m)){let[r,a]=await estimateRemainingVibrations(s,e,w,k);throwIfCancelled(t);let o=l;l=(0,n.lub)(()=>(0,n.Fp7)((0,n.knu)([o,a]),0)),o.dispose(),r>i&&(i=r)}reportProgress(a,2/3);let u=await findShaperMaxAccel(s,o);throwIfCancelled(t);let d=c*(Math.pow(i,1.5)+.2*i+.01),h=await l.array(),g=await (0,n.dC7)(k,l).array();reportProgress(a,1);let y={name:r.name,freq:e,vals:h,psd:g,vibrs:i,smoothing:c,score:d,color:r.color,maxAccel:u};return y}))).reduce((e,t)=>(null===t||(null==e||t.vibrs<1.1*e.vibrs&&t.score<e.score)&&(e=t),e),null);return w.dispose(),k.dispose(),S.dispose(),throwIfCancelled(t),postMessage({type:"fitShaper",result:A,jobId:e}),A}async function findBestShaper(e,t,r,a){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.$l,s=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0,f=arguments.length>9?arguments[9]:void 0;await (0,n.CQI)("wasm"),throwIfCancelled(t);let p=[],m=new Map;l.forEach(e=>m.set(e.name,0)),postMessage({type:"findBestShaperProgress",progress:0,jobId:e});let reportProgress=(t,r)=>{m.set(t,r);let n=(0,i.P0)(Array.from(m.values()))/l.length;postMessage({type:"findBestShaperProgress",progress:n,jobId:e})};for(let n of l){let o=await fitShaper(e,t,n,r,a,s,c,u,d,f,reportProgress);o&&p.push(o)}throwIfCancelled(t);let h=p.reduce((e,t)=>((!e||t&&1.2*t.score<e.score||1.05*t.score<e.score&&1.1*t.smoothing<e.smoothing)&&(e=t),e));return{result:h,shapers:p}}(0,a._1)({"tfjs-backend-wasm.wasm":"/configure/tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm":"/configure/tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm":"/configure/tfjs-backend-wasm-threaded-simd.wasm"}),onmessage=async e=>{let t=e.data.type;switch(t){case"findBestShaper":let{calibrationData:r,scv:n,shaperFreqs:a,dampingRatio:i,maxSmoothing:c,testDampingRatios:u,maxFreq:d,id:f}=e.data,p=null!=f?f:s++,m=new AbortController;try{l.set(p,m);let e=await findBestShaper(p,m.signal,r,n,o.$l,a,i,c,u,d);postMessage({type:"findBestShaper",jobId:p,...e})}catch(e){e instanceof JobCancelledError&&(cancelJob(p),postMessage({type:"jobCancelled",id:p}))}break;case"cancelJob":cancelJob(e.data.id)}}},55237:function(e,t,r){"use strict";r.d(t,{$l:function(){return a}});var n=r(69489);function inputShaperCfg(e,t,r,n){return{name:e,initFunc:t,minFreq:r,color:n}}let a=[inputShaperCfg("zv",function(e,t){let r=Math.sqrt(1-t**2);return[[1,Math.exp(-t*Math.PI/r)],[0,.5*(1/(e*r))]]},21,"blue"),inputShaperCfg("mzv",function(e,t){let r=Math.sqrt(1-t**2),n=Math.exp(-.75*t*Math.PI/r),a=1/(e*r),o=1-1/Math.sqrt(2);return[[o,(Math.sqrt(2)-1)*n,o*n*n],[0,.375*a,.75*a]]},23,"rose"),inputShaperCfg("zvd",function(e,t){let r=Math.sqrt(1-t**2),n=Math.exp(-t*Math.PI/r),a=1/(e*r);return[[1,2*n,n**2],[0,.5*a,a]]},29,"lime"),inputShaperCfg("ei",function(e,t){let r=1/n.vy.SHAPER_VIBRATION_REDUCTION,a=Math.sqrt(1-t**2),o=Math.exp(-t*Math.PI/a),i=1/(e*a),l=.25*(1+r);return[[l,.5*(1-r)*o,l*o*o],[0,.5*i,i]]},29,"amber"),inputShaperCfg("2hump_ei",function(e,t){let r=1/n.vy.SHAPER_VIBRATION_REDUCTION,a=Math.sqrt(1-t**2),o=Math.exp(-t*Math.PI/a),i=1/(e*a),l=r**2,s=Math.pow(l*(Math.sqrt(1-l)+1),1/3),c=(3*s*s+2*s+3*l)/(16*s),u=(.5-c)*o;return[[c,u,u*o,c*o*o*o],[0,.5*i,i,1.5*i]]},39,"pink"),inputShaperCfg("3hump_ei",function(e,t){let r=1/n.vy.SHAPER_VIBRATION_REDUCTION,a=Math.sqrt(1-t**2),o=Math.exp(-t*Math.PI/a),i=1/(e*a),l=o*o,s=.0625*(1+3*r+2*Math.sqrt(2*(r+1)*r)),c=.25*(1-r)*o;return[[s,c,(.5*(1+r)-2*s)*l,c*l,s*l*l],[0,.5*i,i,1.5*i,2*i]]},48,"violet")]},54117:function(e,t,r){"use strict";r.r(t),r.d(t,{MacroRun:function(){return MacroRun}});var n,a,o=r(72612),i=r(29817),l=r(39164),s=r(77706),c=r(43955),u=r(11054),d=r(86736),f=r.n(d);(n=a||(a={})).Line="line",n.Mountain="mountain";let animateYAxis=(e,t)=>{let r=e.yAxes.getById(i.ck);if(r){r.autoRange=s.EAutoRange.Never;let e=Math.max(...t.map(e=>Math.max(...e.psd.total.estimates)));(r.visibleRange.max<e||r.visibleRange.max>5*e)&&r.animateVisibleRange(new s.NumberRange(Math.min(...t.map(e=>e.psd.total.powerRange.min)),e).growBy(new s.NumberRange(0,.2)),500,s.easing.inOutCirc)}},setupChart=(e,t)=>{let r=!1;if(2===t.length){r=!0;for(let e=0;e<t[0].psd.total.frequencies.length;e++)Math.abs(t[0].psd.total.frequencies[e]-t[1].psd.total.frequencies[e])>1&&(r=!1)}if(r){var n,a,o,l,u,d;let r=new s.FastBandRenderableSeries(e.webAssemblyContext2D,{dataSeries:new s.XyyDataSeries(e.webAssemblyContext2D,{containsNaN:!1,isSorted:!0,xValues:t[0].psd.total.frequencies,yValues:t[0].psd.total.estimates,y1Values:t[1].psd.total.estimates}),fill:c.DN[null!==(n=t[1].color)&&void 0!==n?n:"sky"][600]+22,fillY1:c.DN[null!==(a=t[0].color)&&void 0!==a?a:"rose"][600]+22,stroke:c.DN[null!==(o=t[0].color)&&void 0!==o?o:"rose"][400],strokeY1:c.DN[null!==(l=t[1].color)&&void 0!==l?l:"sky"][400],strokeThickness:4,yAxisId:i.ck});r.rolloverModifierProps.tooltipColor=null!==(u=t[0].color)&&void 0!==u?u:"zinc",r.rolloverModifierProps.tooltipTitle=t[0].name+" Power",r.rolloverModifierProps1.tooltipColor=null!==(d=t[1].color)&&void 0!==d?d:"zinc",r.rolloverModifierProps1.tooltipTitle=t[1].name+" Power",r.animation=new s.WaveAnimation({duration:500,delay:200,ease:s.easing.inOutQuad}),e.renderableSeries.add(r)}else t.forEach(t=>{var r,n,a;let o="line"===t.type?s.FastLineRenderableSeries:s.FastMountainRenderableSeries,l=new o(e.webAssemblyContext2D,{id:t.sequenceId,dataSeries:new s.XyDataSeries(e.webAssemblyContext2D,{containsNaN:!1,isSorted:!0,xValues:t.psd.total.frequencies,yValues:t.psd.total.estimates}),stroke:c.DN[null!==(r=t.color)&&void 0!==r?r:"brand"][400],fill:c.DN[null!==(n=t.color)&&void 0!==n?n:"brand"][600]+11,strokeThickness:4,yAxisId:i.ck});l.rolloverModifierProps.tooltipColor=null!==(a=t.color)&&void 0!==a?a:"zinc",l.rolloverModifierProps.tooltipTitle=t.name+" Power",l.animation=new s.WaveAnimation({duration:500,delay:200,ease:s.easing.inOutQuad}),e.renderableSeries.add(l)});e.chartModifiers.add(new s.RolloverModifier({showRolloverLine:!0,showTooltip:!1,yAxisId:i.ck})),e.chartModifiers.add(new s.CursorModifier({crosshairStroke:c.DN.sky[400],crosshairStrokeThickness:1,showXLine:!0,showYLine:!0,tooltipLegendTemplate:i.to,tooltipLegendOffsetX:16,tooltipLegendOffsetY:16,yAxisId:i.ck,showTooltip:!1,axisLabelFill:c.DN.zinc[900],axisLabelStroke:c.DN.zinc[100]})),animateYAxis(e,t)};var p=r(98948);let useBeltTensionState=()=>{let[e,t]=(0,l.useState)(null),[r,n]=(0,l.useState)(null),[a,o]=(0,l.useState)(null);return{sequencePair:e,setSequencePair:t,peakPairingResults:r,setPeakPairingResults:n,mechanicalHealth:a,setMechanicalHealth:o}},initBeltTensionChartAnnotations=async function(e,t,r){var n;let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;if(null==t||null==r||null==e)return;let[o,l]=t,{pairedPeaks:c,unpairedPeaks1:u,unpairedPeaks2:d}=r,f=.1*Math.max(null===(n=e.yAxes.getById(i.ck))||void 0===n?void 0:n.visibleRange.max,o.psd.total.powerRange.max,l.psd.total.powerRange.max),p=c.flatMap((t,r)=>{let[n,o]=t;if(null==e.annotations.getById(String.fromCharCode(65+r)+"-peak-1")&&null==e.annotations.getById(String.fromCharCode(65+r)+"-peak-2")){let t=n.freq,l=n.amplitude,c=o.freq,u=o.amplitude,d=new s.CustomAnnotation({id:String.fromCharCode(65+r)+"-peak-1",xCoordinateMode:s.ECoordinateMode.DataValue,yCoordinateMode:s.ECoordinateMode.DataValue,yAxisId:i.ck,x1:t,y1:l+f,opacity:0,verticalAnchorPoint:s.EVerticalAnchorPoint.Bottom,horizontalAnchorPoint:s.EHorizontalAnchorPoint.Center,svgString:'\n					<svg height="50" width="100" xmlns="http://www.w3.org/2000/svg">\n						<g transform="translate(11.5,2)">\n							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-corner-left-down"><polyline points="14 15 9 20 4 15"/><path d="M20 4h-7a4 4 0 0 0-4 4v12"/></svg>\n						</g>\n						<text x="48" y="8" dominant-baseline="middle" text-anchor="middle" stroke-width="2" paint-order="stroke" stroke="black" fill="currentColor" font-size="14px">'.concat(String.fromCharCode(65+r),"1</text>\n					</svg>")});e.annotations.add(d);let p=new s.CustomAnnotation({id:String.fromCharCode(65+r)+"-peak-2",xCoordinateMode:s.ECoordinateMode.DataValue,yCoordinateMode:s.ECoordinateMode.DataValue,yAxisId:i.ck,x1:c,y1:u+f,opacity:0,verticalAnchorPoint:s.EVerticalAnchorPoint.Bottom,horizontalAnchorPoint:s.EHorizontalAnchorPoint.Center,svgString:'\n					<svg height="50" width="100" xmlns="http://www.w3.org/2000/svg">\n						<g transform="translate(11.5,2)">\n							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-corner-left-down"><polyline points="14 15 9 20 4 15"/><path d="M20 4h-7a4 4 0 0 0-4 4v12"/></svg>\n						</g>\n						<text x="48" y="8" dominant-baseline="middle" text-anchor="middle" stroke-width="2" paint-order="stroke" stroke="black" fill="currentColor" font-size="14px">'.concat(String.fromCharCode(65+r),"2</text>\n					</svg>")});return e.annotations.add(p),[new Promise(t=>{let n=new s.GenericAnimation({from:{opacity:0,y1:l+f},to:{opacity:1,y1:l},duration:200,delay:a+200*r,ease:s.easing.outCubic,onAnimate:(e,t,r)=>{d.opacity=s.DoubleAnimator.interpolate(e.opacity,t.opacity,r),d.y1=s.DoubleAnimator.interpolate(e.y1,t.y1,r)},onCompleted:t});e.addAnimation(n)}),new Promise(t=>{let n=new s.GenericAnimation({from:{opacity:0,y1:u+f},to:{opacity:1,y1:u},duration:200,delay:a+200*r,ease:s.easing.outCubic,onAnimate:(e,t,r)=>{p.opacity=s.DoubleAnimator.interpolate(e.opacity,t.opacity,r),p.y1=s.DoubleAnimator.interpolate(e.y1,t.y1,r)},onCompleted:t});e.addAnimation(n)})]}}).concat(u.concat(d).map((t,r)=>{let n=t.freq,o=t.amplitude;if(null!=e.annotations.getById("unpaired-peak-"+r))return Promise.resolve();let l=new s.CustomAnnotation({id:"unpaired-peak-"+r,xCoordinateMode:s.ECoordinateMode.DataValue,yCoordinateMode:s.ECoordinateMode.DataValue,yAxisId:i.ck,x1:n,y1:o+f,opacity:0,verticalAnchorPoint:s.EVerticalAnchorPoint.Bottom,horizontalAnchorPoint:s.EHorizontalAnchorPoint.Right,svgString:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" class="stroke-red-600" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>'});return e.annotations.add(l),new Promise(t=>{let n=new s.GenericAnimation({from:{opacity:0,y1:o+f},to:{opacity:1,y1:o},duration:200,delay:a+200*c.length+200*r,ease:s.easing.outCubic,onAnimate:(e,t,r)=>{l.opacity=s.DoubleAnimator.interpolate(e.opacity,t.opacity,r),l.y1=s.DoubleAnimator.interpolate(e.y1,t.y1,r)},onCompleted:t});e.addAnimation(n)})}));return await Promise.all(p)},removeBeltTensionChartAnnotations=async function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null==e)return;let a=r,o=(null===(t=e.yAxes.getById(i.ck))||void 0===t?void 0:t.visibleRange.max)*.1,l=[];for(;null!=e.annotations.getById(String.fromCharCode(65+a)+"-peak-1");){let t=e.annotations.getById(String.fromCharCode(65+a)+"-peak-1"),r=e.annotations.getById(String.fromCharCode(65+a)+"-peak-2");a++,null!=t&&l.push(new Promise(r=>{let n=new s.GenericAnimation({from:{opacity:t.opacity,y1:t.y1},to:{opacity:0,y1:t.y1-o},duration:500,ease:s.easing.inOutCirc,onAnimate:(e,r,n)=>{t.opacity=s.DoubleAnimator.interpolate(e.opacity,r.opacity,n),t.y1=s.DoubleAnimator.interpolate(e.y1,r.y1,n)},onCompleted:()=>{e.annotations.remove(t),r()}});e.addAnimation(n)})),null!=r&&l.push(new Promise(t=>{let n=new s.GenericAnimation({from:{opacity:r.opacity,y1:r.y1},to:{opacity:0,y1:r.y1-o},duration:500,ease:s.easing.inOutCirc,onAnimate:(e,t,n)=>{r.opacity=s.DoubleAnimator.interpolate(e.opacity,t.opacity,n),r.y1=s.DoubleAnimator.interpolate(e.y1,t.y1,n)},onCompleted:()=>{e.annotations.remove(r),t()}});e.addAnimation(n)}))}let c=n;for(;null!=e.annotations.getById("unpaired-peak-"+c);){let t=e.annotations.getById("unpaired-peak-"+c);c++,null!=t&&l.push(new Promise(r=>{let n=new s.GenericAnimation({from:{opacity:t.opacity,y1:t.y1},to:{opacity:0,y1:t.y1-o},duration:500,ease:s.easing.inOutCirc,onAnimate:(e,r,n)=>{t.opacity=s.DoubleAnimator.interpolate(e.opacity,r.opacity,n),t.y1=s.DoubleAnimator.interpolate(e.y1,r.y1,n)},onCompleted:()=>{e.annotations.remove(t),r()}});e.addAnimation(n)}))}return await Promise.all(l)},updateBeltTensionChartAnnotations=async(e,t,r)=>{if(null==t||null==r||null==e)return await removeBeltTensionChartAnnotations(e);let{pairedPeaks:n,unpairedPeaks1:a,unpairedPeaks2:o}=r,i=0,l=0,c=n.flatMap(async(t,r)=>{let[n,a]=t,o=n.freq,l=n.amplitude,c=a.freq,u=a.amplitude,d=e.annotations.getById(String.fromCharCode(65+r)+"-peak-1"),f=e.annotations.getById(String.fromCharCode(65+r)+"-peak-2");return null==d||null==f?[Promise.resolve()]:(i++,[new Promise(t=>{let r=new s.GenericAnimation({from:{x1:d.x1,y1:d.y1},to:{x1:o,y1:l},duration:500,ease:s.easing.inOutCirc,onAnimate:(e,t,r)=>{d.x1=s.DoubleAnimator.interpolate(e.x1,t.x1,r),d.y1=s.DoubleAnimator.interpolate(e.y1,t.y1,r)},onCompleted:t});e.addAnimation(r)}),new Promise(t=>{let r=new s.GenericAnimation({from:{x1:f.x1,y1:f.y1},to:{x1:c,y1:u},duration:500,ease:s.easing.inOutCirc,onAnimate:(e,t,r)=>{f.x1=s.DoubleAnimator.interpolate(e.x1,t.x1,r),f.y1=s.DoubleAnimator.interpolate(e.y1,t.y1,r)},onCompleted:t});e.addAnimation(r)})])}).concat(a.concat(o).flatMap(async(t,r)=>{let n=t.freq,a=t.amplitude,o=e.annotations.getById("unpaired-peak-"+r);return null==o?[Promise.resolve()]:(l++,[new Promise(t=>{let r=new s.GenericAnimation({from:{x1:o.x1,y1:o.y1},to:{x1:n,y1:a},duration:500,ease:s.easing.inOutCirc,onAnimate:(e,t,r)=>{o.x1=s.DoubleAnimator.interpolate(e.x1,t.x1,r),o.y1=s.DoubleAnimator.interpolate(e.y1,t.y1,r)},onCompleted:t});e.addAnimation(r)})])}));return await Promise.all([removeBeltTensionChartAnnotations(e,i,l),...c])},useInputShapersState=()=>{let[e,t]=(0,l.useState)(null),[r,n]=(0,l.useState)([]),[a,o]=(0,l.useState)(null);return{shapers:r,setShapers:n,recommendedShaper:a,setRecommendedShaper:o,sequenceId:e,setSequenceId:t}},initSeriesSubcomponents=(e,t)=>{if(null==e)return null;let r=e.renderableSeries.asArray().find(e=>e.id===t.sequenceId);for(let n of(null!=r&&(r.rolloverModifierProps.tooltipTitle=t.name+" (Total)"),["x","y","z"]))if(null==e.renderableSeries.getById(t.sequenceId+"-sub-"+n)){let r="x"===n?"red":"y"===n?"yellow":"blue",a=new s.FastLineRenderableSeries(e.webAssemblyContext2D,{id:t.sequenceId+"-sub-"+n,dataSeries:new s.XyDataSeries(e.webAssemblyContext2D,{containsNaN:!1,isSorted:!0,xValues:t.psd[n].frequencies,yValues:t.psd[n].estimates}),stroke:c.DN[r][400],strokeThickness:2,yAxisId:i.ck});a.rolloverModifierProps.tooltipTitle=t.name+" Power",a.rolloverModifierProps.tooltipColor=r,a.animation=new s.WaveAnimation({duration:1e3,ease:s.easing.inOutCubic,fadeEffect:!0}),e.renderableSeries.add(a)}},updateSeriesSubcomponents=(e,t)=>{if(null==e)return null;let r=e.renderableSeries.asArray().find(e=>e.id===t.sequenceId);for(let n of(null!=r&&(r.rolloverModifierProps.tooltipTitle=t.name+" (Total)"),["x","y","z"])){let r=e.renderableSeries.getById(t.sequenceId+"-sub-"+n);if(null==r)continue;let a=new s.XyDataSeries(e.webAssemblyContext2D,{containsNaN:!1,isSorted:!0,xValues:t.psd[n].frequencies,yValues:t.psd[n].estimates});e.addDeletable(a),r.enqueueAnimation(new s.LineAnimation({duration:500,ease:s.easing.inOutCirc,dataSeries:a}))}},useSeriesSubcomponentsChart=()=>{let[e,t]=(0,l.useState)([]);return{subcomponentSeries:e,setSubcomponentSeries:t}},useInputShaperChart=(e,t,r,n)=>{let a=(0,l.useRef)(r);a.current=r;let o=(0,l.useRef)(n);o.current=n;let u=(0,l.useRef)(r),d=(0,l.useRef)(n),m=(0,l.useCallback)(function(e){var r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(null!=o.current&&null==e.renderableSeries.getById("recommended-shaper")){let r=new s.FastMountainRenderableSeries(e.webAssemblyContext2D,{id:"recommended-shaper",dataSeries:new s.XyDataSeries(e.webAssemblyContext2D,{containsNaN:!1,isSorted:!0,xValues:t.psd.total.frequencies,yValues:o.current.psd}),stroke:c.DN[o.current.color][400],fill:c.DN[o.current.color][600]+11,strokeThickness:4,yAxisId:i.ck});r.rolloverModifierProps.tooltipTitle=o.current.name.toLocaleUpperCase()+" @ "+Math.round(100*o.current.freq)/100+"Hz",r.rolloverModifierProps.tooltipColor=o.current.color,r.animation=new s.WaveAnimation({duration:1e3,ease:s.easing.inOutCirc,fadeEffect:!0}),e.renderableSeries.add(r)}null===(r=a.current)||void 0===r||r.forEach((r,a)=>{var l,u;if(null==e||n.includes(r.name)||null!=e.renderableSeries.getById(r.name))return;let d=new s.FastLineRenderableSeries(e.webAssemblyContext2D,{id:r.name,dataSeries:new s.XyDataSeries(e.webAssemblyContext2D,{containsNaN:!1,isSorted:!0,xValues:t.psd.total.frequencies,yValues:r.vals}),stroke:c.DN[r.color][400],strokeThickness:r.name===(null===(l=o.current)||void 0===l?void 0:l.name)?5:2,strokeDashArray:r.name===(null===(u=o.current)||void 0===u?void 0:u.name)?[10,5,2,5]:[3,5],yAxisId:i.Np});d.rolloverModifierProps.showRollover=!1,d.animation=new s.WaveAnimation({duration:1e3,ease:s.easing.inOutCubic,fadeEffect:!0}),e.renderableSeries.add(d)}),u.current=a.current},[t]),h=(0,l.useCallback)(async a=>{var l,c,h,g,y;if(null!=a){if(!0===e&&(null!==(c=null==r?void 0:r.length)&&void 0!==c?c:0)>0&&(!1===f()(r,u.current)||n&&(!1===f()(n,d.current)||null==d.current))){if((null!==(y=null===(g=u.current)||void 0===g?void 0:g.length)&&void 0!==y?y:0)>0){let e=[];a.renderableSeries.asArray().filter(e=>e.yAxisId===i.Np).forEach(n=>{var i,l,c,p;if(null==a)return;let m=null==r?void 0:r.find(e=>e.name===n.id),h=null===(i=u.current)||void 0===i?void 0:i.find(e=>e.name===n.id);if(m&&h&&!f()(m.vals,h.vals)||(null===(l=o.current)||void 0===l?void 0:l.name)===n.id&&(null===(c=d.current)||void 0===c?void 0:c.name)!=n.id){let e=new s.XyDataSeries(a.webAssemblyContext2D,{containsNaN:!1,isSorted:!0});if(a.addDeletable(e),null==m){e.appendRange(t.psd.total.frequencies,Array(n.dataSeries.count()).fill(0)),a.addDeletable(e),n.enqueueAnimation(new s.LineAnimation({duration:500,ease:s.easing.inOutCirc,fadeEffect:!0,reverse:!0,dataSeries:e,onCompleted:()=>{null==a||a.renderableSeries.remove(n,!0)}}));return}n.isRunningAnimation||(e.appendRange(t.psd.total.frequencies,m.vals),n.enqueueAnimation(new s.LineAnimation({duration:500,ease:s.easing.inOutCirc,dataSeries:e,styles:{strokeThickness:n.id===(null===(p=o.current)||void 0===p?void 0:p.name)?5:2}})))}e.push(n.id)}),m(a,e)}else m(a)}else(null==r?void 0:r.length)===0&&(null!==(h=null===(l=u.current)||void 0===l?void 0:l.length)&&void 0!==h?h:0)>0&&a.renderableSeries.asArray().filter(e=>e.yAxisId===i.Np||"recommended-shaper"===e.id).forEach(e=>{if(null==a||e.isRunningAnimation)return;let r=new s.XyDataSeries(a.webAssemblyContext2D,{containsNaN:!1,isSorted:!0});if(a.addDeletable(r),null==e.dataSeries){(0,p.j)().warn(e.id,"dataSeries is null");return}r.appendRange(t.psd.total.frequencies,Array(e.dataSeries.count()).fill(0)),e.enqueueAnimation(new s.LineAnimation({duration:500,fadeEffect:!0,reverse:!0,ease:s.easing.inOutCirc,dataSeries:r,onCompleted:()=>{null==a||a.renderableSeries.remove(e,!0)}}))});d.current=n,u.current=r}},[e,r,n,m,t.psd.total.frequencies]);return{updateInputShapers:h,initializeInputShapers:m,shapers:r,prevShapers:u}};s.SciChartSurface.configure({wasmUrl:"/configure/scichart2d.wasm",dataUrl:"/configure/scichart2d.data"});let MacroRunChart=e=>{var t;let{sequenceSeries:r,shapers:n,recommendedShaper:a,chart:d,prevShapers:p,subcomponentSeries:m}=e,[h,g]=(0,l.useState)(!1),y=(0,l.useRef)(h);y.current=h;let b=(0,l.useRef)(Promise.resolve()),x=(0,l.useRef)(m);x.current=m;let v=(0,l.useRef)(r),{updateInputShapers:w,initializeInputShapers:k}=useInputShaperChart((null!==(t=null==n?void 0:n.length)&&void 0!==t?t:0)>0,r[0],null!=n?n:[],a),S=(0,l.useCallback)(e=>{if(null==d.surface.current)return;let t=e.filter(e=>m.includes(e.sequenceId));if(0===v.current.length){setupChart(d.surface.current,e),k(d.surface.current),t.forEach(e=>{initSeriesSubcomponents(d.surface.current,e)});return}g(!0);let r=[];if(e.length===v.current.length){e.forEach((t,n)=>{var a,o,l,u;let f=null===(a=d.surface.current)||void 0===a?void 0:a.renderableSeries.get(n);if(f){if(null==d.surface.current)throw Error("Missing chart surface");let a=f.dataSeries.count();if((0,i.jh)(f.dataSeries)){let i=e[n+1];if(a>t.psd.total.frequencies.length){let e=Array(a-t.psd.total.frequencies.length).fill(0),r=Array(a-t.psd.total.estimates.length).fill(0);t.psd.total.frequencies.unshift(...e),t.psd.total.estimates.unshift(...r),i.psd.total.frequencies.unshift(...e),i.psd.total.estimates.unshift(...r)}a<t.psd.total.frequencies.length&&(t.psd.total.frequencies=t.psd.total.frequencies.slice(0,a),t.psd.total.estimates=t.psd.total.estimates.slice(0,a),i.psd.total.frequencies=i.psd.total.frequencies.slice(0,a),i.psd.total.estimates=i.psd.total.estimates.slice(0,a));let c=new s.XyyDataSeries(d.surface.current.webAssemblyContext2D,{containsNaN:!1,isSorted:!0});c.appendRange(t.psd.total.frequencies,t.psd.total.estimates,i.psd.total.estimates),d.surface.current.addDeletable(c),f.rolloverModifierProps.tooltipColor=null!==(o=t.color)&&void 0!==o?o:"zinc",f.rolloverModifierProps.tooltipTitle=t.name+" Power",f.rolloverModifierProps1.tooltipColor=null!==(l=i.color)&&void 0!==l?l:"zinc",f.rolloverModifierProps1.tooltipTitle=i.name+" Power",r.push(new Promise(e=>{f.runAnimation(new s.BandAnimation({duration:500,ease:s.easing.inOutCirc,dataSeries:c,onCompleted:e}))}))}if((0,i.Mg)(f.dataSeries)){if(a>t.psd.total.frequencies.length){let e=Array(a-t.psd.total.frequencies.length).fill(0),r=Array(a-t.psd.total.estimates.length).fill(0);t.psd.total.frequencies.unshift(...e),t.psd.total.estimates.unshift(...r)}a<t.psd.total.frequencies.length&&(t.psd.total.frequencies=t.psd.total.frequencies.slice(0,a),t.psd.total.estimates=t.psd.total.estimates.slice(0,a));let e=new s.XyDataSeries(d.surface.current.webAssemblyContext2D,{containsNaN:!1,isSorted:!0});e.appendRange(t.psd.total.frequencies,t.psd.total.estimates),d.surface.current.addDeletable(e),f.rolloverModifierProps.tooltipColor=null!==(u=t.color)&&void 0!==u?u:"zinc",f.rolloverModifierProps.tooltipTitle=t.name+" Power",r.push(new Promise(r=>{var n;f.runAnimation(new s.MountainAnimation({duration:500,ease:s.easing.inOutCirc,dataSeries:e,onCompleted:r,styles:{stroke:c.DN[null!==(n=t.color)&&void 0!==n?n:"zinc"][400]}}))}))}}}),w(d.surface.current),t.forEach(e=>{updateSeriesSubcomponents(d.surface.current,e)}),animateYAxis(d.surface.current,e),b.current=Promise.all(r);return}if(e.length!==v.current.length){var n;null===(n=d.surface.current)||void 0===n||n.renderableSeries.asArray().forEach(e=>{if(e){if(null==d.surface.current)throw Error("Missing chart surface");let t=e.dataSeries.count(),n=e.dataSeries.getNativeXValues(),a=[];for(let e=0;e<n.size();e++)a.push(n.get(e));if((0,i.jh)(e.dataSeries)){let n=new s.XyyDataSeries(d.surface.current.webAssemblyContext2D,{containsNaN:!1,isSorted:!0});n.appendRange(a,Array(t).fill(0),Array(t).fill(0)),d.surface.current.addDeletable(n),r.push(new Promise(t=>{e.runAnimation(new s.BandAnimation({duration:500,fadeEffect:!0,reverse:!0,ease:s.easing.inOutCirc,dataSeries:n,onCompleted:()=>{var r;null===(r=d.surface.current)||void 0===r||r.renderableSeries.remove(e),t()}}))}))}if((0,i.Mg)(e.dataSeries)){let n=new s.XyDataSeries(d.surface.current.webAssemblyContext2D,{containsNaN:!1,isSorted:!0});n.appendRange(a,Array(t).fill(0)),d.surface.current.addDeletable(n),r.push(new Promise(t=>{e.runAnimation(new s.LineAnimation({duration:500,ease:s.easing.inOutCirc,dataSeries:n,fadeEffect:!0,reverse:!0,onCompleted:()=>{var r;null===(r=d.surface.current)||void 0===r||r.renderableSeries.remove(e),t()}}))}))}}}),b.current=Promise.all(r).then(()=>new Promise(t=>{if(d.surface.current){var r,n;null===(r=d.surface.current)||void 0===r||r.renderableSeries.clear(),null===(n=d.surface.current)||void 0===n||n.chartModifiers.clear(),setupChart(d.surface.current,e)}t()}));return}},[d.surface,k,m,w]);return(0,l.useEffect)(()=>{0!=r.length&&!1===f()(r,v.current)?(d.surface.current&&S(r),v.current=r):d.surface.current&&w(d.surface.current)},[d.surface,k,p,r,n,m,S,w]),(0,l.useEffect)(()=>{m.length&&d.surface.current&&(y.current?b.current.then(()=>{x.current.forEach(e=>{r.filter(e=>x.current.includes(e.sequenceId)).forEach(e=>{initSeriesSubcomponents(d.surface.current,e)})})}):x.current.forEach(e=>{r.filter(e=>x.current.includes(e.sequenceId)).forEach(e=>{initSeriesSubcomponents(d.surface.current,e)})}))},[d.surface,r,m]),(0,o.jsx)(u.iB,{...d.forwardProps,className:"flex-1 bg-zinc-900/50"})};var m=r(58818),h=r(79293),g=r(74755),y=r(24360);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let b=(0,y.Z)("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]),x=(0,y.Z)("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var v=["shift","alt","meta","mod","ctrl"],w={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function mapKey(e){return(w[e]||e).trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function parseKeysHookInput(e,t){return void 0===t&&(t=","),e.split(t)}function parseHotkey(e,t,r){void 0===t&&(t="+");var n=e.toLocaleLowerCase().split(t).map(function(e){return mapKey(e)}),a={alt:n.includes("alt"),ctrl:n.includes("ctrl")||n.includes("control"),shift:n.includes("shift"),meta:n.includes("meta"),mod:n.includes("mod")},o=n.filter(function(e){return!v.includes(e)});return _extends({},a,{keys:o,description:r})}"undefined"!=typeof document&&(document.addEventListener("keydown",function(e){void 0!==e.key&&pushToCurrentlyPressedKeys([mapKey(e.key),mapKey(e.code)])}),document.addEventListener("keyup",function(e){void 0!==e.key&&removeFromCurrentlyPressedKeys([mapKey(e.key),mapKey(e.code)])})),"undefined"!=typeof window&&window.addEventListener("blur",function(){k.clear()});var k=new Set;function isReadonlyArray(e){return Array.isArray(e)}function pushToCurrentlyPressedKeys(e){var t=Array.isArray(e)?e:[e];k.has("meta")&&k.forEach(function(e){return!v.includes(e)&&k.delete(e.toLowerCase())}),t.forEach(function(e){return k.add(e.toLowerCase())})}function removeFromCurrentlyPressedKeys(e){var t=Array.isArray(e)?e:[e];"meta"===e?k.clear():t.forEach(function(e){return k.delete(e.toLowerCase())})}function isHotkeyEnabledOnTag(e,t){var r=e.target;void 0===t&&(t=!1);var n=r&&r.tagName;return isReadonlyArray(t)?!!(n&&t&&t.some(function(e){return e.toLowerCase()===n.toLowerCase()})):!!(n&&t&&!0===t)}var isHotkeyMatchingKeyboardEvent=function(e,t,r){void 0===r&&(r=!1);var n,a=t.alt,o=t.meta,i=t.mod,l=t.shift,s=t.ctrl,c=t.keys,u=e.key,d=e.code,f=e.ctrlKey,p=e.metaKey,m=e.shiftKey,h=e.altKey,g=mapKey(d),y=u.toLowerCase();if(!(null!=c&&c.includes(g))&&!(null!=c&&c.includes(y))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(g))return!1;if(!r){if(!h===a&&"alt"!==y||!m===l&&"shift"!==y)return!1;if(i){if(!p&&!f)return!1}else if(!p===o&&"meta"!==y&&"os"!==y||!f===s&&"ctrl"!==y&&"control"!==y)return!1}return!!(c&&1===c.length&&(c.includes(y)||c.includes(g)))||(c?(void 0===n&&(n=","),(isReadonlyArray(c)?c:c.split(n)).every(function(e){return k.has(e.trim().toLowerCase())})):!c)},S=(0,l.createContext)(void 0),C=(0,l.createContext)({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),stopPropagation=function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},N="undefined"!=typeof window?l.useLayoutEffect:l.useEffect;function useHotkeys(e,t,r,n){var a,o=(0,l.useRef)(null),i=(0,l.useRef)(!1),s=r instanceof Array?n instanceof Array?void 0:n:r,c=isReadonlyArray(e)?e.join(null==s?void 0:s.splitKey):e,u=r instanceof Array?r:n instanceof Array?n:void 0,d=(0,l.useCallback)(t,null!=u?u:[]),f=(0,l.useRef)(d);u?f.current=d:f.current=t;var p=(!function deepEqual(e,t){return e&&t&&"object"==typeof e&&"object"==typeof t?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(r,n){return r&&deepEqual(e[n],t[n])},!0):e===t}((a=(0,l.useRef)(void 0)).current,s)&&(a.current=s),a.current),m=(0,l.useContext)(C).enabledScopes,h=(0,l.useContext)(S);return N(function(){if((null==p?void 0:p.enabled)!==!1&&(e=null==p?void 0:p.scopes,0===m.length&&e?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):!!(!e||m.some(function(t){return e.includes(t)})||m.includes("*")))){var e,listener=function(e,t){var r;if(void 0===t&&(t=!1),!isHotkeyEnabledOnTag(e,["input","textarea","select"])||isHotkeyEnabledOnTag(e,null==p?void 0:p.enableOnFormTags)){if(null!==o.current){var n=o.current.getRootNode();if((n instanceof Document||n instanceof ShadowRoot)&&n.activeElement!==o.current&&!o.current.contains(n.activeElement)){stopPropagation(e);return}}(null==(r=e.target)||!r.isContentEditable||null!=p&&p.enableOnContentEditable)&&parseKeysHookInput(c,null==p?void 0:p.splitKey).forEach(function(r){var n,a,o,l=parseHotkey(r,null==p?void 0:p.combinationKey);if(isHotkeyMatchingKeyboardEvent(e,l,null==p?void 0:p.ignoreModifiers)||null!=(o=l.keys)&&o.includes("*")){if(null!=p&&null!=p.ignoreEventWhen&&p.ignoreEventWhen(e)||t&&i.current)return;if(("function"==typeof(n=null==p?void 0:p.preventDefault)&&n(e,l)||!0===n)&&e.preventDefault(),"function"==typeof(a=null==p?void 0:p.enabled)?!a(e,l):!0!==a&&void 0!==a){stopPropagation(e);return}f.current(e,l),t||(i.current=!0)}})}},handleKeyDown=function(e){void 0!==e.key&&(pushToCurrentlyPressedKeys(mapKey(e.code)),((null==p?void 0:p.keydown)===void 0&&(null==p?void 0:p.keyup)!==!0||null!=p&&p.keydown)&&listener(e))},handleKeyUp=function(e){void 0!==e.key&&(removeFromCurrentlyPressedKeys(mapKey(e.code)),i.current=!1,null!=p&&p.keyup&&listener(e,!0))},t=o.current||(null==s?void 0:s.document)||document;return t.addEventListener("keyup",handleKeyUp),t.addEventListener("keydown",handleKeyDown),h&&parseKeysHookInput(c,null==p?void 0:p.splitKey).forEach(function(e){return h.addHotkey(parseHotkey(e,null==p?void 0:p.combinationKey,null==p?void 0:p.description))}),function(){t.removeEventListener("keyup",handleKeyUp),t.removeEventListener("keydown",handleKeyDown),h&&parseKeysHookInput(c,null==p?void 0:p.splitKey).forEach(function(e){return h.removeHotkey(parseHotkey(e,null==p?void 0:p.combinationKey,null==p?void 0:p.description))})}}},[c,p,m]),o}var j=r(41087),A=r(73371),M=r(88192),_=r(30742),P=r(55237),R=r(63278);r(97485);var E=l.forwardRef((e,t)=>{let{children:r,...n}=e,a=l.Children.toArray(r),i=a.find(isSlottable);if(i){let e=i.props.children,r=a.map(t=>t!==i?t:l.Children.count(e)>1?l.Children.only(null):l.isValidElement(e)?e.props.children:null);return(0,o.jsx)(z,{...n,ref:t,children:l.isValidElement(e)?l.cloneElement(e,void 0,r):null})}return(0,o.jsx)(z,{...n,ref:t,children:r})});E.displayName="Slot";var z=l.forwardRef((e,t)=>{let{children:r,...n}=e;if(l.isValidElement(r)){let e,a;let o=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.props.ref:r.props.ref||r.ref;return l.cloneElement(r,{...function(e,t){let r={...t};for(let n in t){let a=e[n],o=t[n],i=/^on[A-Z]/.test(n);i?a&&o?r[n]=(...e)=>{o(...e),a(...e)}:a&&(r[n]=a):"style"===n?r[n]={...a,...o}:"className"===n&&(r[n]=[a,o].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props),ref:t?function(...e){return t=>e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}(t,o):o})}return l.Children.count(r)>1?l.Children.only(null):null});z.displayName="SlotClone";var Slottable=({children:e})=>(0,o.jsx)(o.Fragment,{children:e});function isSlottable(e){return l.isValidElement(e)&&e.type===Slottable}var I=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=l.forwardRef((e,r)=>{let{asChild:n,...a}=e,i=n?E:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(i,{...a,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),D="Progress",[O,T]=function(e,t=[]){let r=[],createScope=()=>{let t=r.map(e=>l.createContext(e));return function(r){let n=r?.[e]||t;return l.useMemo(()=>({[`__scope${e}`]:{...r,[e]:n}}),[r,n])}};return createScope.scopeName=e,[function(t,n){let a=l.createContext(n),i=r.length;function Provider(t){let{scope:r,children:n,...s}=t,c=r?.[e][i]||a,u=l.useMemo(()=>s,Object.values(s));return(0,o.jsx)(c.Provider,{value:u,children:n})}return r=[...r,n],Provider.displayName=t+"Provider",[Provider,function(r,o){let s=o?.[e][i]||a,c=l.useContext(s);if(c)return c;if(void 0!==n)return n;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let createScope=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let n=r.reduce((t,{useScope:r,scopeName:n})=>{let a=r(e),o=a[`__scope${n}`];return{...t,...o}},{});return l.useMemo(()=>({[`__scope${t.scopeName}`]:n}),[n])}};return createScope.scopeName=t.scopeName,createScope}(createScope,...t)]}(D),[q,B]=O(D),V=l.forwardRef((e,t)=>{var r,n;let{__scopeProgress:a,value:i=null,max:l,getValueLabel:s=defaultGetValueLabel,...c}=e;(l||0===l)&&!isValidMaxNumber(l)&&console.error((r=`${l}`,`Invalid prop \`max\` of value \`${r}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let u=isValidMaxNumber(l)?l:100;null===i||isValidValueNumber(i,u)||console.error((n=`${i}`,`Invalid prop \`value\` of value \`${n}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let d=isValidValueNumber(i,u)?i:null,f=isNumber(d)?s(d,u):void 0;return(0,o.jsx)(q,{scope:a,value:d,max:u,children:(0,o.jsx)(I.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":isNumber(d)?d:void 0,"aria-valuetext":f,role:"progressbar","data-state":getProgressState(d,u),"data-value":d??void 0,"data-max":u,...c,ref:t})})});V.displayName=D;var L="ProgressIndicator",F=l.forwardRef((e,t)=>{let{__scopeProgress:r,...n}=e,a=B(L,r);return(0,o.jsx)(I.div,{"data-state":getProgressState(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});function defaultGetValueLabel(e,t){return`${Math.round(e/t*100)}%`}function getProgressState(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function isNumber(e){return"number"==typeof e}function isValidMaxNumber(e){return isNumber(e)&&!isNaN(e)&&e>0}function isValidValueNumber(e,t){return isNumber(e)&&!isNaN(e)&&e<=t&&e>=0}F.displayName=L;var U=r(64929);let H=l.forwardRef((e,t)=>{let{className:r,value:n,...a}=e;return(0,o.jsx)(V,{ref:t,className:(0,U.cn)("relative h-2 w-full overflow-hidden rounded-full bg-lime-400/20",r),...a,children:(0,o.jsx)(F,{className:"h-full w-full flex-1 bg-lime-400 transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});(0,U.h)(H,V.displayName);var K=r(34709),X=r(70206),Q=r(98130),W=r(28351);let Z=1,InputShapers=e=>{let{recordings:t,sequenceId:n,currentRunId:a,setRecommendedShaper:i,setShapers:s,shapers:u,recommendedShaper:d}=e,[f,m]=(0,l.useState)(!1),[h,g]=(0,l.useState)(0),y=(0,l.useRef)(null),b=(0,l.useRef)(null),[x,v]=(0,l.useState)(!1),w=null!=n?t.find(t=>t.sequenceId===e.sequenceId):null;return(0,l.useEffect)(()=>{s([]),i(null)},[a,i,s]),(0,l.useEffect)(()=>(y.current=new Worker(r.tu(new URL(r.p+r.u(965),r.b))),y.current.onmessage=e=>{let t=e.data;if("findBestShaper"===t.type&&t.jobId===b.current){performance.mark("findBestShaperEnd");let e=performance.measure("findBestShaper","findBestShaperStart","findBestShaperEnd");(0,p.j)().info(e,"Best shaper found in "+e.duration+" ms");let r=0;for(let t of P.$l){let n=performance.measure("fitShaper-"+t.name,{start:e.startTime,end:"fitShaper-"+t.name});(0,p.j)().info(n,"Fitting "+t.name+" took "+(n.duration-r)+" ms"),r=n.duration}s(t.shapers.filter(Boolean)),i(t.result),m(!1)}if("fitShaper"===t.type&&t.jobId===b.current){var r;if(performance.mark("fitShaper-"+(null===(r=t.result)||void 0===r?void 0:r.name)),null!=t.result){let e=t.result;s(t=>[...t.filter(t=>t.name!=e.name),e])}}"findBestShaperProgress"===t.type&&t.jobId===b.current&&g(t.progress),"jobCancelled"===t.type&&t.id===b.current&&(m(!1),g(0),s([]),b.current=null)},v(!0),()=>{var e;v(!1),null===(e=y.current)||void 0===e||e.terminate()}),[i,s]),(0,l.useEffect)(()=>{if(null!=w&&x){var e;let t=Z++;return b.current=t,m(t),g(0),performance.mark("findBestShaperStart"),null===(e=y.current)||void 0===e||e.postMessage({id:t,type:"findBestShaper",calibrationData:w.psd.total,scv:w.scv}),()=>{var e;null===(e=y.current)||void 0===e||e.postMessage({type:"cancelJob",id:t}),m(!1)}}s([]),i(null)},[w,x,s,i]),(0,o.jsxs)("div",{children:[(0,o.jsx)(K.i,{containerClassName:"overflow-hidden",children:(f||u.length>0)&&(0,o.jsxs)(X.iA,{className:"rounded-none",containerClassName:"rounded-none",children:[(0,o.jsx)(X.xD,{children:(0,o.jsxs)(X.SC,{className:"text-xs",children:[(0,o.jsx)(X.ss,{className:"",children:"Shaper"}),(0,o.jsx)(X.ss,{className:"",children:"Freq."}),(0,o.jsx)(X.ss,{className:"text-right",children:(0,o.jsx)("div",{className:"flex justify-end",children:"Vibr."})}),(0,o.jsx)(X.ss,{className:"text-right",children:(0,o.jsx)("div",{className:"flex justify-end",children:"Smooth."})}),(0,o.jsx)(X.ss,{className:"text-right",children:(0,o.jsx)("div",{className:"flex justify-end",children:"Rec. Accel."})})]})}),(0,o.jsx)(X.RM,{children:u.map(e=>(0,o.jsxs)(X.SC,{style:{color:c.DN[e.color][400]},className:(0,R.dV)("text-xs",(null==d?void 0:d.name)===e.name&&"font-bold"),children:[(0,o.jsxs)(X.pj,{className:"whitespace-nowrap text-nowrap",children:[(0,o.jsx)(W.Z,{className:"inline-block size-5",strokeWidth:e.name===(null==d?void 0:d.name)?"4":"2",strokeDasharray:e.name===(null==d?void 0:d.name)?"7, 6.5":"3, 5",strokeLinecap:"square"})," ",e.name.toLocaleUpperCase()]}),(0,o.jsxs)(X.pj,{children:[(Math.round(100*e.freq)/100).toFixed(2),"hz"]}),(0,o.jsxs)(X.pj,{className:"text-right",children:[(100*e.vibrs).toFixed(2),"%"]}),(0,o.jsx)(X.pj,{className:"text-right",children:e.smoothing.toFixed(2)}),(0,o.jsxs)(X.pj,{className:"whitespace-nowrap text-nowrap text-right",children:[Math.round(e.maxAccel)," mm/s",(0,o.jsx)("sup",{children:"2"})]})]},e.name))})]})}),f?(0,o.jsxs)("div",{className:"mt-0 block space-y-3 p-3 text-xs text-muted-foreground",children:[(0,o.jsx)(Q.$,{className:"mr-1 inline-block size-4",noMargin:!0,strokeWidth:4})," Calculating input shapers (",(100*h).toFixed(2),"%)...",(0,o.jsx)(H,{value:100*h})]}):null!=d&&(0,o.jsxs)("div",{className:"mt-0 block space-y-3 p-3 text-xs text-muted-foreground",children:[d.name.toLocaleUpperCase()," is recommended at ",d.freq.toFixed(2),"Hz. Resulting in a resonance reduction of ",(100-d.vibrs).toFixed(2),"%. Recommended maximum acceleration before noticeable smoothing is ",Math.round(d.maxAccel)," mm/s",(0,o.jsx)("sup",{children:"2"})]})]})};var G=r(28967);let detectPeaks=(e,t,r,n)=>{let a=new s.XyMovingAverageFilter(new s.XyDataSeries(e.webAssemblyContext2D,{containsNaN:!1,isSorted:!0,xValues:t.frequencies,yValues:t.estimates}),{length:3,isSorted:!0,containsNaN:!1}),o=a.getNativeYValues(),l=[];n&&e.renderableSeries.add(new s.FastLineRenderableSeries(e.webAssemblyContext2D,{dataSeries:a,yAxisId:i.ck,stroke:n,strokeThickness:5,strokeDashArray:[5,5]}));let c=t.frequencies[1]-t.frequencies[0],u=Math.ceil(10/c);isFinite(u)||(u=10);let d=[];for(let e=1;e<o.size();e++){let n=o.get(e-1),a=o.get(e),i=o.get(e+1);if(n<a&&a>i&&a>r){let r=e;Array(u).fill(0).forEach((n,a)=>{let o=e-a;o>0&&o<t.estimates.length&&t.estimates[o]>t.estimates[r]&&t.estimates[o-1]<t.estimates[o]&&t.estimates[o+1]<t.estimates[o]&&(r=o)}),-1===d.indexOf(r)&&(d.push(r),l.push({freq:t.frequencies[r],amplitude:t.estimates[r]}))}}return l},pairPeaks=(e,t)=>{let r=[],n=e.slice(),a=t.slice(),o=[];for(let r of e)for(let e of t)o.push(Math.abs(r.freq-e.freq));o.sort((e,t)=>e-t);let i=(0,G.XL)(o,50),l=(0,G.XL)(o,75)-(0,G.XL)(o,25),s=i+1.5*l;s=Math.min(s,10);let c=0;for(;n.length>0&&a.length>0&&c<n.length*a.length;){c++;let e=s+1,t=null;for(let r of n)for(let n of a){let a=Math.abs(r.freq-n.freq);a<e&&(e=a,t=[r,n])}t&&(r.push(t),n.splice(n.indexOf(t[0]),1),a.splice(a.indexOf(t[1]),1))}return{pairedPeaks:r,unpairedPeaks1:n,unpairedPeaks2:a}},padSignal=(e,t)=>e.length>=t?e:[...e,...Array(t-e.length).fill(0)],BeltTensionComparison=e=>{let{sequencePair:t,chart:r,setPeakPairingResults:n,setMechanicalHealth:a,peakPairingResults:i,mechanicalHealth:s}=e,c=(0,l.useRef)(null),[u,d]=(0,l.useState)(null),p=(0,l.useRef)(null),m=(0,l.useCallback)(e=>{d(e.id)},[]);return(0,l.useEffect)(()=>{r.onInitialize(m)},[r,r.onInitialize,m]),(0,l.useEffect)(()=>{if(r.isInitialized){if(null!=t&&2===t.length&&null!=r.surface.current){let e=.12*Math.max(t[0].psd.total.powerRange.max,t[1].psd.total.powerRange.max),o=detectPeaks(r.surface.current,t[0].psd.total,e),i=detectPeaks(r.surface.current,t[1].psd.total,e),l=pairPeaks(o,i),s=function(e,t){let r=Math.max(e.psd.estimates.length,t.psd.estimates.length),n=padSignal(e.psd.estimates,r),a=padSignal(t.psd.estimates,r),o=100*(0,G.d6)(n,a),i=e.unpairedPeaks.length+t.unpairedPeaks.length,l=e.pairedPeaks.length,s=e.unpairedPeaks.concat(t.unpairedPeaks),c=Math.max(e.psd.powerRange.max,t.psd.powerRange.max),u=o;l>=2&&(u*=2/l),l<2&&(u*=l/2);let d=0;if(i>0){for(let e of s)d+=e.amplitude/c*30;u-=d}return{mhi:u=Math.max(0,Math.min(u,100)),label:function(e){let t=Math.max(0,Math.min(e,100));for(let[e,r,n]of[[90,100,"Excellent mechanical health"],[70,90,"Good mechanical health"],[55,70,"Acceptable mechanical health"],[45,55,"Potential signs of overtensioning"],[30,45,"Potential signs of mechanical issues or overtensioning"],[15,30,"Very likely mechanical issues"],[0,15,"Mechanical issues detected"]])if(t>=e&&t<=r)return n;return"Unknown mechanical health"}(u)}}({pairedPeaks:l.pairedPeaks,unpairedPeaks:l.unpairedPeaks1,psd:t[0].psd.total},{pairedPeaks:l.pairedPeaks,unpairedPeaks:l.unpairedPeaks2,psd:t[1].psd.total});n(l),a(s),u!==c.current?(initBeltTensionChartAnnotations(r.surface.current,t,l),c.current=u,p.current=l):f()(p.current,l)||(updateBeltTensionChartAnnotations(r.surface.current,t,l).then(()=>initBeltTensionChartAnnotations(r.surface.current,t,l,0)),p.current=l)}else null==t&&null!=c.current&&(n(null),a(null),updateBeltTensionChartAnnotations(r.surface.current,null,null),c.current=null)}},[t,a,r.surface,n,r.isInitialized,u]),(0,o.jsx)(K.i,{containerClassName:"overflow-hidden",children:i&&t&&(0,o.jsxs)("div",{children:[(0,o.jsxs)(X.iA,{className:"rounded-none",containerClassName:"rounded-none",children:[(0,o.jsx)(X.xD,{children:(0,o.jsxs)(X.SC,{className:"text-xs",children:[(0,o.jsx)(X.ss,{className:"",children:"Pair"}),(0,o.jsx)(X.ss,{className:"text-right",children:(0,o.jsx)("div",{className:"flex justify-end",children:"Freq. Delta"})}),(0,o.jsx)(X.ss,{className:"text-right",children:(0,o.jsx)("div",{className:"flex justify-end",children:"Ampl. Delta"})})]})}),(0,o.jsx)(X.RM,{children:i.pairedPeaks.map((e,t)=>(0,o.jsxs)(X.SC,{className:(0,R.dV)("text-xs"),children:[(0,o.jsxs)(X.pj,{className:"whitespace-nowrap text-nowrap",children:["Peaks ",String.fromCharCode(65+t)]}),(0,o.jsxs)(X.pj,{className:"text-right",children:[(Math.round(10*Math.abs(e[0].freq-e[1].freq))/10).toFixed(1),"hz"]}),(0,o.jsxs)(X.pj,{className:"text-right",children:[(Math.abs(e[0].amplitude-e[1].amplitude)/Math.max(e[0].amplitude,e[1].amplitude)*100).toFixed(1),"%"]})]},e[0].freq+e[1].freq))})]}),(0,o.jsxs)("div",{className:"mt-0 grid grid-cols-2 gap-3 p-3",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(A.ll,{className:"text-sm",children:"Estimated Similarity"}),(0,o.jsxs)(A.SZ,{className:"text-xs",children:[null==s?void 0:s.mhi.toFixed(1),"%"]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(A.ll,{className:"text-sm",children:"Status"}),(0,o.jsx)(A.SZ,{className:"text-xs",children:null==s?void 0:s.label})]}),(0,o.jsxs)("div",{className:"col-span-full",children:[(0,o.jsx)(A.ll,{className:"text-sm",children:"Unpaired Peaks"}),(0,o.jsxs)(A.SZ,{className:"text-xs",children:[i.unpairedPeaks1.length," on ",t[0].name]}),(0,o.jsxs)(A.SZ,{className:"text-xs",children:[i.unpairedPeaks2.length," on ",t[1].name]})]})]})]})})};j.Zr.defaultLocale="en-GB";let J=j.ou.local().locale,MacroRun=e=>{let{id:t,runId:r}=e,[n,s]=(0,l.useState)(r),[c]=h.SX.analysis.findMacro.useSuspenseQuery({id:t}),[u]=h.SX.analysis.getRunRecordings.useSuspenseQuery({runId:n,macroId:t},{keepPreviousData:!0}),d=useInputShapersState(),p=useSeriesSubcomponentsChart(),y=useBeltTensionState(),[{next:v,previous:w}]=h.SX.analysis.getNextAndPreviousRunRecordingIds.useSuspenseQuery({macroId:t,runId:n},{keepPreviousData:!0});useHotkeys("left",()=>{null!=w&&s(w)},[w]),useHotkeys("right",()=>{null!=v&&s(v)},[v]);let k=(0,l.useMemo)(()=>{let e=j.ou.fromMillis(u.result[0].startTimeStamp),t=j.ou.fromMillis(u.result[u.result.length-1].endTimeStamp),r=e.equals(t)?e.toFormat("yyyy-MM-dd HH:mm"):"".concat(e.toFormat("yyyy-MM-dd HH:mm")," - ").concat(t.toFormat("HH:mm")),n=j.ou.fromMillis(u.result[0].startTimeStamp).setLocale(J).toLocaleString({dateStyle:"long",timeStyle:"short"}),a=j.nL.fromMillis(u.result[u.result.length-1].endTimeStamp-u.result[0].startTimeStamp).shiftTo("minutes","seconds").toHuman({unitDisplay:"short",maximumSignificantDigits:2});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{title:r,className:"min-w-0 truncate",children:n}),(0,o.jsx)("div",{className:"min-w-0 truncate opacity-80",children:a})]})},[u]),S=(0,l.useMemo)(()=>u.result.flatMap(e=>{var t,r;let n=c.sequences.find(t=>t.id===e.sequenceId);return(null==n?void 0:n.recording)?{sequenceId:n.id,color:null!==(r=null==n?void 0:null===(t=n.recording)||void 0===t?void 0:t.color)&&void 0!==r?r:"lime",name:e.name,psd:e.psd,type:a.Mountain}:null}).filter(Boolean),[u,c]),C=(0,l.useCallback)(e=>{setupChart(e,S)},[S]),N=(0,_.Q8)(i.OH,C),{setSubcomponentSeries:P}=p,{setSequenceId:R}=d,{setSequencePair:E}=y,z=(0,l.useRef)(y.sequencePair);return z.current=y.sequencePair,(0,l.useEffect)(()=>{if(1===u.result.length){let e=u.result[0].sequenceId;R(e),P(t=>t.filter(t=>t!==e).concat([e]))}else P([]),R(null)},[u.result,R,P]),(0,l.useEffect)(()=>{let e=[S[0],S[1]];2!==u.result.length||2!==S.length||f()(z.current,e)?f()(z.current,e)||E(null):E(e)},[u.result.length,S,E]),(0,m.Ty)("Analysis",(0,l.useCallback)(e=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(e.MenubarMenu,{children:[(0,o.jsx)(e.MenubarTrigger,{className:"cursor-pointer",asChild:!0,children:(0,o.jsxs)("span",{onClick:()=>window.history.back(),children:[(0,o.jsx)(e.MenubarIcon,{Icon:g.Z}),(0,o.jsx)("span",{className:"hidden lg:inline",children:"Back"})]})}),(0,o.jsx)(e.MenubarContent,{className:"hidden"})]}),(0,o.jsxs)(e.MenubarMenu,{children:[(0,o.jsx)(e.MenubarTrigger,{asChild:!0,disabled:null==w,children:(0,o.jsxs)("span",{onClick:()=>null!=w&&s(w),children:[(0,o.jsx)(e.MenubarIcon,{Icon:b}),(0,o.jsx)("span",{className:"hidden lg:inline",children:"Previous recording"})]})}),(0,o.jsx)(e.MenubarContent,{className:"hidden"})]}),(0,o.jsxs)(e.MenubarMenu,{children:[(0,o.jsx)(e.MenubarTrigger,{asChild:!0,disabled:null==v,children:(0,o.jsxs)("span",{onClick:()=>null!=v&&s(v),children:[(0,o.jsx)(e.MenubarIcon,{Icon:x}),(0,o.jsx)("span",{className:"hidden lg:inline",children:"Next recording"})]})}),(0,o.jsx)(e.MenubarContent,{className:"hidden"})]})]}),[v,w,s])),(0,o.jsxs)("div",{className:"relative flex flex-1",children:[(0,o.jsx)(MacroRunChart,{sequenceSeries:S,chart:N,shapers:d.shapers,recommendedShaper:d.recommendedShaper,subcomponentSeries:p.subcomponentSeries}),(0,o.jsxs)(M.Card,{className:"absolute right-4 top-4 w-[420px]",children:[(0,o.jsxs)(A.Ol,{className:"flex flex-row items-center gap-2 space-y-0 p-3 @sm:p-3",children:[(0,o.jsx)(A.ll,{className:"flex-1",children:c.name}),(0,o.jsx)(A.SZ,{className:"m-0 text-right text-xs",children:k})]}),(0,o.jsx)(BeltTensionComparison,{chart:N,...y}),1===u.result.length&&(0,o.jsx)(InputShapers,{currentRunId:n,...d,recordings:u.result})]})]})}},28967:function(e,t,r){"use strict";r.d(t,{P0:function(){return sumArray},XL:function(){return calculatePercentile},d6:function(){return pearsonCorrelation}});let sumArray=e=>e.reduce((e,t)=>e+t,0),meanArray=e=>sumArray(e)/e.length;function pearsonCorrelation(e,t){if(e.length!==t.length)throw Error("Input arrays must have the same length.");let r=e.length,n=meanArray(e),a=meanArray(t),o=0,i=0,l=0;for(let s=0;s<r;s++){let r=e[s]-n,c=t[s]-a;o+=r*c,i+=r*r,l+=c*c}let s=Math.sqrt(i)*Math.sqrt(l);return 0===s?0:o/s}function calculatePercentile(e,t){e.sort((e,t)=>e-t);let r=t/100*(e.length-1),n=Math.floor(r),a=Math.ceil(r);return n===a?e[n]:e[n]+(e[a]-e[n])*(r-n)}},34709:function(e,t,r){"use strict";r.d(t,{i:function(){return AnimatedContainer}});var n=r(72612),a=r(97060),o=r(99699),i=r(73790),l=r(39164),s=r(63278);let AnimatedContainer=e=>{let[t,r]=(0,l.useState)(0),c=(0,l.useRef)(t);c.current=t;let[u,d]=(0,l.useState)(!1),f=(0,l.useRef)(u);f.current=u;let p=(0,l.useRef)(null);(0,o.Z)(p,e=>{e.contentRect.height!==c.current&&r(e.contentRect.height)});let m=(0,a.N)((0,l.useCallback)(()=>{d(!0)},[]),200,!0),h=(0,a.N)((0,l.useCallback)(()=>{d(!1)},[]),200,!0);return(0,n.jsx)(i.E.div,{className:(0,s.m6)(u?"overflow-visible":"overflow-hidden",e.containerClassName),style:{height:t},onAnimationComplete:m,onAnimationStart:h,animate:{height:t},transition:e.transition,children:(0,n.jsx)("div",{ref:p,className:e.className,children:e.children})})}},39634:function(e,t,r){"use strict";r.d(t,{Bd:function(){return l},Ct:function(){return Badge},_1:function(){return s},iA:function(){return u},xU:function(){return c}});var n=r(72612),a=r(73918),o=r(63278),i=r(94594);let l=i.z.union([i.z.literal("rose"),i.z.literal("red"),i.z.literal("yellow"),i.z.literal("orange"),i.z.literal("green"),i.z.literal("lime"),i.z.literal("blue"),i.z.literal("sky"),i.z.literal("indigo"),i.z.literal("purple"),i.z.literal("pink"),i.z.literal("brand"),i.z.literal("gray"),i.z.literal("plain")]),s=(0,a.j)("",{variants:{color:{rose:"text-rose-700 dark:text-rose-400",red:"text-red-700 dark:text-red-400",yellow:"text-yellow-800 dark:text-yellow-500",orange:"text-orange-800 dark:text-orange-500",green:"text-green-700 dark:text-green-400",lime:"text-lime-700 dark:text-lime-400",blue:"text-blue-700 dark:text-blue-400",sky:"text-sky-700 dark:text-sky-400",indigo:"text-indigo-700 dark:text-indigo-400",purple:"text-purple-700 dark:text-purple-400",pink:"text-pink-700 dark:text-pink-400",brand:"text-brand-700 dark:text-brand-400",gray:"text-zinc-600 dark:text-zinc-400",plain:"text-zinc-900 dark:text-zinc-100"}}}),c=(0,a.j)("",{variants:{color:{rose:"bg-rose-50 dark:bg-rose-400/10",red:"bg-red-50 dark:bg-red-400/10",yellow:"bg-yellow-50 dark:bg-yellow-400/10",orange:"bg-orange-50 dark:bg-orange-400/10",green:"bg-green-50 dark:bg-green-500/10",lime:"bg-lime-50 dark:bg-lime-500/10",blue:"bg-blue-50 dark:bg-blue-400/10",sky:"bg-sky-50 dark:bg-sky-400/10",indigo:"bg-indigo-50 dark:bg-indigo-400/10",purple:"bg-purple-50 dark:bg-purple-400/10",pink:"bg-pink-50 dark:bg-pink-400/10",brand:"bg-brand-100 dark:bg-brand-400/10",gray:"bg-zinc-50 dark:bg-zinc-400/10",plain:"bg-zinc-900/10 dark:bg-zinc-100/10"}}}),u=(0,a.j)("",{variants:{color:{rose:"border-rose-600/10 dark:border-rose-400/20 ring-rose-600/10 dark:ring-rose-400/20",red:"border-red-600/10 dark:border-red-400/20 ring-red-600/10 dark:ring-red-400/20",yellow:"border-yellow-600/20 dark:border-yellow-400/20 ring-yellow-600/20 dark:ring-yellow-400/20",orange:"border-orange-600/20 dark:border-orange-400/20 ring-orange-600/20 dark:ring-orange-400/20",green:"border-green-600/20 dark:border-green-500/20 ring-green-600/20 dark:ring-green-500/20",lime:"border-lime-600/20 dark:border-lime-500/20 ring-lime-600/20 dark:ring-lime-500/20",blue:"border-blue-700/10 dark:border-blue-400/30 ring-blue-700/10 dark:ring-blue-400/30",sky:"border-sky-700/10 dark:border-sky-400/30 ring-sky-700/10 dark:ring-sky-400/30",indigo:"border-indigo-700/10 dark:border-indigo-400/30 ring-indigo-700/10 dark:ring-indigo-400/30",purple:"border-purple-700/10 dark:border-purple-400/30 ring-purple-700/10 dark:ring-purple-400/30",pink:"border-pink-700/10 dark:border-pink-400/20 ring-pink-700/10 dark:ring-pink-400/20",brand:"border-brand-600/40 dark:border-brand-400/30 ring-brand-600/40 dark:ring-brand-400/30",gray:"border-zinc-500/10 dark:border-zinc-400/20 ring-zinc-500/10 dark:ring-zinc-400/20",plain:"border-zinc-900 dark:border-zinc-100 ring-zinc-900 dark:ring-zinc-100"}}}),d=(0,a.j)("flex-0 inline-flex w-auto items-center rounded-md font-medium ring-1 ring-inset",{variants:{size:{sm:"px-1.5 gap-1.5 py-1 text-2xs leading-3",md:"px-2 gap-2 py-1 text-xs leading-4",lg:"px-2 gap-2 py-1 text-xs leading-6"},color:{rose:[c({color:"rose"}),u({color:"rose"}),s({color:"rose"})],red:[c({color:"red"}),u({color:"red"}),s({color:"red"})],yellow:[c({color:"yellow"}),u({color:"yellow"}),s({color:"yellow"})],orange:[c({color:"orange"}),u({color:"orange"}),s({color:"orange"})],green:[c({color:"green"}),u({color:"green"}),s({color:"green"})],lime:[c({color:"lime"}),u({color:"lime"}),s({color:"lime"})],blue:[c({color:"blue"}),u({color:"blue"}),s({color:"blue"})],sky:[c({color:"sky"}),u({color:"sky"}),s({color:"sky"})],indigo:[c({color:"indigo"}),u({color:"indigo"}),s({color:"indigo"})],purple:[c({color:"purple"}),u({color:"purple"}),s({color:"purple"})],pink:[c({color:"pink"}),u({color:"pink"}),s({color:"pink"})],brand:[c({color:"brand"}),u({color:"brand"}),s({color:"brand"})],gray:[c({color:"gray"}),u({color:"gray"}),s({color:"gray"})],plain:[c({color:"plain"}),u({color:"plain"}),s({color:"plain"})]}},defaultVariants:{size:"md",color:"gray"}}),Badge=e=>{let{size:t,color:r,className:a,children:i,...l}=e;return(0,n.jsx)("span",{className:(0,o.m6)(d({size:t,color:r}),a),...l,children:i})}},34471:function(e,t,r){"use strict";r.d(t,{j:function(){return Banner}});var n=r(72612);r(39164);var a=r(39634),o=r(63278),i=r(73918);let l=(0,i.j)("rounded-md p-4 border",{variants:{color:{red:[(0,a.xU)({color:"red"}),(0,a.iA)({color:"red"}),(0,a._1)({color:"red"})],yellow:[(0,a.xU)({color:"yellow"}),(0,a.iA)({color:"yellow"}),(0,a._1)({color:"yellow"})],orange:[(0,a.xU)({color:"orange"}),(0,a.iA)({color:"orange"}),(0,a._1)({color:"orange"})],green:[(0,a.xU)({color:"green"}),(0,a.iA)({color:"green"}),(0,a._1)({color:"green"})],lime:[(0,a.xU)({color:"lime"}),(0,a.iA)({color:"lime"}),(0,a._1)({color:"lime"})],blue:[(0,a.xU)({color:"blue"}),(0,a.iA)({color:"blue"}),(0,a._1)({color:"blue"})],sky:[(0,a.xU)({color:"sky"}),(0,a.iA)({color:"sky"}),(0,a._1)({color:"sky"})],indigo:[(0,a.xU)({color:"indigo"}),(0,a.iA)({color:"indigo"}),(0,a._1)({color:"indigo"})],purple:[(0,a.xU)({color:"purple"}),(0,a.iA)({color:"purple"}),(0,a._1)({color:"purple"})],pink:[(0,a.xU)({color:"pink"}),(0,a.iA)({color:"pink"}),(0,a._1)({color:"pink"})],brand:[(0,a.xU)({color:"brand"}),(0,a.iA)({color:"brand"}),(0,a._1)({color:"brand"})],gray:[(0,a.xU)({color:"gray"}),(0,a.iA)({color:"gray"}),(0,a._1)({color:"gray"})]}},defaultVariants:{color:"gray"}}),Banner=e=>{let{Icon:t,className:r,title:a}=e;return(0,n.jsx)("div",{className:(0,o.m6)(l({color:e.color}),e.className),children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(t,{className:(0,o.dV)("h-5 w-5"),"aria-hidden":"true"})}),(0,n.jsxs)("div",{className:"ml-3 flex-1",children:[(0,n.jsx)("h3",{className:(0,o.dV)("text-sm font-bold"),children:e.title}),(0,n.jsx)("div",{className:"mt-2 text-sm",children:e.children})]})]})})}},94809:function(e,t,r){"use strict";r.d(t,{d:function(){return f},z:function(){return p}});var n=r(72612),a=r(82157),o=r.n(a),i=r(63278),l=r(39164),s=r(73918),c=r(3496),u=r(44649),d=r(35088);let f=(0,s.j)("inline-flex items-center justify-center border font-semibold rounded-md shadow-sm focus:outline-none focus:ring-2 capitalize relative active:translate-y-px active:scale-[99%] active:outline-none transition-all",{variants:{variant:{danger:(0,i.dV)("text-red-50 bg-red-500/70 hover:bg-red-600 border-transparent focus:ring-offset-2 focus:ring-red-400 dark:focus:ring-offset-zinc-900","shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]","dark:before:-inset-px dark:before:rounded-lg","dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--red-900)),_0px_1px_0px_0px_hsl(var(--red-400)_/_50%)_inset]"),warning:(0,i.dV)("text-yellow-50 bg-yellow-400/70 hover:bg-yellow-600 border-transparent focus:ring-offset-2 focus:ring-yellow-400 dark:focus:ring-offset-zinc-900","shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]","dark:before:-inset-px dark:before:rounded-lg","dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--yellow-900)),_0px_1px_0px_0px_hsl(var(--yellow-400)_/_50%)_inset]"),info:(0,i.dV)("text-blue-50 bg-sky-400/70 hover:bg-sky-600 border-transparent focus:ring-offset-2 focus:ring-sky-400 dark:focus:ring-offset-zinc-900","shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]","dark:before:-inset-px dark:before:rounded-lg","dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--sky-900)),_0px_1px_0px_0px_hsl(var(--sky-400)_/_50%)_inset]"),primary:(0,i.dV)("text-white bg-brand-400/50 hover:bg-brand-700 border-transparent focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900","shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]","dark:before:-inset-px dark:before:rounded-lg","dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--brand-900)),_0px_1px_0px_0px_hsl(var(--brand-400)_/_50%)_inset]"),success:"text-green-100 bg-green-500 hover:bg-green-600 border-transparent focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900",indeterminate:(0,i.dV)("border-transparent bg-zinc-100 hover:bg-zinc-200 text-black dark:text-zinc-300 dark:bg-zinc-800 dark:transparent dark:hover:bg-zinc-700 dark:hover:text-zinc-100 dark:hover:transparent focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900","shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]","dark:before:-inset-px dark:before:rounded-lg","dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--zinc-900)),_0px_1px_0px_0px_hsl(var(--zinc-400)_/_20%)_inset]"),outline:"border-zinc-700 shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 hover:bg-zinc-500/30 hover:border-zinc-500/50 hover:text-zinc-800 dark:hover:text-zinc-200 focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900",plain:"border-transparent shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 hover:underline hover:text-zinc-800 dark:hover:text-zinc-200 focus:ring-offset-2 focus:ring-brand-400 dark:focus:ring-offset-zinc-900"},disabled:{true:"opacity-60 cursor-not-allowed"},size:{sm:"px-2 py-1 text-xs gap-2",lg:"px-6 py-3 text-lg gap-4",default:"px-3 py-2 text-sm gap-2",icon:"h-9 w-9","icon-sm":"h-6 w-6","icon-xs":"h-4 w-4"}},compoundVariants:[{variant:"primary",disabled:!0,class:"hover:bg-brand-400/50"},{variant:"danger",disabled:!0,class:"hover:bg-red-500/70"},{variant:"warning",disabled:!0,class:"hover:bg-yellow-500"},{variant:"indeterminate",disabled:!0,class:"hover:bg-zinc-100 dark:hover:bg-zinc-800"},{variant:"info",disabled:!0,class:"hover:bg-sky-400/70"}],defaultVariants:{variant:"primary",size:"default",disabled:!1}}),p=(0,l.forwardRef)(function(e,t){let{variant:r,disabled:a,size:s,href:p,target:m,onClick:h,title:g,rel:y,dropdownItems:b,className:x,children:v,...w}=e,k=(0,i.m6)(f({variant:r,disabled:a,size:s}),x);return p?(0,n.jsx)(o(),{href:p,ref:t,className:k,target:m,onClick:h,title:g,rel:y,children:v}):b&&b.length&&null==h?(0,n.jsxs)(c.v,{as:"span",className:"relative inline-block text-left",children:[(0,n.jsxs)(c.v.Button,{className:k,title:g,disabled:!!a,children:[v,(0,n.jsx)(d,{className:"-mr-2 h-5 w-5","aria-hidden":"true"})]}),(0,n.jsx)(u.u,{as:l.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,n.jsx)(c.v.Items,{className:"absolute right-0 z-10 mt-2 w-56 origin-top-right divide-y divide-zinc-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none dark:divide-zinc-800 dark:bg-zinc-900 dark:shadow-black dark:ring-zinc-800",children:b.map(e=>(0,n.jsx)("div",{className:"py-1",children:(0,n.jsx)(c.v.Item,{children:t=>{let{active:r}=t;return(0,n.jsx)("span",{onClick:e.onClick,className:(0,i.dV)(r?"bg-zinc-100 text-zinc-900 dark:bg-zinc-800 dark:text-zinc-100":"text-zinc-700 dark:text-zinc-300","block cursor-pointer break-words px-4 py-2 text-sm"),children:e.title})}})},e.title))})})]}):(0,n.jsx)("button",{ref:t,className:k,onClick:a?void 0:h,title:g,...w,children:v})})},98130:function(e,t,r){"use strict";r.d(t,{$:function(){return Spinner}});var n=r(72612),a=r(63278);let Spinner=e=>{var t,r;return(0,n.jsxs)("svg",{className:(0,a.m6)("h-5 w-5 animate-spin text-black/50 dark:text-white/50",e.noMargin?"":"-ml-1 mr-3",e.className),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-20",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:null!==(t=e.strokeWidth)&&void 0!==t?t:4}),(0,n.jsx)("circle",{className:"opacity-100",cx:"12",cy:"12",r:"10",strokeDasharray:10*Math.PI/3,strokeLinecap:"round",stroke:"currentColor",strokeWidth:null!==(r=e.strokeWidth)&&void 0!==r?r:4})]})}},73371:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return s},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var n=r(72612),a=r(39164),o=r(64929);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-4 @sm:p-6",r),...a})});i.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,o.cn)("font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let s=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...a})});s.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("p-4 pt-0 @sm:p-6",r),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-4 pt-0 @sm:p-6",r),...a})});u.displayName="CardFooter"},66751:function(e,t,r){"use strict";r.d(t,{$N:function(){return p},Be:function(){return m},Vq:function(){return s},cZ:function(){return f},fK:function(){return DialogHeader},hg:function(){return c}});var n=r(72612),a=r(39164),o=r(19958),i=r(90077),l=r(64929);let s=o.fC,c=o.xz,u=o.h_;o.x8;let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(o.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...a})});d.displayName=o.aV.displayName;let f=a.forwardRef((e,t)=>{let{className:r,children:a,noClose:s,...c}=e;return(0,n.jsxs)(u,{children:[(0,n.jsx)(d,{}),(0,n.jsxs)(o.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...c,children:[a,!s&&(0,n.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[(0,n.jsx)(i.Pxu,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=o.VY.displayName;let DialogHeader=e=>{let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};DialogHeader.displayName="DialogHeader";let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(o.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",r),...a})});p.displayName=o.Dx.displayName;let m=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(o.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})});m.displayName=o.dk.displayName},70206:function(e,t,r){"use strict";r.d(t,{RM:function(){return c},SC:function(){return d},iA:function(){return l},pj:function(){return p},ss:function(){return f},xD:function(){return s}});var n=r(72612),a=r(39164),o=r(64929),i=r(63278);let l=a.forwardRef((e,t)=>{let{className:r,containerClassName:a,...l}=e;return(0,n.jsx)("div",{className:(0,i.dV)("scrollable, relative w-full overflow-auto rounded-md border",a),children:(0,n.jsx)("table",{ref:t,className:(0,o.cn)("w-full caption-bottom rounded-md text-sm",r),...l})})});(0,o.h)(l,"Table");let s=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("thead",{ref:t,className:(0,o.cn)("border-l border-l-zinc-400/5 bg-zinc-400/5 [&_tr]:border-b",r),...a})});(0,o.h)(s,"TableHeader");let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,o.cn)("rounded-b-sm [&_tr:last-child]:rounded-b-sm [&_tr:last-child]:border-b-0",r),...a})});(0,o.h)(c,"TableBody");let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,o.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})});(0,o.h)(u,"TableFooter");let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tr",{ref:t,className:(0,o.cn)("border-x-transparent border-t-transparent transition-colors data-[state=selected]:!border data-[state=selected]:!border-brand-800 data-[state=selected]:!bg-brand-400/10 data-[state=selected]:ring-1 data-[state=selected]:ring-brand-800 [tbody>&]:border [tbody>&]:hover:border-x-muted/50 [tbody>&]:hover:bg-muted/50",r),...a})});(0,o.h)(d,"TableRow");let f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("th",{ref:t,className:(0,o.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});(0,o.h)(f,"TableHead");let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("td",{ref:t,className:(0,o.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});(0,o.h)(p,"TableCell");let m=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("caption",{ref:t,className:(0,o.cn)("mt-4 text-sm text-muted-foreground",r),...a})});(0,o.h)(m,"TableCaption")},75061:function(e,t,r){"use strict";r.d(t,{N:function(){return n}});let n={timestamp:!0,level:"info"}},10187:function(e,t,r){"use strict";r.d(t,{S:function(){return n.SX},u:function(){return n.uF}});var n=r(79293)},81446:function(e,t,r){"use strict";r.d(t,{X:function(){return getHost},t:function(){return formatBytes}});let getHost=()=>{var e;return""!="".trim()?"":(null===(e=window.location)||void 0===e?void 0:e.hostname)!=null?window.location.hostname:null};function formatBytes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0==e)return"0 bytes";var r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(t))+" "+["bytes","kb","mb","gb","tb","pb","eb","zb","yb"][r]}},96886:function(e,t,r){"use strict";r.d(t,{oK:function(){return useMoonraker},xH:function(){return useMoonrakerMutation},DS:function(){return useMoonrakerQuery},Fu:function(){return useMoonrakerState},A4:function(){return useNamespacedItemQuery},hS:function(){return usePrinterObjectQuery},Q:function(){return usePrinterObjectSubscription}});var n=r(39164),a=r(9948),o=r(65339),i=r(84634),l=r(81446);let s=[{version:1,description:"Undo double JSON encoding of RatOS's data",up:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(!e.ok)return{result:"Nothing to migrate"};{let t=await e.json();if("error"in t)throw Error(t.error.message);let r=[];if(null==t.result.value)return{result:"Nothing to migrate"};for await(let[e,r]of Object.entries(t.result.value))try{let t=JSON.parse(r);console.log("Migrating",e,"from",r,"to",t),await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:e,value:t})})}catch(t){console.error("Error migrating",e,r,"clearing key"),await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS&key=").concat(encodeURIComponent(e)),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:e})});continue}return{result:"Succesfully decoded ".concat(r.length," keys.\n").concat(r.join("\n"))}}},down:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(e.ok){let t=await e.json();if("error"in t)throw Error(t.error.message);if(null==t.result.value)return{result:"Nothing to migrate"};let r=[];for await(let[e,n]of Object.entries(t.result.value)){let t=JSON.stringify(n);await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:e,value:t})}),r.push("Re-encoded ".concat(e))}return{result:"Succesfully re-encoded ".concat(r.length," keys.\n").concat(r.join("\n"))}}return{result:"Nothing to migrate"}}},{version:2,description:"Change caramba printers to v-core-4 / v-chonk",up:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(!e.ok)return{result:"Nothing to migrate"};{let t=await e.json();if("error"in t)throw Error(t.error.message);let r=[];if(null==t.result.value)return{result:"Nothing to migrate"};for await(let[e,n]of Object.entries(t.result.value))if("Printer"===e&&"string"==typeof n){let e=n.replace(/caramba-chonk/g,"v-chonk").replace(/caramba/g,"v-core-4");if(e===n)continue;await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:"Printer",value:e})}),r.push("Migrated ".concat(n," to ").concat(e))}return{result:"Succesfully migrated ".concat(r.length," keys.\n").concat(r.join("\n"))}}},down:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(!e.ok)return{result:"Nothing to migrate"};{let t=await e.json();if("error"in t)throw Error(t.error.message);let r=[];if(null==t.result.value)return{result:"Nothing to migrate"};for await(let[e,n]of Object.entries(t.result.value))if("Printer"===e&&"string"==typeof n){let e=n.replace(/v-chonk/g,"caramba-chonk").replace(/v-core-4/g,"caramba");if(e===n)continue;await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:"Printer",value:e})}),r.push("Migrated ".concat(n," to ").concat(e))}return{result:"Succesfully migrated ".concat(r.length," keys.\n").concat(r.join("\n"))}}}}],getCurrentVersion=async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS&key=__db_version"));if(e.ok){let t=await e.json();return"error"in t?0:t.result.value}return 0},setCurrentVersion=async e=>{await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:"__db_version",value:e})})},c=!1,migrate=async(e,t)=>{if(c)return console.log("Already migrating, ignoring..");if(e===t)return console.log("Already at target version");c=!0;try{let r=s.filter(r=>r.version>e&&r.version<=t).sort((r,n)=>e<=t?r.version-n.version:n.version-r.version);for await(let n of r){let r=await (e<t?n.up():n.down());console.log("Migrated to version ".concat(n.version,": ").concat(r.result))}await setCurrentVersion(t)}finally{c=!1}},u=!1,migrateToLatest=async()=>{if(u)return console.log("Already migrated, ignoring..");let e=await getCurrentVersion(),t=Math.max(...s.map(e=>e.version));if(e===t){console.log("Already at latest version");return}if(c){console.log("Already migrating, ignoring..");return}console.log("Migrating to latest version...",e,t),await migrate(e,t),u=!0,console.log("Migration complete.")};var d=r(52540),f=r(86736),p=r.n(f),m=r(98948);let h=0,getWsURL=()=>{let e=(0,l.X)();return null==e||""==e.trim()?null:"ws://".concat(e,"/websocket")},g={},useMoonraker=e=>{let t=(0,n.useRef)({}),r=(0,n.useRef)({}),a=(0,n.useRef)([]),o=(0,n.useRef)([]),[l,s]=(0,n.useState)(getWsURL());(0,n.useEffect)(()=>{s(getWsURL())},[]);let c=(0,n.useCallback)(e=>{if("error"in e)return!1;if("notify_status_update"===e.method&&null!=e.params){let t=e.params[0];if(null!=t)for(let e of a.current){let r=g[e];if(null!=r){for(let e in r)if(null!=t[e])return!0}}}return!1},[]),{lastJsonMessage:u,sendJsonMessage:d,readyState:f}=(0,i.ZP)(l,{filter:r=>{if("connected"!==y)return!0;try{var n;let a=JSON.parse(r.data);if(null!=t.current[a.id]||(null==e?void 0:null===(n=e.passThroughUpdateMethods)||void 0===n?void 0:n.length)&&"method"in a&&e.passThroughUpdateMethods.includes(a.method))return!0}catch(e){(0,m.j)().warn({e,messageData:r.data},"Filter: Failed to parse message")}return!1},onMessage:t=>{if(null==e?void 0:e.onStatusUpdate)try{let n=JSON.parse(t.data);if(c(n)){var r;let t=n.params[0];null===(r=e.onStatusUpdate)||void 0===r||r.call(e,t)}}catch(e){(0,m.j)().warn({e,messageData:t.data},"OnMessage: Failed to parse message")}},shouldReconnect:e=>!0,reconnectAttempts:1/0,reconnectInterval:3e3,share:!0}),p=(0,n.useRef)(f);p.current=f;let[y,b]=(0,n.useState)(1===f?"connected":"connecting"),x=(0,n.useCallback)((e,t)=>{1===p.current?e():o.current.push({resolve:e,reject:t})},[]),v=(0,n.useCallback)(()=>new Promise((e,t)=>{x(e,t)}),[x]),w=(0,n.useCallback)(async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=++h;return await v(),new Promise((o,i)=>{t.current[a]=(e,t)=>e?i(e):t&&"object"==typeof t&&"error"in t&&t.error?i(t.error):null==t?i(Error("No result. Unknown response format.")):void o(t);let l=1e4;"printer.gcode.script"===e&&(l=6e5),r.current[a]=window.setTimeout(()=>{var e,n;null===(e=(n=t.current)[a])||void 0===e||e.call(n,Error("Request timed out"),null),delete t.current[a],delete r.current[a]},l),d({jsonrpc:"2.0",method:e,params:n,id:a})})},[v,d]),k=(0,n.useCallback)(async function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=Object.fromEntries(t.map(e=>[e,null])),o=Object.assign({},n,...Object.values(g).filter(e=>null!=e)),i=w("printer.objects.subscribe",{objects:o}),l=h;g[l]=n,a.current.push(l);let s=(await i).status;return{res:s,unsuscribe:async()=>{if(a.current=a.current.filter(e=>e!==l),null==g[l]){delete g[l];let e=Object.assign({},...Object.values(g).filter(e=>null!=e));await w("printer.objects.subscribe",{objects:e})}}}},[w]),S=(0,n.useCallback)(async(e,t,r)=>(await v(),await w("server.database.post_item",{namespace:e,key:t,value:r})),[w,v]),C=(0,n.useCallback)(async(e,t)=>{await v();try{var r;let n=await w("server.database.get_item",{namespace:e,key:t});return null!==(r=null==n?void 0:n.value)&&void 0!==r?r:null}catch(e){return(0,m.j)().warn(e),null}},[w,v]);return(0,n.useEffect)(()=>{1===f?(async()=>{await migrateToLatest(),o.current.forEach(e=>e.resolve()),o.current=[],b("connected")})():b("connecting")},[f]),(0,n.useEffect)(()=>{(null==u?void 0:u.id)&&t.current[u.id]&&(window.clearTimeout(r.current[u.id]),"error"in u?t.current[u.id](Error(u.error.message),null):t.current[u.id](null,u.result),delete r.current[u.id],delete t.current[u.id])},[u]),(0,n.useEffect)(()=>()=>{for(let e in r.current)delete r.current[e],delete t.current[e];if(a.current.length>0){a.current.forEach(e=>{delete g[e]}),a.current=[];let e=Object.assign({},...Object.values(g).filter(e=>null!=e));w("printer.objects.subscribe",{objects:Object.keys(e).length>0?e:null}).catch(e=>{})}o.current.forEach(e=>e.reject()),o.current=[]},[]),{query:w,saveItem:S,getItem:C,subscribeToObject:k,status:y,lastMessage:u,isReady:1===f}},useNamespacedItemQuery=(e,t,r)=>{let{getItem:n}=useMoonraker();return(0,a.a)({...r,queryKey:[e,t],queryFn:async()=>n(e,t)})},useMoonrakerQuery=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{query:n}=useMoonraker(),o=3===t.length?t[2]:t[1],i=3===t.length?t[1]:void 0,l=t[0],s=3===t.length?[l,i]:[l];return(0,a.a)({...null!=o?o:{},queryKey:[t[0]],queryFn:async()=>n(...s)})},useMoonrakerMutation=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{query:n}=useMoonraker(),a=t[1],i=t[0];return(0,o.D)({...a,mutationKey:[t[0]],mutationFn:async e=>{let t=e?[i,e]:[i];return n(...t)}})},usePrinterObjectQuery=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{query:n}=useMoonraker();return(0,a.a)({queryKey:t,queryFn:async()=>{let e=Object.fromEntries(t.map(e=>[e,null]));return(await n("printer.objects.query",{objects:e})).status}})},usePrinterObjectSubscription=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];let[o,i]=(0,n.useState)(null),l=(0,n.useRef)(o);l.current=o;let s=(0,n.useRef)(e);s.current=e;let c=(0,n.useCallback)(e=>{var t;return null==s.current?e:null===(t=s.current)||void 0===t?void 0:t.call(s,e)},[]),u=(0,n.useMemo)(()=>Object.fromEntries(r.map(e=>[e,null])),[JSON.stringify(r.sort())]),{subscribeToObject:f}=useMoonraker({onStatusUpdate:(0,n.useCallback)(e=>{let t={};for(let r in u)null!=e[r]&&(t[r]=e[r]);let r=c(t);if(null==r||"object"!=typeof r)throw Error("Invalid selection function, must return object, got "+typeof r);Object.keys(t).length>0&&!1===p()(r,l.current)&&i(e=>(0,d.T)(null!=e?e:{},r))},[c,u])});return(0,n.useEffect)(()=>{let e=f(...Object.keys(u));return e.then(e=>{i(c(e.res))}).catch(e=>{e instanceof Error&&(0,m.j)().error(e)}),()=>{e.then(e=>e.unsuscribe()).catch(e=>{e instanceof Error&&(0,m.j)().error(e)})}},[c,u,f]),o},useNamespacedItemMutation=(e,t,r)=>{let{saveItem:n}=useMoonraker();return(0,o.D)({...r,mutationKey:[e,t],mutationFn:r=>n(e,t,r)})},useMoonrakerState=function(e,t){var r;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=useNamespacedItemQuery(e,t,{initialData:a}),i=useNamespacedItemMutation(e,t),l=(0,n.useCallback)(async e=>{var t;let r="function"==typeof e?e(null!==(t=o.data)&&void 0!==t?t:a):e;await i.mutateAsync(r,{onSuccess:()=>{o.refetch()}})},[a,i,o]);return[null!==(r=o.data)&&void 0!==r?r:a,l,o,i]}},79293:function(e,t,r){"use strict";r.d(t,{SX:function(){return o},uF:function(){return i}});var n=r(67763),a=r(61863);function getBaseUrl(){return"/configure"}r(28070);let o=(0,a.t)({config:()=>({links:[(0,n.N8)({url:"".concat(getBaseUrl(),"/api/trpc"),maxURLLength:2083})]}),overrides:{useMutation:{async onSuccess(e){await e.originalFn(),await e.queryClient.invalidateQueries()}}},ssr:!1}),i=(0,n.K5)({links:[(0,n.N8)({url:"".concat(getBaseUrl(),"/api/trpc"),maxURLLength:2083})]})},31354:function(e,t,r){"use strict";r.d(t,{s:function(){return o}});var n=r(94594);let a=n.z.enum(["trace","debug","info","warn","error","fatal"]),o=n.z.object({ts:n.z.number(),messages:n.z.array(n.z.any()),bindings:n.z.array(n.z.record(n.z.string(),n.z.any())),level:n.z.object({label:a,value:n.z.number()})})}},function(e){e.O(0,[6545,9996,5809,8602,2401,966,8965,5360,3790,453,2705,9754,3150,5591,6645,1778,1563,1880,9583,7163,3127,8693,1087,2307,7652,8888,2003,9321,8458,1744],function(){return e(e.s=79162)}),_N_E=e.O()}]);
//# sourceMappingURL=page-c4b8cff6cbae06d7.js.map