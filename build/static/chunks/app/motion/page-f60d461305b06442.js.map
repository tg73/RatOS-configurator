{"version":3,"file":"static/chunks/app/motion/page-f60d461305b06442.js","mappings":"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","sources":["webpack://_N_E/?17e6","webpack://_N_E/./app/motion/motion.tsx","webpack://_N_E/./app/motion/page.tsx","webpack://_N_E/<anon>"],"sourcesContent":["import(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/app/motion/page.tsx\")","'use client';\nimport { AnimatedContainer } from '@/components/common/animated-container';\nimport { Button } from '@/components/common/button';\nimport { Card } from '@/components/common/card';\nimport { Spinner } from '@/components/common/spinner';\nimport { FileChanges } from '@/components/setup-steps/file-changes';\nimport { PrinterRailSettings } from '@/components/setup-steps/printer-rail-settings';\nimport { CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { serializePrinterConfiguration, usePrinterConfiguration } from '@/hooks/usePrinterConfiguration';\nimport { deserializePrinterRailDefinition } from '@/utils/serialization';\nimport { trpc } from '@/utils/trpc';\nimport { useQuery } from '@tanstack/react-query';\nimport { LayoutGroup } from 'framer-motion';\nimport { useState, useMemo, useCallback } from 'react';\nimport { toast } from 'sonner';\n\nexport const Motion = () => {\n\tconst { selectedBoard, selectedPrinter, performanceMode, selectedPrinterRails, parsedPrinterConfiguration } =\n\t\tusePrinterConfiguration();\n\tlet formattedErrors = parsedPrinterConfiguration.success === false ? parsedPrinterConfiguration.error.format() : null;\n\tconst [filesToOverwrite, setFilesToOverwrite] = useState<string[]>([]);\n\n\tconst [filesToIgnore, setFilesToIgnore] = useState<string[]>([]);\n\n\tconst serializedPrinterConfiguration = useMemo(() => {\n\t\tif (parsedPrinterConfiguration.success === true) {\n\t\t\treturn serializePrinterConfiguration(parsedPrinterConfiguration.data);\n\t\t}\n\t\treturn null;\n\t}, [parsedPrinterConfiguration]);\n\n\tconst saveConfigurationMutation = trpc.printer.saveConfiguration.useMutation();\n\tconst saveConfiguration = useCallback(async () => {\n\t\tif (parsedPrinterConfiguration.success) {\n\t\t\tsaveConfigurationMutation.mutate(\n\t\t\t\t{\n\t\t\t\t\tconfig: serializePrinterConfiguration(parsedPrinterConfiguration.data),\n\t\t\t\t\toverwriteFiles: filesToOverwrite,\n\t\t\t\t\tskipFiles: filesToIgnore,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tonSuccess: () => toast.success('Configuration saved'),\n\t\t\t\t\tonError: () => toast.error('Failed to save configuration'),\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}, [parsedPrinterConfiguration, saveConfigurationMutation, filesToOverwrite, filesToIgnore]);\n\n\tconst client = trpc.useUtils().client;\n\tconst filesToWrite = useQuery({\n\t\tqueryKey: ['filesToWrite', serializedPrinterConfiguration],\n\t\tqueryFn: async () => {\n\t\t\tconst res = await client.printer.getFilesToWrite.mutate({\n\t\t\t\tconfig: serializedPrinterConfiguration ?? ({} as any),\n\t\t\t});\n\t\t\treturn res;\n\t\t},\n\t\tenabled: parsedPrinterConfiguration.success,\n\t});\n\n\tconst requiresExplicitFileActions = filesToWrite.data?.some(\n\t\t(f) =>\n\t\t\tf.state === 'changed' &&\n\t\t\tf.changedFromConfig === true &&\n\t\t\tf.overwrite === false &&\n\t\t\t!filesToIgnore.includes(f.fileName) &&\n\t\t\t!filesToOverwrite.includes(f.fileName),\n\t);\n\n\tif (selectedPrinter == null) {\n\t\treturn (\n\t\t\t<div className=\"mx-auto flex items-center justify-center p-8\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t);\n\t}\n\treturn (\n\t\t<div className=\"grid gap-8\">\n\t\t\t<LayoutGroup id=\"rails\">\n\t\t\t\t<AnimatedContainer className=\"grid gap-4 @3xl:grid-cols-2 @6xl:grid-cols-3\">\n\t\t\t\t\t{selectedPrinterRails.map((rail, ri) => {\n\t\t\t\t\t\tconst defaultRail = selectedPrinter?.defaults.rails.find((r) => r.axis === rail.axis);\n\t\t\t\t\t\tif (defaultRail == null) {\n\t\t\t\t\t\t\tthrow new Error('No printer default for axis ' + rail.axis);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<PrinterRailSettings\n\t\t\t\t\t\t\t\tkey={rail.axis}\n\t\t\t\t\t\t\t\terrors={formattedErrors?.rails?.[ri] != null ? formattedErrors.rails[ri] : { _errors: [] }}\n\t\t\t\t\t\t\t\tselectedBoard={selectedBoard}\n\t\t\t\t\t\t\t\tprinterRail={rail}\n\t\t\t\t\t\t\t\tprinterRailDefault={deserializePrinterRailDefinition(defaultRail)}\n\t\t\t\t\t\t\t\tperformanceMode={performanceMode}\n\t\t\t\t\t\t\t\tisVisible={true}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</AnimatedContainer>\n\t\t\t</LayoutGroup>\n\t\t\t<AnimatedContainer>\n\t\t\t\t{(filesToWrite.data?.filter((f) => f.state !== 'unchanged').length ?? 0) > 0 && (\n\t\t\t\t\t<Card>\n\t\t\t\t\t\t<CardHeader>\n\t\t\t\t\t\t\t<CardTitle>File Changes</CardTitle>\n\t\t\t\t\t\t</CardHeader>\n\t\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t\t<FileChanges\n\t\t\t\t\t\t\t\tserializedConfig={parsedPrinterConfiguration.success ? serializedPrinterConfiguration : null}\n\t\t\t\t\t\t\t\tonFilesToIgnoreChange={setFilesToIgnore}\n\t\t\t\t\t\t\t\tonFilesToOverwriteChange={setFilesToOverwrite}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</CardContent>\n\t\t\t\t\t\t<CardFooter>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={saveConfiguration}\n\t\t\t\t\t\t\t\tdisabled={\n\t\t\t\t\t\t\t\t\tsaveConfigurationMutation.isLoading ||\n\t\t\t\t\t\t\t\t\t!parsedPrinterConfiguration.success ||\n\t\t\t\t\t\t\t\t\trequiresExplicitFileActions\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{saveConfigurationMutation.isLoading && <Spinner />} Save Configuration\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</CardFooter>\n\t\t\t\t\t</Card>\n\t\t\t\t)}\n\t\t\t</AnimatedContainer>\n\t\t</div>\n\t);\n};\n","'use client';\nimport React from 'react';\nimport { Motion } from '@/app/motion/motion';\nimport { Spinner } from '@/components/common/spinner';\nimport { useIsClient } from '@/hooks/isClient';\nimport { NoSSR } from '@/components/common/no-ssr';\nimport { PrinterStateHeader } from '@/components/common/printer-state-header';\n\nconst LoadScreen: React.FC = () => {\n\treturn (\n\t\t<div>\n\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\tLoading printer configuration...\n\t\t\t\t</h3>\n\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\tPlease wait while RatOS loads your printer configuration\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div className=\"mt-4 flex h-48 items-center justify-center\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default function Page() {\n\tconst isClient = useIsClient();\n\treturn isClient ? (\n\t\t<div className=\"grid grid-cols-1 gap-6 @container\">\n\t\t\t<PrinterStateHeader\n\t\t\t\ttitle=\"Motion Settings\"\n\t\t\t\tdescription=\"You can change your motion settings below, be aware that any change will require the config to be regenerated\"\n\t\t\t/>\n\t\t\t<div className=\"mx-auto w-full max-w-7xl px-4\">\n\t\t\t\t<React.Suspense fallback={<LoadScreen />}>\n\t\t\t\t\t<NoSSR fallback={<LoadScreen />}>\n\t\t\t\t\t\t<Motion />\n\t\t\t\t\t</NoSSR>\n\t\t\t\t</React.Suspense>\n\t\t\t</div>\n\t\t</div>\n\t) : null;\n}\n"],"names":["Promise","resolve","then","__webpack_require__","bind","Motion","filesToWrite","selectedBoard","selectedPrinter","performanceMode","selectedPrinterRails","parsedPrinterConfiguration","usePrinterConfiguration","formattedErrors","success","error","format","filesToOverwrite","setFilesToOverwrite","useState","filesToIgnore","setFilesToIgnore","serializedPrinterConfiguration","useMemo","serializePrinterConfiguration","data","saveConfigurationMutation","trpc","printer","saveConfiguration","useMutation","useCallback","mutate","config","overwriteFiles","skipFiles","onSuccess","toast","onError","client","useUtils","useQuery","queryKey","queryFn","res","getFilesToWrite","enabled","requiresExplicitFileActions","some","f","state","changedFromConfig","overwrite","includes","fileName","jsx_runtime","jsx","div","className","Spinner","jsxs","LayoutGroup","id","AnimatedContainer","map","rail","ri","defaultRail","defaults","rails","find","r","axis","PrinterRailSettings","errors","_errors","printerRail","printerRailDefault","deserializePrinterRailDefinition","isVisible","filter","length","Card","CardHeader","CardTitle","CardContent","FileChanges","serializedConfig","onFilesToIgnoreChange","onFilesToOverwriteChange","CardFooter","Button","onClick","disabled","isLoading","LoadScreen","h3","p","Page","isClient","useIsClient","PrinterStateHeader","title","description","React","fallback","NoSSR"],"sourceRoot":""}