"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2003],{43955:function(e,r,t){t.d(r,{DN:function(){return h},NI:function(){return f}});var n=t(38188),a=t.n(n),o=t(13558),i=t.n(o),l=t(78478),s=t(85982),c=t.n(s),u=t(33619),d=t.n(u),p={darkMode:"class",content:["./pages/**/*.{js,ts,jsx,tsx}","./components/**/*.{js,ts,jsx,tsx}","./helpers/**/*.{js,ts,jsx,tsx}","./app/**/*.{js,ts,jsx,tsx}","./data/**/*.{js,ts,jsx,tsx}"],theme:{container:{center:!0,padding:"2rem",screens:{"2xl":"1400px"}},extend:{fontFamily:{sans:["var(--inter-font)",...i().fontFamily.sans]},keyframes:{ping:{"0%":{opacity:"100"},"75%, 100%":{transform:"scale(2)",opacity:"0"}},"accordion-down":{from:{height:"0"},to:{height:"var(--radix-accordion-content-height)"}},"accordion-up":{from:{height:"var(--radix-accordion-content-height)"},to:{height:"0"}}},animation:{"spin-fast":"spin 0.5s linear infinite","accordion-down":"accordion-down 0.2s ease-out","accordion-up":"accordion-up 0.2s ease-out"},colors:{brand:{50:"#f2ffe1",100:"#deffcc",200:"#bdff99",300:"#9cff66",400:"#7bff33",500:"#5aff00",600:"#48cc00",700:"#369900",800:"#246600",900:"#123300"},border:"hsl(var(--border))",input:"hsl(var(--input))",ring:"hsl(var(--ring))",background:"hsl(var(--background))",foreground:"hsl(var(--foreground))",primary:{DEFAULT:"hsl(var(--brand-400) / 50%)",foreground:"hsl(var(--white))"},secondary:{DEFAULT:"hsl(var(--secondary))",foreground:"hsl(var(--white))"},destructive:{DEFAULT:"hsl(var(--red-400))",foreground:"hsl(var(--black))"},muted:{DEFAULT:"hsl(var(--muted))",foreground:"hsl(var(--muted-foreground))"},accent:{DEFAULT:"hsl(var(--accent))",foreground:"hsl(var(--white))"},popover:{DEFAULT:"hsl(var(--popover))",foreground:"hsl(var(--popover-foreground))"},card:{DEFAULT:"hsl(var(--card))",foreground:"hsl(var(--card-foreground))"}},borderRadius:{lg:"var(--radius)",md:"calc(var(--radius) - 2px)",sm:"calc(var(--radius) - 4px)"},fontSize:{"2xs":"0.6rem",s:"0.8125rem"},containers:{"2xs":"340px","screen-sm":"640px","screen-md":"768px","screen-lg":"1024px","screen-xl":"1280px","screen-2xl":"1536px"}}},plugins:[t(98750),t(61123),t(83980),t(87224)({nocompatible:!0}),function(e){let{addBase:r,theme:t}=e;r({":root":Object.fromEntries(Object.entries((0,l.default)(t("colors"))).map(e=>{let[r,t]=e,n=c().hex.hsl(t);return["--".concat(r),t.startsWith("#")?"".concat(n[0]," ").concat(n[1],"% ").concat(n[2],"%"):t]}))})},function(e){let{matchUtilities:r,theme:t}=e;r({"bg-grid":e=>({backgroundImage:'url("'.concat(d()('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="'.concat(e,'"><path d="M0 .5H31.5V32"/></svg>')),'")')}),"bg-grid-small":e=>({backgroundImage:'url("'.concat(d()('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="8" height="8" fill="none" stroke="'.concat(e,'"><path d="M0 .5H31.5V32"/></svg>')),'")')}),"bg-dot":e=>({backgroundImage:'url("'.concat(d()('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"><circle fill="'.concat(e,'" id="pattern-circle" cx="10" cy="10" r="1.6257413380501518"></circle></svg>')),'")')})},{values:(0,l.default)(t("backgroundColor")),type:"color"})}]};let m=a()(p),f=m.theme.colors,h=Object.fromEntries(Object.keys(f).filter(e=>{let r=f[e];return null!=r&&"string"!=typeof r&&!("DEFAULT"in r)}).map(e=>[e,f[e]]))},13938:function(e,r,t){t.d(r,{AQ:function(){return o},G0:function(){return i}});var n,a,o,i,l=t(10158),s=t(23377),c=t(58905),u=t(62434),d=t(20295),p=t(68131),m=t(24189),f=t(55044),h=t(64772),g=t(85092),b=t(48308),y=t(31533),x=t(53692),A=t(73875),w=t(67864),S=t(71708),T=t(72366),v=t(8526),D=t(26478);let C=[100,200,400,800,1600,3200,6400,12800,25600,51200],createSignalBuffers=async e=>{let r=e.pipe((0,g.B)()),t=await (0,m.z)(r.pipe((0,w.P)(),(0,h.U)(e=>(0,A.Z)(e.data[0][0]).decimalPlaces(0,A.Z.ROUND_FLOOR).toNumber()))),n=performance.now(),a=r.pipe((0,S.b)(e=>(0,c.x)((0,u.D)(e.data),p.z)),(0,h.U)(e=>{let[r,n,a,o]=e;return[(0,A.Z)(r).minus(t).shiftedBy(3),n,a,o]}),(0,g.B)()),o=a.pipe((0,T.e)(1e3),(0,h.U)(e=>e.length<1?1:Math.floor(e.length/e[e.length-1][0].minus(e[0][0]).shiftedBy(-3).toNumber())),(0,v.x)(),(0,g.B)()),i=(0,c.x)(a.pipe((0,S.b)(e=>{let r=performance.now()-n,t=e[0].toNumber();return r<t?(0,d.of)(e).pipe((0,D.g)(t-r)):(0,d.of)(e)})),p.z),l=o.pipe((0,h.U)(e=>C.reduce((r,t)=>Math.abs(t-e)<Math.abs(r-e)?t:r,C[0])),(0,v.x)(),(0,g.B)());return{timeStamp:t,signal$:a,timeMappedSignal$:i,specSampleRate$:l,sampleRate$:o}};var E=t(98948),R=t(46126),z=t(73105);let N=0,getSensorEndpoint=e=>{switch(e.type){case"adxl345":return"adxl345/dump_adxl345";case"beacon":return"beacon/dump_accel";case"lis2dw":return"lis2dw/dump_lis2dw";default:throw Error("Sensor type not supported. Must be 'adxl345', 'beacon', or 'lis2dw'")}},isSuccessResponse=e=>null!=e&&"object"==typeof e&&!("error"in e),isKlipperAccelSubscriptionResponse=e=>R.NI.safeParse(e).success,isKlipperAccelSubscriptionData=e=>isSuccessResponse(e)&&null!=e.params&&"data"in e.params&&Array.isArray(e.params.data)&&Array.isArray(e.params.data[0])&&4===e.params.data[0].length,isBeaconAccelSubscriptionData=e=>isSuccessResponse(e)&&null!=e.params&&Array.isArray(e.params)&&Array.isArray(e.params[0])&&4===e.params[0].length,detrendFloatSignal=e=>{let r=e.reduce((e,r)=>e+r,0)/e.length;for(let t=0;t<e.length;t++)e[t]-=r;return e},detrendBatch=e=>{let r=detrendFloatSignal(e.map(e=>e[1])),t=detrendFloatSignal(e.map(e=>e[2])),n=detrendFloatSignal(e.map(e=>e[3]));return e.map((e,a)=>[e[0],r[a],t[a],n[a]])},createADXL345Stream=(e,r)=>{let t=(0,z.j)({url:e,deserializer:e=>{try{return JSON.parse(e.data,(e,r,t)=>"0"===e&&"number"==typeof r&&(null==t?void 0:t.source)!=null?(0,A.Z)(r):r)}catch(e){return(0,E.j)().error(e,"Error parsing JSON from klipper socket"),null}}}),n=t.multiplex(()=>({jsonrpc:"2.0",method:getSensorEndpoint(r),params:{sensor:r.name,response_template:{}},id:++N}),()=>null,e=>{if("result"in e&&isKlipperAccelSubscriptionResponse(e.result))return e.result.header,!1;if(isKlipperAccelSubscriptionData(e)||isBeaconAccelSubscriptionData(e))return!0;if(!isSuccessResponse(e))throw(0,E.j)().error(e,"Error in response from adxl345 subscription on klipper socket"),Error("".concat(e.error.error,": ").concat(e.error.message));return!1}).pipe((0,g.B)(),(0,y.h)(e=>isKlipperAccelSubscriptionData(e)||isBeaconAccelSubscriptionData(e)),(0,h.U)(e=>{if(isBeaconAccelSubscriptionData(e))return{overflows:0,errors:0,data:detrendBatch(e.params)};if(isKlipperAccelSubscriptionData(e))return{...e.params,data:detrendBatch(e.params.data)};throw Error("Got invalid data from klipper accelerometer subscription.")}),(0,g.B)());return n.subscribe(),{dataStream$:n,close:()=>{t.complete.bind(t)()}}};(n=o||(o={})).START="START",n.STOP="STOP",n.START_ACCUMULATION="START_ACCUMULATION",n.STOP_ACCUMULATION="STOP_ACCUMULATION",(a=i||(i={})).STARTED="STARTED",a.STOPPED="STOPPED",a.ACCUMULATING="ACCUMULATING",a.ACCUMULATED="ACCUMULATED",a.SIGNAL="SIGNAL",a.PSD="PSD",a.RX_RATE="RX_RATE",a.SAMPLE_RATE="SAMPLE_RATE",a.SPEC_SAMPLE_RATE="SPEC_SAMPLE_RATE";let mapToWorkerOutput=e=>(0,h.U)(e),k=new s.x,L=(0,l.p)(()=>new Worker(t.tu(new URL(t.p+t.u(8108),t.b))),k).pipe((0,g.B)());(0,l.YX)(class{work(e){return e.pipe((0,b.z)(e=>{switch(e.type){case"START":{if(null!=this.stream)throw Error("Stream already started");this.stream=createADXL345Stream(e.payload.url,e.payload.sensor);let setup=async()=>{if(null==this.stream)throw Error("Stream not initialized");let e=await createSignalBuffers(this.stream.dataStream$);e.signal$.subscribe(e=>k.next({command:"sampleInput",payload:[e[0].toNumber(),e[1],e[2],e[3]]})),e.specSampleRate$.subscribe(e=>k.next({command:"specSampleRateInput",payload:e}));let r=(0,c.x)((0,u.D)([(0,d.of)({type:"STARTED",payload:e.timeStamp}),e.timeMappedSignal$.pipe(mapToWorkerOutput(e=>{let r=new Float64Array([e[0].toNumber(),...e.slice(1)]);return{type:"SIGNAL",payload:r.buffer}}),(0,g.B)()),e.sampleRate$.pipe(mapToWorkerOutput(e=>({type:"SAMPLE_RATE",payload:e}))),e.specSampleRate$.pipe(mapToWorkerOutput(e=>({type:"SPEC_SAMPLE_RATE",payload:e}))),L.pipe((0,y.h)(e=>"psd"===e.type),mapToWorkerOutput(e=>({type:"PSD",payload:e.psd})))]),p.z).pipe((0,x.J)());return r};return(0,u.D)(setup()).pipe((0,x.J)())}case"STOP":return null!=this.stream&&(this.stream.close(),this.stream=null),(0,d.of)({type:"STOPPED"});case"START_ACCUMULATION":if(null==this.stream)throw Error("Stream not initialized");if(null==L)throw Error("PSD worker not initialized");return k.next({command:"accumulate",payload:!0}),(0,c.x)((0,u.D)([(0,d.of)({type:"ACCUMULATING"}),(0,c.x)((0,u.D)((0,m.z)(L.pipe((0,y.h)(e=>"accumulation_finished"===e.type)))).pipe(mapToWorkerOutput(e=>({type:"ACCUMULATED",payload:e.psd}))),p.z)]),p.z).pipe((0,x.J)());case"STOP_ACCUMULATION":if(null==L)throw Error("Stream not initialized");if(null==L)throw Error("PSD process not initialized");return k.next({command:"accumulate",payload:!1}),f.E;default:var r;throw null===(r=this.stream)||void 0===r||r.close(),this.stream=null,Error("Invalid command")}}))}selectTransferables(e){switch(e.type){case"SIGNAL":return[e.payload];case"PSD":case"ACCUMULATED":return[e.payload.x.estimates.buffer,e.payload.x.frequencies.buffer,e.payload.y.estimates.buffer,e.payload.y.frequencies.buffer,e.payload.z.estimates.buffer,e.payload.z.frequencies.buffer,e.payload.total.estimates.buffer,e.payload.total.frequencies.buffer];default:return[]}}constructor(){this.stream=null}})},315:function(e,r,t){t.d(r,{b:function(){return ChartTheme}});var n=t(77706);let ChartTheme=class ChartTheme extends n.SciChartJSDarkv2Theme{constructor(){super(),this.sciChartBackground="transparent",this.loadingAnimationBackground="transparent",this.axisBandsFill="#20212333",this.majorGridLineBrush="#AAAAAA37",this.minorGridLineBrush="#77777719",this.strokePalette=["#F48420","#AE408E","#209FD9","#264B93"],this.fillPalette=["#F4842077","#AE408E77","#209FD977","#264B9377"],this.isLightBackground=!1,this.loadingAnimationForeground="transparent"}}},29817:function(e,r,t){t.d(r,{Mg:function(){return isXyDataSeries},Np:function(){return h},OH:function(){return b},QR:function(){return useADXLSignalChart},ZA:function(){return usePSDChart},as:function(){return g},ck:function(){return f},jh:function(){return isXyyDataSeries},to:function(){return getPSDTooltipLegendTemplate}});var n=t(77706),a=t(30742),o=t(315),i=t(48488),l=t.n(i),s=t(43955),c=t(39164);n.SciChartSurface.configure({wasmUrl:"/configure/scichart2d.wasm",dataUrl:"/configure/scichart2d.data"}),n.SciChartSurface.UseCommunityLicense();let u=new o.b,d="signal",p="history",m="amplitude",isXyyDataSeries=e=>e.type===n.EDataSeriesType.Xyy,isXyDataSeries=e=>e.type===n.EDataSeriesType.Xy,getAxisColorName=e=>{switch(e){case"x":return"yellow";case"y":return"sky";case"z":return"rose";default:return"brand"}},getAxisColor=e=>s.NI[getAxisColorName(e)];new n.NumberRange(-1e4,1e4);let useADXLSignalChart=e=>(0,a.Q8)(null,(0,c.useCallback)(r=>{let t=getAxisColor(e),a=new n.NumericAxis(r.webAssemblyContext2D,{id:d+e,autoRange:n.EAutoRange.Always,maxAutoTicks:128,drawLabels:!1,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,drawMinorGridLines:!1,drawMajorGridLines:!1});r.xAxes.add(a);let o=new n.NumericAxis(r.webAssemblyContext2D,{id:p+e,autoRange:n.EAutoRange.Always,drawLabels:!1,drawMinorGridLines:!1,drawMajorTickLines:!1});r.xAxes.add(o);let i=new n.NumericAxis(r.webAssemblyContext2D,{autoRange:n.EAutoRange.Never,visibleRange:new n.NumberRange(-5e3,5e3),drawLabels:!1,id:m+e,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,drawMinorGridLines:!1,drawMajorGridLines:!1,axisAlignment:n.EAxisAlignment.Left});r.yAxes.add(i);let l=new n.XyDataSeries(r.webAssemblyContext2D,{fifoCapacity:128,containsNaN:!1,isSorted:!0,dataSeriesName:e.toLocaleUpperCase(),dataIsSortedInX:!0,xValues:Array(128).fill(0).map((e,r)=>r),yValues:Array(128).fill(0)}),s=new n.FastLineRenderableSeries(r.webAssemblyContext2D,{xAxisId:d+e,yAxisId:m+e,stroke:t[400],strokeThickness:2,dataSeries:l,effect:new n.GlowEffect(r.webAssemblyContext2D,{intensity:1,range:1})});r.renderableSeries.add(s);let c=new n.XyDataSeries(r.webAssemblyContext2D,{fifoCapacity:25600,containsNaN:!1,isSorted:!0,dataSeriesName:e.toLocaleUpperCase()+" History",dataIsSortedInX:!0,xValues:Array(25600).fill(0).map((e,r)=>3.2*r),yValues:Array(25600).fill(0)}),u=new n.FastLineRenderableSeries(r.webAssemblyContext2D,{stroke:t[500]+"22",strokeThickness:1,opacity:.6,yAxisId:m+e,xAxisId:p+e,dataSeries:c});return r.renderableSeries.add(u),s.animation=new n.WaveAnimation({duration:500}),u.animation=new n.WaveAnimation({duration:500}),{signalData:l,signalSeries:s,historyData:c,historySeries:u,xAxis:a,xHistoryAxis:o,yAxis:i}},[e])),f="amplitude",h="shaper",g=new n.NumberRange(0,1500),b={surface:{theme:u,padding:n.Thickness.fromNumber(0)},xAxes:[{type:n.EAxisType.NumericAxis,options:{visibleRange:new n.NumberRange(0,200),labelStyle:{...l().style,fontSize:13,fontWeight:"600",padding:new n.Thickness(15,15,15,15)},labelPostfix:"Hz",drawMinorGridLines:!0,minorsPerMajor:10,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1}}],yAxes:[{type:n.EAxisType.NumericAxis,options:{id:f,axisAlignment:n.EAxisAlignment.Left,growBy:new n.NumberRange(0,.1),visibleRange:g,labelFormat:n.ENumericFormat.Exponential,labelStyle:{...l().style,fontSize:13,fontWeight:"600",padding:new n.Thickness(15,15,15,15)},autoRangeAnimation:{duration:140,animateInitialRanging:!1,animateSubsequentRanging:!0,easing:n.easing.inOutCubic},drawMinorGridLines:!0,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,axisTitleStyle:{fontSize:10}}},{type:n.EAxisType.NumericAxis,options:{id:h,axisAlignment:n.EAxisAlignment.Right,isVisible:!1,growBy:new n.NumberRange(0,.1),autoRange:n.EAutoRange.Never,visibleRange:new n.NumberRange(0,1),drawMinorGridLines:!1,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,axisTitleStyle:{fontSize:10},axisTitle:"Shaper vibration reduction (ratio)"}}]},y={...b,series:[{type:n.ESeriesType.MountainSeries,options:{id:"total",yAxisId:f,strokeThickness:3,fill:s.NI.brand[500]+"22",stroke:s.NI.brand[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,r)=>Math.floor(r/128*200)),yValues:Array(128).fill(0).map((e,r)=>0)}},{type:n.ESeriesType.LineSeries,options:{id:"z",yAxisId:f,strokeThickness:3,stroke:getAxisColor("z")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,r)=>Math.floor(r/128*200)),yValues:Array(128).fill(0).map((e,r)=>0)}},{type:n.ESeriesType.LineSeries,options:{id:"y",yAxisId:f,strokeThickness:3,stroke:getAxisColor("y")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,r)=>Math.floor(r/128*200)),yValues:Array(128).fill(0).map((e,r)=>0)}},{type:n.ESeriesType.LineSeries,options:{id:"x",yAxisId:f,strokeThickness:3,stroke:getAxisColor("x")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,r)=>Math.floor(r/128*200)),yValues:Array(128).fill(0).map((e,r)=>0)}}]},getPSDTooltipLegendTemplate=(e,r)=>{let t="",a=32,o=[];e.forEach((e,r)=>{if(!1===e.renderableSeries.rolloverModifierProps.showRollover)return;let i=e.renderableSeries.rolloverModifierProps.tooltipColor;if(o.push("".concat(e.renderableSeries.rolloverModifierProps.tooltipTitle).concat(":"," ").concat((e.yValue/1e3).toFixed(2)," g^2/Hz @ ").concat(e.formattedXValue)),t+='<text x="'.concat(16,'" y="').concat(a,'" class="text-sm text-medium font-sans" fill="').concat(s.DN[i][400],'">\n		<tspan class="font-bold">').concat(e.renderableSeries.rolloverModifierProps.tooltipTitle,"</tspan>").concat(":"," ").concat((e.yValue/1e3).toFixed(2),' g<tspan y="').concat(a-4,'" class="sup">2</tspan><tspan y=').concat(a,">/Hz</tspan> @ ").concat(e.formattedXValue,"\n		</text>"),a+=20,e.dataSeriesType===n.EDataSeriesType.Xyy){if(!1===e.renderableSeries.rolloverModifierProps1.showRollover)return;let r=e.renderableSeries.rolloverModifierProps1.tooltipColor;o.push("".concat(e.renderableSeries.rolloverModifierProps1.tooltipTitle).concat(":"," ").concat((e.y1Value/1e3).toFixed(2)," g^2/Hz @ ").concat(e.formattedXValue)),t+='<text x="'.concat(16,'" y="').concat(a,'" class="text-sm text-medium font-sans" fill="').concat(s.DN[r][400],'">\n				<tspan class="font-bold">').concat(e.renderableSeries.rolloverModifierProps1.tooltipTitle,"</tspan>").concat(":"," ").concat((e.y1Value/1e3).toFixed(2),' g<tspan y="').concat(a-4,'" class="sup">2</tspan><tspan y=').concat(a,">/Hz</tspan> @ ").concat(e.formattedXValue,"\n			</text>"),a+=20,t+='<text x="'.concat(16,'" y="').concat(a,'" class="text-sm text-medium font-sans" fill="').concat(s.DN.zinc[400],'">\n				<tspan class="font-bold">Amplitude Difference</tspan>').concat(":"," ").concat(Math.abs((e.y1Value-e.yValue)/1e3).toFixed(2),' g<tspan y="').concat(a-4,'" class="sup">2</tspan><tspan y=').concat(a,">/Hz</tspan>\n			</text>"),a+=20}});let i=0===e.length?0:16+1.7*calcTooltipWidth(o.reduce(function(e,r){return r.length>e?r.length:e},0)),l=0===e.length?0:a;return'<svg width="'.concat(i,'" height="').concat(l,'">\n				<rect rx="8" ry="8" width="100%" height="100%" class="stroke-zinc-400/10 fill-zinc-900/70 stroke-1" />\n                ').concat(t,"\n            </svg>")},psdRolloverTooltipTemplate=(e,r,t)=>{let a="",o=t.tooltipProps,i=o.tooltipTitle,l=o.tooltipColor,c=s.NI[l][100],u=(0,n.parseColorToTArgb)(s.NI[l][400]),d=(0,n.parseColorToTArgb)(s.NI[l][600]),p=o.tooltipLabelX,m=o.tooltipLabelY,f=s.NI[l][900];u.opacity=Math.round(204),d.opacity=Math.round(51);let h=null!==(A=t.tooltipProps.tooltipDataTemplate)&&void 0!==A?A:t.tooltipProps.rolloverModifier.tooltipDataTemplate,g=h(r,i,p,m),b=null!==(w=o.width)&&void 0!==w?w:calcTooltipWidth(g.reduce(function(e,r){return r.length>e?r.length:e},0)),y=null!==(S=o.height)&&void 0!==S?S:calcTooltipHeight(g.length);t.updateSize(b,y),g.forEach(function(e,r){a+='<tspan x="8" dy="1.2em">'.concat(e,"</tspan>")});let x='<feGaussianBlur result="blurOut" in="offOut" stdDeviation="3" />';if(void 0!==f){var A,w,S,T=(0,n.parseColorToTArgb)(f);x='\n			<feColorMatrix result="matrixOut" in="offOut" type="matrix"\n				values="0 0 0 0 \n				'.concat(T.red/255,"\n				0 0 0 0\n				").concat(T.green/255,"\n				0 0 0 0\n				").concat(T.blue/255,"\n				0 0 0 \n				").concat(T.opacity/255,'\n				0 0" \n			/>\n			<feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="3" />')}return'\n		<svg class="scichart__rollover-tooltip transition-all" width="'.concat(b,'" height="').concat(y,'">\n			<defs>\n				<filter id="').concat(e,'" x="0" y="0" width="200%" height="200%">\n					<feOffset result="offOut" in="SourceAlpha" dx="3" dy="3" />\n						\n						').concat(x,'\n					<feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n				</filter>\n			</defs>\n			<rect rx="8" ry="8" width="100%" height="100%" fill="').concat((0,n.parseTArgbToHtmlColor)(d),'" stroke="').concat((0,n.parseTArgbToHtmlColor)(u),'" stroke-width="2"  filter="url(#').concat(e,'" />\n			<svg width="100%">\n				<text x="8" y="3" class="text-sm font-sans font-semibold" dy="0" fill="').concat(c,'">\n				').concat(a,"\n				</text>\n			</svg>\n		</svg>")},createPSDAnimationSeries=e=>{let r=new n.XyDataSeries(e.webAssemblyContext2D,{id:"xAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(r);let t=new n.XyDataSeries(e.webAssemblyContext2D,{id:"yAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(t);let a=new n.XyDataSeries(e.webAssemblyContext2D,{id:"zAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(a);let o=new n.XyDataSeries(e.webAssemblyContext2D,{id:"totalAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});return e.addDeletable(o),{x:r,y:t,z:a,total:o}},usePSDChart=()=>(0,a.Q8)(y,(0,c.useCallback)(e=>(e.renderableSeries.asArray().forEach(e=>{e.rolloverModifierProps.tooltipColor=getAxisColorName(e.id),e.rolloverModifierProps.tooltipTemplate=psdRolloverTooltipTemplate,e.rolloverModifierProps.tooltipTitle=e.id.substring(0,1).toUpperCase()+e.id.substring(1)+" Power Spectral Density",e.animation=new n.WaveAnimation({duration:500})}),e.chartModifiers.add(new n.CursorModifier({crosshairStroke:s.NI.sky[400],crosshairStrokeThickness:1,showXLine:!0,showYLine:!0,showTooltip:!1,tooltipLegendTemplate:getPSDTooltipLegendTemplate,tooltipLegendOffsetX:16,tooltipLegendOffsetY:16,yAxisId:f,axisLabelFill:s.NI.zinc[900],axisLabelStroke:s.NI.zinc[100]})),{animationSeries:createPSDAnimationSeries(e)}),[]));var calcTooltipWidth=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e*r+20},calcTooltipHeight=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return r*e+16}},30742:function(e,r,t){t.d(r,{Q8:function(){return useChart},Tv:function(){return useDynamicAxisRange},ck:function(){return useWorker}});var n=t(72612),a=t(39164),o=t(77706),i=t(315),l=t(63278),s=t(8832),c=t(18954),u=t(96588),d=t(32342),p=t(80461),m=t(13938),f=t(10158),h=t(23377),g=t(85092),b=t(24189),y=t(31533),x=t(54957),A=t(64772),w=t(76877),S=t(72531),T=t(81446);function transformPSD(e){let r={frequencies:Array.from(e.frequencies),estimates:Array.from(e.estimates),powerRange:e.powerRange};return r}let getWsURL=()=>{let e=(0,T.X)();return null==e||""==e.trim()?null:"ws://".concat(e,":7125/klippysocket")},v=new h.x,D=(0,f.p)(()=>new Worker(t.tu(new URL(t.p+t.u(3938),t.b))),v).pipe((0,g.B)()),useWorker=(e,r,t,n,o)=>{let i=useAccelerometerWithType(r),[l,s]=(0,a.useState)(getWsURL()),c=(0,a.useRef)(!1),u=(0,a.useRef)(!1),d=(0,a.useRef)(t);d.current=t;let p=(0,a.useRef)(n);p.current=n;let f=(0,a.useCallback)(async()=>{if(u.current)throw Error("Already accumulating");let e=(0,b.z)(D.pipe((0,y.h)(e=>e.type===m.G0.PSD),(0,x.V)(5e3))),r=(0,b.z)(D.pipe((0,y.h)(e=>e.type===m.G0.ACCUMULATING),(0,A.U)(()=>!0),(0,x.V)(5e3)));await e,v.next({type:m.AQ.START_ACCUMULATION}),await r},[]),h=(0,a.useCallback)(async()=>{if(!u.current)throw Error("Not accumulating, cannot stop");let e=(0,b.z)(D.pipe((0,y.h)(e=>e.type===m.G0.ACCUMULATED),(0,A.U)(e=>({x:transformPSD(e.payload.x),y:transformPSD(e.payload.y),z:transformPSD(e.payload.z),total:transformPSD(e.payload.total)})),(0,x.V)(6e4)));return v.next({type:m.AQ.STOP_ACCUMULATION}),await e},[]),g=(0,a.useCallback)(async()=>{if(await new Promise(e=>setTimeout(e,10)),c.current)return;let e=(0,b.z)(D.pipe((0,y.h)(e=>e.type===m.G0.STARTED),(0,x.V)(5e3)));await e},[]),T=(0,a.useCallback)(async()=>{if(await new Promise(e=>setTimeout(e,10)),!c.current)return;let e=(0,b.z)(D.pipe((0,y.h)(e=>e.type===m.G0.STOPPED),(0,x.V)(5e3)));await e},[]);return(0,a.useEffect)(()=>{s(getWsURL())},[]),(0,a.useEffect)(()=>{if(e&&null!=l){let e=D.subscribe({next:e=>{switch(e.type){case m.G0.STARTED:c.current=!0;break;case m.G0.STOPPED:c.current=!1;break;case m.G0.ACCUMULATING:u.current=!0;break;case m.G0.ACCUMULATED:u.current=!1;case m.G0.SAMPLE_RATE:case m.G0.SPEC_SAMPLE_RATE:}},error:o}),r=D.pipe((0,y.h)(e=>e.type===m.G0.SIGNAL),(0,A.U)(e=>new Float64Array(e.payload)),(0,w.f)((0,S.R)()),(0,y.h)(e=>e.length>0),(0,A.U)(e=>{let r=new Float64Array(e.length),t=new Float64Array(e.length),n=new Float64Array(e.length),a=new Float64Array(e.length);return e.forEach((e,o)=>{r[o]=e[0],t[o]=e[1],n[o]=e[2],a[o]=e[3]}),[r,t,n,a]})).subscribe({next:e=>{d.current(e)},error:o}),t=D.pipe((0,y.h)(e=>e.type===m.G0.PSD),(0,A.U)(e=>e.payload)).subscribe({next:e=>{p.current(e)},error:o});return v.next({type:m.AQ.START,payload:{url:l,sensor:i}}),()=>{(0,b.z)(D.pipe((0,y.h)(e=>e.type===m.G0.STOPPED),(0,x.V)(5e3))).finally(()=>{c.current=!1,e.unsubscribe(),r.unsubscribe(),t.unsubscribe()}),v.next({type:m.AQ.STOP})}}},[e,o,i,r,l]),{streamStarted:g,streamStopped:T,startAccumulation:f,stopAccumulation:h}},useAccelerometerWithType=e=>{let r=(0,u.sJ)(d.OS),t=(0,p.YC)(),n="adxl345";if("controlboard"===e&&((null==r?void 0:r.ADXL345SPI)!=null&&(n="adxl345"),(null==r?void 0:r.LIS2DW)!=null&&(n="lis2dw")),"toolboard_t0"===e||"toolboard_t1"===e){var o;let r=null===(o=t.find(r=>r.getToolboardName()===e))||void 0===o?void 0:o.getToolboard();if(null==r)throw Error("No toolboard found for T0");null!=r.ADXL345SPI&&(n="adxl345"),null!=r.LIS2DW&&(n="lis2dw")}return"beacon"===e&&(n="beacon"),(0,a.useMemo)(()=>c.U9.parse({name:e,type:n}),[e,n])},C=new i.b,useChart=function(e,r){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=(0,a.useRef)(null),[c,u]=(0,a.useState)(!1),d=(0,a.useRef)([]),p=(0,a.useRef)(null);return(0,a.useMemo)(()=>({forwardProps:{initChart:async n=>{let a=null;if(null!=e){var l,s,c,u,d;let r=null===(l=e.surface)||void 0===l?void 0:l.padding,i={...e,surface:{...e.surface,padding:new o.Thickness(null!==(s=null==r?void 0:r.top)&&void 0!==s?s:0,null!==(c=null==r?void 0:r.right)&&void 0!==c?c:0,null!==(u=null==r?void 0:r.bottom)&&void 0!==u?u:0,(null!==(d=null==r?void 0:r.left)&&void 0!==d?d:0)+(t?300:0))}};a=await (0,o.build2DChart)(n,i)}else a=await o.SciChartSurface.createSingle(n,{theme:C,padding:new o.Thickness(0,0,0,t?300:0)});return a.sciChartSurface.watermarkPosition=o.EWatermarkPosition.BottomLeft,a.sciChartSurface.watermarkRelativeToCanvas=!0,i.current=a.sciChartSurface,r&&(p.current=r(a.sciChartSurface)),{sciChartSurface:a.sciChartSurface}},onInit:()=>{if(u(!0),null==i.current)throw Error("onInit called without surface initialized");d.current.forEach(e=>e(i.current))},style:{marginLeft:t?-300:0},fallback:(0,n.jsx)(s.I,{className:(0,l.dV)(t&&"ml-[150px]","bg-zinc-900")})},surface:i,isInitialized:c,onInitialize:e=>{d.current.push(e),c&&null!=i.current&&e(i.current)},data:p}),[t,c,e,r])},maximumRangeUnion=e=>Array.isArray(e)?e.reduce((e,r)=>{if(null==r)return e;let t=r.getMaximumRange();return e.union(t)},new o.NumberRange):e.getMaximumRange(),visibleRangeUnion=e=>Array.isArray(e)?e.reduce((e,r)=>{if(null==r)return e;let t=r.visibleRange;return e.union(t)},new o.NumberRange):e.visibleRange,growByUnion=e=>Array.isArray(e)?e.reduce((e,r)=>{var t;if(null==r)return e;let n=null!==(t=r.growBy)&&void 0!==t?t:new o.NumberRange;return e.union(n)},new o.NumberRange):e.growBy;function useDynamicAxisRange(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.NumberRange(0,0),t=arguments.length>2?arguments[2]:void 0,n=(0,a.useRef)(e?maximumRangeUnion(e):null),i=(0,a.useRef)(performance.now()),l=(0,a.useRef)(performance.now()),s=(0,a.useCallback)(function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;if(null==e)return;let s=Array.isArray(e)?e:[e];null==n.current&&(n.current=visibleRangeUnion(e));let c=performance.now()-i.current,u=performance.now()-l.current;i.current=performance.now();let d=maximumRangeUnion(e);a&&(d=d.union(a));let p=growByUnion(e);p&&d.growBy(p);let m=null,f=null;if(d.max>n.current.max&&(m=d.max),d.min<n.current.min&&(f=d.min),(null!=m||null!=f)&&u>c){let e=Math.min(null!=f?f:n.current.min,r.min),a=Math.max(null!=m?m:n.current.max,r.max);(e!==n.current.min||a!==n.current.max)&&(n.current=new o.NumberRange(e,a),s.forEach(r=>{if(null==n.current||null==r)return;let i=new o.NumberRange(e,a);r.animateVisibleRange(i,null!=t?t:c,o.easing.inOutQuad)}),l.current=performance.now())}if(u>3e3){d.max<n.current.max&&(m=n.current.max-(n.current.max-d.max)),d.min>n.current.min&&(f=n.current.min+(d.min-n.current.min));let e=Math.min(null!=f?f:n.current.min,r.min),t=Math.max(null!=m?m:n.current.max,r.max);if(t!=n.current.max||e!=n.current.min){s.forEach(r=>{if(null==n.current||null==r)return;let a=new o.NumberRange(e,t);r.animateVisibleRange(a,u/2,o.easing.inOutQuad)}),n.current=new o.NumberRange(e,t),l.current=performance.now();return}}},[t,e,r]);return s}},88192:function(e,r,t){t.r(r),t.d(r,{Card:function(){return Card}});var n=t(72612),a=t(73918);t(39164);var o=t(73790),i=t(63278);let l=(0,a.j)(["relative rounded-lg bg-white dark:bg-zinc-900/60 @container","shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]","dark:before:-inset-px dark:before:rounded-xl","dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_rgba(0,_0,_0,_0.20),_0px_1px_0px_0px_rgba(255,_255,_255,_0.07)_inset]"]),Card=e=>(0,n.jsx)(o.E.div,{...e,className:(0,i.m6)(l(),e.className),children:e.children})},61946:function(e,r,t){t.d(r,{Jt:function(){return a},uo:function(){return xEndstopOptions}});var n=t(1314);let xEndstopOptions=(e,r)=>{let t=[];if((null==r?void 0:r.toolboard)!=null&&t.push({id:"endstop-toolboard",title:"Physical Endstop",badge:[{color:"sky",children:"".concat(r.toolboard.name).concat(null!=r.toolNumber&&" T".concat(r.toolNumber))}]}),(null==r?void 0:r.axis)===n.po.x){var a,o,i,l;t.push({id:"endstop",title:"Physical Endstop",badge:[{color:"purple",children:null!==(i=null==e?void 0:null===(a=e.controlboard)||void 0===a?void 0:a.name)&&void 0!==i?i:"Control Board"}]}),t.push({id:"sensorless",title:"Sensorless Homing",badge:[{color:"purple",children:null!==(l=null==e?void 0:null===(o=e.controlboard)||void 0===o?void 0:o.name)&&void 0!==l?l:"Control Board"}]})}return t},a={id:"endstop",title:"Physical Endstop",badge:[{color:"purple",children:"Control Board"}]}},80461:function(e,r,t){t.d(r,{YC:function(){return useToolheads},yk:function(){return useToolheadConfiguration}});var n=t(11974),a=t(21264),o=t(96588),i=t(39164),l=t(32342),s=t(65667),c=t(22595),u=t(61946),d=t(4840);let useToolheads=()=>{let e=(0,o.sJ)(s.$T),r=(0,i.useMemo)(()=>null==e?void 0:e.filter(Boolean).map(e=>new n.D(e)),[e]);return r},useToolheadConfiguration=function(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=(0,o.sJ)(s.wm),p=(0,i.useRef)(t);p.current!==t&&t.length>0&&(p.current=t.slice());let m=(0,i.useMemo)(()=>{var t;let a=null===(t=p.current)||void 0===t?void 0:t.filter(Boolean).map(e=>new n.D(e)),o=null==a?void 0:a.find(r=>r.getTool()===e||r.getMotionAxis()===e||r.getExtruderAxis()===e);if(null==o&&r)throw Error("Toolhead with number or axis ".concat(e," not found"));return null!=o?o:null},[r,e,p.current]),[f,h]=(0,i.useState)(!1),g=(0,o._8)(e=>{let{set:r,snapshot:t}=e;return async e=>{var o,i,p,m;let g=new n.D(e),b=await t.getPromise((0,s.AF)(g.getTool()));if(null==b)throw Error("Toolhead ".concat(g.getToolCommand()," not found"));let y=new n.D(b);if(e.extruder.id!=y.getExtruder().id&&null!=e.extruder.stepper){let t=(0,a.WZ)(e.extruder.stepper);null!=t&&r((0,l.ew)(g.getExtruderAxis()),r=>{var n;return null==r?null:{...r,stepper:t.id,current:null!==(n=e.extruder.current)&&void 0!==n?n:.71*t.maxPeakCurrent}})}if((null===(o=e.toolboard)||void 0===o?void 0:o.id)!==(null===(i=y.getToolboard())||void 0===i?void 0:i.id)){if(null==e.toolboard&&"endstop-toolboard"===e.xEndstop.id&&(e.xEndstop=u.Jt),null===(p=e.partFan)||void 0===p?void 0:p.id.endsWith("-toolboard")){let r=(0,d.gL)(null,e).shift();if(null==r)throw Error("No part fan options available for current T".concat(e.toolNumber," configuration"));e.partFan=r}if(null===(m=e.hotendFan)||void 0===m?void 0:m.id.endsWith("-toolboard")){let r=(0,d.Yo)(null,e).shift();if(null==r)throw Error("No hotend fan options available for current T".concat(e.toolNumber," configuration"));e.hotendFan=r}}e.thermistor!==y.getThermistor()&&e.thermistor!==e.hotend.thermistor?h(!0):e.hotend.id==y.getHotend().id||f||(e.thermistor=e.hotend.thermistor);let x=c.PY.extend({toolNumber:c.Qr}).nullable().safeParse({...e,toolNumber:y.getTool()});return x.success&&r((0,s.AF)(y.getTool()),x.data),x}},[f]);return{toolhead:m,setToolhead:g}}},46126:function(e,r,t){t.d(r,{NI:function(){return i},Xz:function(){return g}});var n=t(94594),a=t(18954);let o=n.z.union([n.z.literal("time"),n.z.literal("x_acceleration"),n.z.literal("y_acceleration"),n.z.literal("z_acceleration"),n.z.literal("x"),n.z.literal("y"),n.z.literal("z")]),i=n.z.object({header:n.z.tuple([o,o,o,o])});n.z.object({data:n.z.array(n.z.tuple([n.z.number(),n.z.number(),n.z.number(),n.z.number()])),overflows:n.z.number().optional(),errors:n.z.number().optional()}),n.z.array(n.z.tuple([n.z.number(),n.z.number(),n.z.number(),n.z.number()]));let l=n.z.object({frequencies:n.z.array(n.z.number()),estimates:n.z.array(n.z.number()),powerRange:n.z.object({max:n.z.number(),min:n.z.number()})}),s=n.z.object({x:l,y:l,z:l,total:l}),c=n.z.string().brand("MacroID"),u=n.z.string().brand("MacroSequenceID"),d=n.z.string().brand("MacroRecordingID"),p=n.z.string().brand("MacroRecordingRunID"),m=n.z.object({capturePSD:n.z.boolean().default(!1),accelerometer:a.Yx.optional(),color:n.z.string().optional()}).superRefine((e,r)=>(e.capturePSD&&null==e.accelerometer&&r.addIssue({code:n.z.ZodIssueCode.custom,message:"Required when recording resonance data",path:["accelerometer"]}),e));n.z.object({id:d,macroRecordingRunId:p,scv:n.z.number().default(5),macroId:c,sequenceId:u,startTimeStamp:n.z.number(),endTimeStamp:n.z.number(),accelerometer:a.Yx,recordingHardwareName:n.z.string(),psd:s,name:n.z.string()});let f=n.z.object({id:u,name:n.z.string(),recording:m.nullable(),gcode:n.z.string().min(2)}),h=n.z.object({id:c,name:n.z.string(),description:n.z.string(),createdAtTimeStamp:n.z.number(),updatedAtTimeStamp:n.z.number().nullable(),recordingCount:n.z.record(u,n.z.number()),sequences:n.z.array(f)}),g=h.omit({recordingCount:!0,createdAtTimeStamp:!0,updatedAtTimeStamp:!0})}}]);
//# sourceMappingURL=2003-6e0bf63a4a63df05.js.map